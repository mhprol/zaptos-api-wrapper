openapi: 3.1.0
info:
  title: ZaptosWPP API (PT-BR)
  version: 2.0.0
  description: >-
    **Bem-vindo Ã  API ZaptosWPP** â€” IntegraÃ§Ã£o oficial com o WhatsApp,
    oferecendo recursos de envio, recebimento e automaÃ§Ã£o via API. Esta
    documentaÃ§Ã£o descreve endpoints para instÃ¢ncias, mensagens, contatos, grupos
    e automaÃ§Ãµes com seguranÃ§a por token.


    ðŸ‡§ðŸ‡· PT-BR: DocumentaÃ§Ã£o completa da API ZaptosWPP.


    API para gerenciamento de instÃ¢ncias do WhatsApp e comunicaÃ§Ãµes.


    ## âš ï¸ RecomendaÃ§Ã£o Importante: WhatsApp Business

    **Ã‰ ALTAMENTE RECOMENDADO usar contas do WhatsApp Business** em vez do
    WhatsApp normal para integraÃ§Ã£o, o WhatsApp normal pode apresentar
    inconsistÃªncias, desconexÃµes, limitaÃ§Ãµes e instabilidades durante o uso com
    a nossa API.


    ## AutenticaÃ§Ã£o

    - Endpoints regulares requerem um header 'token' com o token da instÃ¢ncia


    ## Estados da InstÃ¢ncia

    As instÃ¢ncias podem estar nos seguintes estados:

    - `disconnected`: Desconectado do WhatsApp

    - `connecting`: Em processo de conexÃ£o

    - `connected`: Conectado e autenticado com sucesso
servers:
  - url: https://api.zaptoswpp.com/whatsapp/
    description: ProduÃ§Ã£o (Servidor principal)
  - url: https://api.zaptoswpp.com/whatsapp2/
    description: ProduÃ§Ã£o (Servidor secundÃ¡rio)
  - url: https://api.zaptoswpp.com/whatsapp3/
    description: ProduÃ§Ã£o (Servidor terciÃ¡rio)
  - url: https://api.zaptoswpp.com/whatsapp4/
    description: ProduÃ§Ã£o (Servidor adicional)
  - url: https://sandbox.zaptoswpp.com/whatsapp/
    description: Ambiente de testes
components:
  securitySchemes:
    token:
      name: token
      type: apiKey
      in: header
  schemas:
    Instance:
      type: object
      description: Representa uma instÃ¢ncia do WhatsApp
      properties:
        id:
          type: string
          format: uuid
          description: ID Ãºnico gerado automaticamente
        token:
          type: string
          description: Token de autenticaÃ§Ã£o da instÃ¢ncia
        status:
          type: string
          description: Status atual da conexÃ£o
        paircode:
          type: string
          description: CÃ³digo de pareamento
        qrcode:
          type: string
          description: QR Code em base64 para autenticaÃ§Ã£o
        name:
          type: string
          description: Nome da instÃ¢ncia
        profileName:
          type: string
          description: Nome do perfil WhatsApp
        profilePicUrl:
          type: string
          format: uri
          description: URL da foto do perfil
        isBusiness:
          type: boolean
          description: Indica se Ã© uma conta business
        plataform:
          type: string
          description: Plataforma de origem (iOS/Android/Web)
        systemName:
          type: string
          description: Nome do sistema operacional
        owner:
          type: string
          description: ProprietÃ¡rio da instÃ¢ncia
        lastDisconnect:
          type: string
          format: date-time
          description: Data/hora da Ãºltima desconexÃ£o
        lastDisconnectReason:
          type: string
          description: Motivo da Ãºltima desconexÃ£o
        adminField01:
          type: string
          description: Campo administrativo 01
        adminField02:
          type: string
          description: Campo administrativo 02
        openai_apikey:
          type: string
          description: Chave da API OpenAI
        chatbot_enabled:
          type: boolean
          description: Habilitar chatbot automÃ¡tico
        chatbot_ignoreGroups:
          type: boolean
          description: Ignorar mensagens de grupos
        chatbot_stopConversation:
          type: string
          description: Palavra-chave para parar conversa
        chatbot_stopMinutes:
          type: integer
          description: Por quanto tempo ficarÃ¡ pausado o chatbot ao usar stop conversation
        chatbot_stopWhenYouSendMsg:
          type: integer
          description: Por quanto tempo ficarÃ¡ pausada a conversa quando vocÃª enviar
            mensagem manualmente
        created:
          type: string
          format: date-time
          description: Data de criaÃ§Ã£o da instÃ¢ncia
        updated:
          type: string
          format: date-time
          description: Data da Ãºltima atualizaÃ§Ã£o
        msg_delay_min:
          type: integer
          format: int64
          minimum: 1
          description: Delay mÃ­nimo em segundos entre mensagens diretas
          default: 2
        msg_delay_max:
          type: integer
          format: int64
          minimum: 1
          description: Delay mÃ¡ximo em segundos entre mensagens diretas (deve ser maior
            que delayMin)
          default: 4
      example:
        id: i91011ijkl
        token: abc123xyz
        status: connected
        paircode: 1234-5678
        qrcode: data:image/png;base64,iVBORw0KGg...
        name: InstÃ¢ncia Principal
        profileName: Loja ABC
        profilePicUrl: https://example.com/profile.jpg
        isBusiness: true
        plataform: Android
        systemName: zaptoswpp
        owner: user@example.com
        lastDisconnect: 2025-01-24T14:00:00Z
        lastDisconnectReason: Network error
        adminField01: custom_data
        openai_apikey: sk-...xyz
        chatbot_enabled: true
        chatbot_ignoreGroups: true
        chatbot_stopConversation: parar
        chatbot_stopMinutes: 60
        created: 2025-01-24T14:00:00Z
        updated: 2025-01-24T14:30:00Z
        delayMin: 2
        delayMax: 4
    Webhook:
      type: object
      description: ConfiguraÃ§Ã£o completa de webhook com filtros e opÃ§Ãµes avanÃ§adas
      properties:
        id:
          type: string
          format: uuid
          description: ID Ãºnico gerado automaticamente
        instance_id:
          type: string
          description: ID da instÃ¢ncia associada
        enabled:
          type: boolean
          description: Webhook ativo/inativo
          default: false
        url:
          type: string
          format: uri
          description: URL de destino dos eventos
        events:
          type: array
          items:
            type: string
            enum:
              - connection
              - history
              - messages
              - messages_update
              - call
              - contacts
              - presence
              - groups
              - labels
              - chats
              - chat_labels
              - blocks
              - leads
          description: Tipos de eventos monitorados
        AddUrlTypesMessages:
          type: boolean
          description: Incluir na URLs o tipo de mensagem
          default: false
        addUrlEvents:
          type: boolean
          description: Incluir na URL o nome do evento
          default: false
        excludeMessages:
          type: array
          items:
            type: string
            enum:
              - wasSentByApi
              - wasNotSentByApi
              - fromMeYes
              - fromMeNo
              - isGroupYes
              - IsGroupNo
          description: Filtros para excluir tipos de mensagens
        created:
          type: string
          format: date-time
          description: Data de criaÃ§Ã£o (automÃ¡tica)
          readOnly: true
        updated:
          type: string
          format: date-time
          description: Data da Ãºltima atualizaÃ§Ã£o (automÃ¡tica)
          readOnly: true
      required:
        - url
        - events
      example:
        id: wh_9a8b7c6d5e
        instance_id: inst_12345
        enabled: true
        url: https://webhook.cool/example
        events:
          - messages
          - connection
        AddUrlTypesMessages: false
        addUrlEvents: false
        excludeMessages: []
        created: 2025-01-24T16:20:00Z
        updated: 2025-01-24T16:25:00Z
    Chat:
      type: object
      description: Representa uma conversa/chamado no sistema
      properties:
        id:
          type: string
          description: ID Ãºnico da conversa (r + 7 bytes aleatÃ³rios em hex)
        wa_fastid:
          type: string
          description: Identificador rÃ¡pido do WhatsApp
        wa_chatid:
          type: string
          description: ID completo do chat no WhatsApp
        wa_archived:
          type: boolean
          description: Indica se o chat estÃ¡ arquivado
          default: false
        wa_contactName:
          type: string
          description: Nome do contato no WhatsApp
          default: ""
        wa_name:
          type: string
          description: Nome do WhatsApp
          default: ""
        name:
          type: string
          description: Nome exibido do chat
          default: ""
        image:
          type: string
          description: URL da imagem do chat
          default: ""
        imagePreview:
          type: string
          description: URL da miniatura da imagem
          default: ""
        wa_ephemeralExpiration:
          type: integer
          format: int64
          description: Tempo de expiraÃ§Ã£o de mensagens efÃªmeras
          default: 0
        wa_isBlocked:
          type: boolean
          description: Indica se o contato estÃ¡ bloqueado
          default: false
        wa_isGroup:
          type: boolean
          description: Indica se Ã© um grupo
          default: false
        wa_isGroup_admin:
          type: boolean
          description: Indica se o usuÃ¡rio Ã© admin do grupo
          default: false
        wa_isGroup_announce:
          type: boolean
          description: Indica se Ã© um grupo somente anÃºncios
          default: false
        wa_isGroup_community:
          type: boolean
          description: Indica se Ã© uma comunidade
          default: false
        wa_isGroup_member:
          type: boolean
          description: Indica se Ã© membro do grupo
          default: false
        wa_isPinned:
          type: boolean
          description: Indica se o chat estÃ¡ fixado
          default: false
        wa_label:
          type: string
          description: Labels do chat em JSON
          default: "[]"
        wa_lastMessageTextVote:
          type: string
          description: Texto/voto da Ãºltima mensagem
          default: ""
        wa_lastMessageType:
          type: string
          description: Tipo da Ãºltima mensagem
          default: ""
        wa_lastMsgTimestamp:
          type: integer
          format: int64
          description: Timestamp da Ãºltima mensagem
          default: 0
        wa_lastMessageSender:
          type: string
          description: Remetente da Ãºltima mensagem
          default: ""
        wa_muteEndTime:
          type: integer
          format: int64
          description: Timestamp do fim do silenciamento
          default: 0
        owner:
          type: string
          description: Dono da instÃ¢ncia
          default: ""
        wa_unreadCount:
          type: integer
          format: int64
          description: Contador de mensagens nÃ£o lidas
          default: 0
        phone:
          type: string
          description: NÃºmero de telefone
          default: ""
        wa_common_groups:
          type: string
          description: "Grupos em comum separados por vÃ­rgula, formato:
            (nome_grupo)id_grupo"
          default: ""
          example: Grupo
            FamÃ­lia(120363123456789012@g.us),Trabalho(987654321098765432@g.us)
        lead_name:
          type: string
          description: Nome do lead
          default: ""
        lead_fullName:
          type: string
          description: Nome completo do lead
          default: ""
        lead_email:
          type: string
          description: Email do lead
          default: ""
        lead_personalid:
          type: string
          description: Documento de identificaÃ§Ã£o
          default: ""
        lead_status:
          type: string
          description: Status do lead
          default: ""
        lead_tags:
          type: string
          description: Tags do lead em JSON
        lead_notes:
          type: string
          description: AnotaÃ§Ãµes sobre o lead
          default: ""
        lead_isTicketOpen:
          type: boolean
          description: Indica se tem ticket aberto
          default: false
        lead_assignedAttendant_id:
          type: string
          description: ID do atendente responsÃ¡vel
          default: ""
        lead_kanbanOrder:
          type: integer
          format: int64
          description: Ordem no kanban
          default: 0
        lead_field01:
          type: string
          default: ""
        lead_field02:
          type: string
          default: ""
        lead_field03:
          type: string
          default: ""
        lead_field04:
          type: string
          default: ""
        lead_field05:
          type: string
          default: ""
        lead_field06:
          type: string
          default: ""
        lead_field07:
          type: string
          default: ""
        lead_field08:
          type: string
          default: ""
        lead_field09:
          type: string
          default: ""
        lead_field10:
          type: string
          default: ""
        lead_field11:
          type: string
          default: ""
        lead_field12:
          type: string
          default: ""
        lead_field13:
          type: string
          default: ""
        lead_field14:
          type: string
          default: ""
        lead_field15:
          type: string
          default: ""
        lead_field16:
          type: string
          default: ""
        lead_field17:
          type: string
          default: ""
        lead_field18:
          type: string
          default: ""
        lead_field19:
          type: string
          default: ""
        lead_field20:
          type: string
          default: ""
        chatbot_agentResetMemoryAt:
          type: integer
          format: int64
          description: Timestamp do Ãºltimo reset de memÃ³ria
          default: 0
        chatbot_lastTrigger_id:
          type: string
          description: ID do Ãºltimo gatilho executado
          default: ""
        chatbot_lastTriggerAt:
          type: integer
          format: int64
          description: Timestamp do Ãºltimo gatilho
          default: 0
        chatbot_disableUntil:
          type: integer
          format: int64
          description: Timestamp atÃ© quando chatbot estÃ¡ desativado
          default: 0
        created:
          type: string
          description: Data de criaÃ§Ã£o
          default: strftime('%Y-%m-%d %H:%M:%f', 'now')
        updated:
          type: string
          description: Data da Ãºltima atualizaÃ§Ã£o
          default: strftime('%Y-%m-%d %H:%M:%f', 'now')
    Message:
      type: object
      description: Representa uma mensagem trocada no sistema
      properties:
        id:
          type: string
          format: uuid
          description: ID Ãºnico interno da mensagem (formato r + 7 caracteres hex
            aleatÃ³rios)
        messageid:
          type: string
          description: ID original da mensagem no provedor
        chatid:
          type: string
          description: ID da conversa relacionada
        fromMe:
          type: boolean
          description: Indica se a mensagem foi enviada pelo usuÃ¡rio
          default: false
        isGroup:
          type: boolean
          description: Indica se Ã© uma mensagem de grupo
          default: false
        messageType:
          type: string
          enum:
            - text
            - image
            - video
            - document
            - audio
            - location
            - button
            - list
            - reaction
          description: Tipo de conteÃºdo da mensagem
        messageTimestamp:
          type: integer
          description: Timestamp original da mensagem em milissegundos
          default: 0
        edited:
          type: string
          description: HistÃ³rico de ediÃ§Ãµes da mensagem
          default: ""
        quoted:
          type: string
          description: ID da mensagem citada/respondida
          default: ""
        reaction:
          type: string
          description: ID da mensagem reagida
          default: ""
        sender:
          type: string
          description: ID do remetente da mensagem
          default: ""
        senderName:
          type: string
          description: Nome exibido do remetente
          default: ""
        source:
          type: string
          enum:
            - ios
            - web
            - android
          description: Plataforma de origem da mensagem
          default: ""
        status:
          type: string
          enum:
            - pending
            - sent
            - delivered
            - read
            - failed
            - deleted
          description: Status do ciclo de vida da mensagem
          default: ""
        text:
          type: string
          description: Texto original da mensagem
          default: ""
        vote:
          type: string
          description: Dados de votaÃ§Ã£o de enquete e listas
          default: ""
        buttonOrListid:
          type: string
          description: ID do botÃ£o ou item de lista selecionado
          default: ""
        convertOptions:
          type: string
          description: ConversÃ£o de opÃ§Ãµes de da mensagem, lista, enquete e botÃµes
          default: ""
        fileURL:
          type: string
          format: uri
          description: URL para download de arquivos de mÃ­dia
          default: ""
        content:
          type: string
          description: ConteÃºdo completo da mensagem em formato JSON
        owner:
          type: string
          description: Dono da mensagem
          default: ""
        track_source:
          type: string
          description: Origem do rastreamento da mensagem
          default: ""
        track_id:
          type: string
          description: ID para rastreamento da mensagem (aceita valores duplicados)
          default: ""
        created:
          type: string
          format: date-time
          description: Data de criaÃ§Ã£o no sistema (formato SQLite YYYY-MM-DD HH:MM:SS.FFF)
          default: (strftime('%Y-%m-%d %H:%M:%f', 'now'))
        updated:
          type: string
          format: date-time
          description: Data da Ãºltima atualizaÃ§Ã£o (formato SQLite YYYY-MM-DD HH:MM:SS.FFF)
          default: (strftime('%Y-%m-%d %H:%M:%f', 'now'))
        ai_metadata:
          type: object
          description: Metadados do processamento por IA
          properties:
            agent_id:
              type: string
              description: ID do agente de IA responsÃ¡vel
            request:
              type: object
              description: Dados da requisiÃ§Ã£o Ã  API de IA
              properties:
                messages:
                  type: array
                  description: HistÃ³rico de mensagens enviadas para a API
                tools:
                  type: array
                  description: Ferramentas disponÃ­veis para o agente
                options:
                  type: object
                  description: OpÃ§Ãµes de configuraÃ§Ã£o da API
                  properties:
                    model:
                      type: string
                    temperature:
                      type: number
                    maxTokens:
                      type: integer
                    topP:
                      type: number
                    frequencyPenalty:
                      type: number
                    presencePenalty:
                      type: number
            response:
              type: object
              description: Resposta da API de IA
              properties:
                choices:
                  type: array
                  description: Resultados retornados pela API
                toolResults:
                  type: array
                  description: Resultados da execuÃ§Ã£o de ferramentas
                error:
                  type: string
                  description: Mensagem de erro, se houver
    Label:
      type: object
      description: Representa uma etiqueta/categoria no sistema
      properties:
        id:
          type: string
          format: uuid
          description: ID Ãºnico da etiqueta
        name:
          type: string
          description: Nome da etiqueta
        color:
          type: integer
          description: Ãndice numÃ©rico da cor (0-19)
          minimum: 0
          maximum: 19
          example: 2
        colorHex:
          type: string
          description: Cor hexadecimal correspondente ao Ã­ndice
          enum:
            - "#ff9484"
            - "#64c4ff"
            - "#fed428"
            - "#dfaef0"
            - "#9ab6c1"
            - "#56ccb4"
            - "#fe9dfe"
            - "#d3a91f"
            - "#6f7bcf"
            - "#d8e651"
            - "#01d0e2"
            - "#ffc5c7"
            - "#92ceac"
            - "#f64847"
            - "#00a1f2"
            - "#83e421"
            - "#ffae04"
            - "#b4ebff"
            - "#9ba6ff"
            - "#9568cf"
          example: "#fed428"
        createdAt:
          type: string
          format: date-time
          description: Data de criaÃ§Ã£o
      example:
        id: l121314mnop
        name: Cliente VIP
        color: 2
        colorHex: "#fed428"
        createdAt: 2025-01-24T14:35:00.000Z
    Attendant:
      type: object
      description: Modelo de atendente do sistema
      properties:
        id:
          type: string
          format: uuid
          description: ID Ãºnico gerado automaticamente
        name:
          type: string
          description: Nome do atendente
          default: ""
        phone:
          type: string
          description: NÃºmero de telefone
          default: ""
        email:
          type: string
          format: email
          description: EndereÃ§o de e-mail
          default: ""
        department:
          type: string
          description: Departamento de atuaÃ§Ã£o
          default: ""
        customField01:
          type: string
          description: Campo personalizÃ¡vel 01
          default: ""
        customField02:
          type: string
          description: Campo personalizÃ¡vel 02
          default: ""
        owner:
          type: string
          description: ResponsÃ¡vel pelo cadastro
          default: ""
        created:
          type: string
          format: date-time
          description: Data de criaÃ§Ã£o automÃ¡tica
        updated:
          type: string
          format: date-time
          description: Data de atualizaÃ§Ã£o automÃ¡tica
      example:
        id: r1234abcd
        name: JoÃ£o da Silva
        phone: "+5511999999999"
        email: joao@empresa.com
        department: Suporte TÃ©cnico
        customField01: "Turno: ManhÃ£"
        customField02: "NÃ­vel: 2"
        owner: admin
        created: 2025-01-24T13:52:19.000Z
        updated: 2025-01-24T13:52:19.000Z
    ChatbotTrigger:
      type: object
      required:
        - type
        - agent_id
      properties:
        id:
          type: string
          description: >-
            Identificador Ãºnico do trigger. Se definido, vocÃª irÃ¡ editar ou
            deletar o trigger.

            Se vazio, um novo trigger serÃ¡ criado.
        active:
          type: boolean
          default: true
          description: |-
            Define se o trigger estÃ¡ ativo e disponÃ­vel para uso.
            Triggers inativos nÃ£o serÃ£o executados pelo sistema.
        type:
          type: string
          enum:
            - agent
            - quickreply
          default: agent
          description: |-
            Tipo do trigger:
            * agent - aciona um agente de IA
            * quickreply - aciona respostas rÃ¡pidas predefinidas
        agent_id:
          type: string
          description: ID do agente de IA. ObrigatÃ³rio quando type='agent'
        quickReply_id:
          type: string
          description: ID da resposta rÃ¡pida. ObrigatÃ³rio quando type='quickreply'
        ignoreGroups:
          type: boolean
          default: true
          description: Define se o trigger deve ignorar mensagens de grupos
        lead_field:
          type: string
          enum:
            - lead_name
            - lead_fullName
            - lead_email
            - lead_personalid
            - lead_status
            - lead_tags
            - lead_notes
            - lead_isTicketOpen
            - lead_field01
            - lead_field02
            - lead_field03
            - lead_field04
            - lead_field05
            - lead_field06
            - lead_field07
            - lead_field08
            - lead_field09
            - lead_field10
            - lead_field11
            - lead_field12
            - lead_field13
            - lead_field14
            - lead_field15
            - lead_field16
            - lead_field17
            - lead_field18
            - lead_field19
            - lead_field20
          description: Campo do lead usado para condiÃ§Ã£o do trigger
        lead_operator:
          type: string
          enum:
            - equals
            - not_equals
            - contains
            - not_contains
            - greater
            - less
            - empty
            - not_empty
          description: |-
            Operador de comparaÃ§Ã£o para condiÃ§Ã£o do lead:
            * equals - igual a
            * not_equals - diferente de
            * contains - contÃ©m
            * not_contains - nÃ£o contÃ©m
            * greater - maior que
            * less - menor que
            * empty - vazio
            * not_empty - nÃ£o vazio
        lead_value:
          type: string
          description: Valor para comparaÃ§Ã£o com o campo do lead. Usado em conjunto com
            lead_field e lead_operator
        priority:
          type: integer
          format: int64
          default: 1
          description: >-
            Prioridade do trigger. Quando existem mÃºltiplos triggers que
            poderiam ser acionados,

            APENAS o trigger com maior prioridade serÃ¡ executado.

            Se houver mÃºltiplos triggers com a mesma prioridade mais alta, um
            serÃ¡ escolhido aleatoriamente.
        wordsToStart:
          type: string
          description: |-
            Palavras-chave ou frases que ativam o trigger.
            MÃºltiplas entradas separadas por pipe (|).
            Exemplo: olÃ¡|bom dia|qual seu nome
        responseDelay_seconds:
          type: integer
          format: int64
          default: 10
          description: Tempo de espera em segundos antes de executar o trigger
        owner:
          type: string
          description: Identificador do proprietÃ¡rio do trigger
        created:
          type: string
          format: date-time
          description: Data e hora de criaÃ§Ã£o
        updated:
          type: string
          format: date-time
          description: Data e hora da Ãºltima atualizaÃ§Ã£o
    ChatbotAIAgent:
      type: object
      description: ConfiguraÃ§Ã£o de um agente de IA para atendimento de conversas
      properties:
        id:
          type: string
          format: uuid
          description: ID Ãºnico gerado pelo sistema
        name:
          type: string
          description: Nome de exibiÃ§Ã£o do agente
        provider:
          type: string
          enum:
            - openai
            - anthropic
            - gemini
            - custom
          description: Provedor do serviÃ§o de IA
        model:
          type: string
          description: Nome do modelo LLM a ser utilizado
        apikey:
          type: string
          description: Chave de API para autenticaÃ§Ã£o no provedor
          x-sensitive: true
        basePrompt:
          type: string
          description: Prompt base para orientar o comportamento do agente
        maxTokens:
          type: integer
          description: NÃºmero mÃ¡ximo de tokens por resposta
        temperature:
          type: integer
          minimum: 0
          maximum: 100
          description: Controle de criatividade (0-100)
        diversityLevel:
          type: integer
          minimum: 0
          maximum: 100
          description: NÃ­vel de diversificaÃ§Ã£o das respostas
        frequencyPenalty:
          type: integer
          minimum: 0
          maximum: 100
          description: Penalidade para repetiÃ§Ã£o de frases
        presencePenalty:
          type: integer
          minimum: 0
          maximum: 100
          description: Penalidade para manter foco no tÃ³pico
        signMessages:
          type: boolean
          description: Adiciona identificaÃ§Ã£o do agente nas mensagens
        readMessages:
          type: boolean
          description: Marca mensagens como lidas automaticamente
        maxMessageLength:
          type: integer
          description: Tamanho mÃ¡ximo permitido para mensagens (caracteres)
        typingDelay_seconds:
          type: integer
          description: Atraso simulado de digitaÃ§Ã£o em segundos
        contextTimeWindow_hours:
          type: integer
          description: Janela temporal para contexto da conversa
        contextMaxMessages:
          type: integer
          description: NÃºmero mÃ¡ximo de mensagens no contexto
        contextMinMessages:
          type: integer
          description: NÃºmero mÃ­nimo de mensagens para iniciar contexto
        owner:
          type: string
          description: ResponsÃ¡vel/ProprietÃ¡rio do agente
        created:
          type: string
          format: date-time
          description: Data de criaÃ§Ã£o do registro
        updated:
          type: string
          format: date-time
          description: Data da Ãºltima atualizaÃ§Ã£o
      required:
        - name
        - provider
        - model
        - apikey
    ChatbotAIFunction:
      type: object
      properties:
        id:
          type: string
          description: ID Ãºnico da funÃ§Ã£o gerado automaticamente
        name:
          type: string
          description: Nome da funÃ§Ã£o
        description:
          type: string
          description: DescriÃ§Ã£o da funÃ§Ã£o
        active:
          type: boolean
          default: false
          description: Indica se a funÃ§Ã£o estÃ¡ ativa
        method:
          type: string
          description: MÃ©todo HTTP da requisiÃ§Ã£o
        endpoint:
          type: string
          description: Endpoint da API
        headers:
          type: string
          nullable: true
          description: CabeÃ§alhos da requisiÃ§Ã£o
        body:
          type: string
          nullable: true
          description: Corpo da requisiÃ§Ã£o
        parameters:
          type: string
          nullable: true
          default: "[]"
          description: ParÃ¢metros da funÃ§Ã£o
        undocumentedParameters:
          type: string
          description: ParÃ¢metros nÃ£o documentados
        header_error:
          type: boolean
          default: false
          description: Indica erro de formataÃ§Ã£o nos cabeÃ§alhos
        body_error:
          type: boolean
          default: false
          description: Indica erro de formataÃ§Ã£o no corpo
        owner:
          type: string
          description: ProprietÃ¡rio da funÃ§Ã£o
        created:
          type: string
          format: date-time
          default: strftime('%Y-%m-%d %H:%M:%fZ')
          description: Data de criaÃ§Ã£o
        updated:
          type: string
          format: date-time
          default: strftime('%Y-%m-%d %H:%M:%fZ')
          description: Data de atualizaÃ§Ã£o
      required:
        - name
        - description
        - method
        - endpoint
    ChatbotAIKnowledge:
      type: object
      properties:
        id:
          type: string
          description: ID Ãºnico gerado automaticamente
          example: r1a2b3c4
        active:
          type: boolean
          default: false
          description: Indica se o conhecimento estÃ¡ ativo
        tittle:
          type: string
          default: ""
          description: TÃ­tulo do conhecimento
        content:
          type: string
          default: ""
          description: ConteÃºdo textual do conhecimento
        vectorStatus:
          type: string
          default: ""
          description: Status da vetorizaÃ§Ã£o no sistema
        isVectorized:
          type: boolean
          default: false
          description: Indica se o conteÃºdo foi vetorizado
        lastVectorizedAt:
          type: integer
          format: int64
          default: 0
          description: Timestamp da Ãºltima vetorizaÃ§Ã£o
        owner:
          type: string
          default: ""
          description: ProprietÃ¡rio do conhecimento
        priority:
          type: integer
          format: int64
          default: 0
          description: Prioridade de uso do conhecimento
        created:
          type: string
          format: date-time
          description: Data de criaÃ§Ã£o
        updated:
          type: string
          format: date-time
          description: Data de atualizaÃ§Ã£o
      required:
        - id
        - active
        - tittle
        - content
    MessageQueueFolder:
      type: object
      description: Pasta para organizaÃ§Ã£o de campanhas de mensagens em massa
      properties:
        id:
          type: string
          description: Identificador Ãºnico
        info:
          type: string
          description: InformaÃ§Ãµes adicionais sobre a pasta
        status:
          type: string
          description: Status atual da pasta
          example: ativo
        scheduled_for:
          type: integer
          format: int64
          description: Timestamp Unix para execuÃ§Ã£o agendada
        delayMax:
          type: integer
          format: int64
          description: Atraso mÃ¡ximo entre mensagens em milissegundos
        delayMin:
          type: integer
          format: int64
          description: Atraso mÃ­nimo entre mensagens em milissegundos
        log_delivered:
          type: integer
          format: int64
          description: Contagem de mensagens entregues
        log_failed:
          type: integer
          format: int64
          description: Contagem de mensagens com falha
        log_played:
          type: integer
          format: int64
          description: Contagem de mensagens reproduzidas (para Ã¡udio/vÃ­deo)
        log_read:
          type: integer
          format: int64
          description: Contagem de mensagens lidas
        log_sucess:
          type: integer
          format: int64
          description: Contagem de mensagens enviadas com sucesso
        log_total:
          type: integer
          format: int64
          description: Contagem total de mensagens
        owner:
          type: string
          description: Identificador do proprietÃ¡rio da instÃ¢ncia
        created:
          type: string
          format: date-time
          description: Data e hora de criaÃ§Ã£o
        updated:
          type: string
          format: date-time
          description: Data e hora da Ãºltima atualizaÃ§Ã£o
    QuickReply:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: ID Ãºnico da resposta rÃ¡pida
        shortcut:
          type: string
          description: Atalho para acionar a resposta
        content:
          type: string
          description: ConteÃºdo da mensagem prÃ©-definida
        category:
          type: string
          description: Categoria para organizaÃ§Ã£o
        createdAt:
          type: string
          format: date-time
          description: Data de criaÃ§Ã£o
        updatedAt:
          type: string
          format: date-time
          description: Data da Ãºltima atualizaÃ§Ã£o
      required:
        - shortcut
        - content
    Group:
      type: object
      description: Representa um grupo/conversa coletiva
      properties:
        JID:
          type: string
          format: jid
          description: Identificador Ãºnico do grupo
          example: jid8@g.us
        OwnerJID:
          type: string
          format: jid
          description: JID do proprietÃ¡rio do grupo
          example: 1232@s.whatsapp.net
        Name:
          type: string
          description: Nome do grupo
          example: Grupo de Suporte
        NameSetAt:
          type: string
          format: date-time
          description: Data da Ãºltima alteraÃ§Ã£o do nome
        NameSetBy:
          type: string
          format: jid
          description: JID do usuÃ¡rio que definiu o nome
        Topic:
          type: string
          description: DescriÃ§Ã£o do grupo
        IsLocked:
          type: boolean
          description: |-
            Indica se apenas administradores podem editar informaÃ§Ãµes do grupo
            - true = apenas admins podem editar
            - false = todos podem editar
          example: true
        IsAnnounce:
          type: boolean
          description: Indica se apenas administradores podem enviar mensagens
        AnnounceVersionID:
          type: string
          description: VersÃ£o da configuraÃ§Ã£o de anÃºncios
        IsEphemeral:
          type: boolean
          description: Indica se as mensagens sÃ£o temporÃ¡rias
        DisappearingTimer:
          type: integer
          description: Tempo em segundos para desaparecimento de mensagens
          minimum: 0
        IsIncognito:
          type: boolean
          description: Indica se o grupo Ã© incognito
        IsParent:
          type: boolean
          description: Indica se Ã© um grupo pai (comunidade)
        IsJoinApprovalRequired:
          type: boolean
          description: Indica se requer aprovaÃ§Ã£o para novos membros
        LinkedParentJID:
          type: string
          format: jid
          description: JID da comunidade vinculada
        IsDefaultSubGroup:
          type: boolean
          description: Indica se Ã© um subgrupo padrÃ£o da comunidade
        GroupCreated:
          type: string
          format: date-time
          description: Data de criaÃ§Ã£o do grupo
        ParticipantVersionID:
          type: string
          description: VersÃ£o da lista de participantes
        Participants:
          type: array
          items:
            $ref: "#/GroupParticipant"
          description: Lista de participantes do grupo
        MemberAddMode:
          type: string
          enum:
            - admin_add
            - all_member_add
          description: Modo de adiÃ§Ã£o de novos membros
        OwnerCanSendMessage:
          type: boolean
          description: Verifica se Ã© possÃ­vel vocÃª enviar mensagens
        OwnerIsAdmin:
          type: boolean
          description: Verifica se vocÃª adminstrador do grupo
        DefaultSubGroupId:
          type: string
          description: Se o grupo atual for uma comunidade, nesse campo mostrarÃ¡ o ID do
            subgrupo de avisos
        invite_link:
          type: string
          description: Link de convite para entrar no grupo
        request_participants:
          type: string
          description: Lista de solicitaÃ§Ãµes de entrada, separados por vÃ­rgula
    GroupParticipant:
      type: object
      description: Participante de um grupo
      properties:
        JID:
          type: string
          format: jid
          description: Identificador do participante
        LID:
          type: string
          format: jid
          description: Identificador local do participante
        IsAdmin:
          type: boolean
          description: Indica se Ã© administrador
        IsSuperAdmin:
          type: boolean
          description: Indica se Ã© super administrador
        DisplayName:
          type: string
          description: Nome exibido no grupo (para usuÃ¡rios anÃ´nimos)
        Error:
          type: integer
          description: CÃ³digo de erro ao adicionar participante
          minimum: 0
        AddRequest:
          type: object
          description: InformaÃ§Ãµes da solicitaÃ§Ã£o de entrada
          properties:
            Code:
              type: string
              description: CÃ³digo da solicitaÃ§Ã£o
            Expiration:
              type: string
              format: date-time
              description: Data de expiraÃ§Ã£o da solicitaÃ§Ã£o
    WebhookEvent:
      type: object
      required:
        - event
        - instance
        - data
      properties:
        event:
          type: string
          enum:
            - message
            - status
            - presence
            - group
            - connection
          description: Tipo do evento recebido
        instance:
          type: string
          description: ID da instÃ¢ncia que gerou o evento
        data:
          oneOf:
            - $ref: "#/components/schemas/MessageEventData"
            - $ref: "#/components/schemas/StatusEventData"
            - $ref: "#/components/schemas/PresenceEventData"
            - $ref: "#/components/schemas/GroupEventData"
            - $ref: "#/components/schemas/ConnectionEventData"
security:
  - token: []
x-tagGroups:
  - name: ENDPOINTS
    description: Endpoints principais da API ZaptosWPP.
    tags:
      - AdmininstraÃ§Ã£o
      - Instancia
      - Perfil
      - Chamadas
      - Webhooks e SSE
      - Enviar Mensagem
      - AÃ§Ãµes na mensagem e Buscar
      - Chats
      - Contatos
      - Bloqueios
      - Etiquetas
      - Grupos e Comunidades
      - Respostas RÃ¡pidas
      - CRM
      - Mensagem em massa
      - IntegraÃ§Ã£o Chatwoot
  - name: ChatBot
    description: >-
      **Sistema avanÃ§ado de chatbots com inteligÃªncia artificial**


      Esta categoria contÃ©m recursos sofisticados para criar chatbots
      inteligentes e automatizar conversas usando IA. Ideal para empresas que
      precisam de atendimento automatizado avanÃ§ado e respostas contextuais.


      ### Recursos de IA incluÃ­dos:

      - ðŸ¤– **IA Conversacional**: IntegraÃ§Ã£o com mÃºltiplos provedores (OpenAI,
      Anthropic, Google, DeepSeek)

      - ðŸ§  **Base de Conhecimento**: Sistema de embeddings com Qdrant para
      respostas contextuais

      - âš™ï¸ **FunÃ§Ãµes Personalizadas**: IntegraÃ§Ã£o com APIs externas e lÃ³gica de
      negÃ³cio complexa

      - ðŸŽ¯ **Triggers Inteligentes**: AtivaÃ§Ã£o automÃ¡tica baseada em contexto e
      palavras-chave

      - ðŸ“‹ **ConfiguraÃ§Ãµes AvanÃ§adas**: PersonalizaÃ§Ã£o completa do comportamento
      do bot


      ### Casos de uso:

      - Atendimento automatizado 24/7

      - QualificaÃ§Ã£o automÃ¡tica de leads

      - Suporte tÃ©cnico com base de conhecimento

      - Agendamento de reuniÃµes e consultas

      - FAQ dinÃ¢mico e contextual


      **Ideal para**: Empresas mÃ©dias/grandes, desenvolvedores, agÃªncias,
      sistemas de atendimento complexos


      **Requer**: Conhecimento tÃ©cnico para configuraÃ§Ã£o adequada e chaves de
      API dos provedores de IA
    tags:
      - Chatbot ConfiguraÃ§Ãµes
      - Chatbot Trigger
      - ConfiguraÃ§Ã£o do Agente de IA
      - Conhecimento dos Agentes
      - FunÃ§Ãµes API dos Agentes
tags:
  - name: AdmininstraÃ§Ã£o
    description: |-
      Endpoints para **administraÃ§Ã£o geral** do sistema.
      Requerem um `admintoken` para autenticaÃ§Ã£o.
  - name: Instancia
    description: |-
      OperaÃ§Ãµes relacionadas ao ciclo de vida de uma instÃ¢ncia, como conectar,
      desconectar e verificar o status.
  - name: Perfil
    description: |-
      OperaÃ§Ãµes relacionadas ao perfil da instÃ¢ncia do WhatsApp, como alterar
      nome e imagem de perfil.
  - name: Chamadas
    description: |-
      OperaÃ§Ãµes relacionadas a chamadas peloWhatsApp.
      Permite realizar e rejeitar chamadas programaticamente.
  - name: Webhooks e SSE
  - name: Enviar Mensagem
    description: >-
      Endpoints para envio de mensagens do WhatsApp com diferentes tipos de
      conteÃºdo.


      ## Campos Opcionais Comuns


      Todos os endpoints de envio de mensagem suportam os seguintes campos
      opcionais:


      - **`delay`** *(integer)*: Atraso em milissegundos antes do envio
        - Durante o atraso aparecerÃ¡ "Digitando..." ou "Gravando Ã¡udio..." dependendo do tipo
        - Exemplo: `5000` (5 segundos)

      - **`readchat`** *(boolean)*: Marcar chat como lido apÃ³s envio
        - Remove o contador de mensagens nÃ£o lidas do chat
        - Exemplo: `true`

      - **`readmessages`** *(boolean)*: Marcar Ãºltimas mensagens recebidas como
      lidas
        - Marca as Ãºltimas 10 mensagens **recebidas** (nÃ£o enviadas por vocÃª) como lidas
        - Ãštil para confirmar leitura de mensagens pendentes antes de responder
        - Diferente do `readchat` que apenas remove contador de nÃ£o lidas
        - Exemplo: `true`

      - **`replyid`** *(string)*: ID da mensagem para responder
        - Cria uma resposta vinculada Ã  mensagem original
        - Suporte varia por tipo de mensagem
        - Exemplo: `"3A12345678901234567890123456789012"`

      - **`mentions`** *(string)*: NÃºmeros para mencionar (apenas para envio em
      grupos)
        - NÃºmeros especÃ­ficos: `"5511999999999,5511888888888"`
        - Mencionar todos: `"all"`

      - **`forward`** *(boolean)*: Marca a mensagem como encaminhada no WhatsApp
        - Adiciona o indicador "Encaminhada" na mensagem
        - Exemplo: `true`

      - **`track_source`** *(string)*: Origem do rastreamento da mensagem
        - Identifica o sistema ou fonte que estÃ¡ enviando a mensagem
        - Ãštil para integraÃ§Ãµes (ex: "chatwoot", "crm", "chatbot")
        - Exemplo: `"chatwoot"`

      - **`track_id`** *(string)*: ID para rastreamento da mensagem
        - Identificador livre para acompanhar a mensagem em sistemas externos
        - Permite correlacionar mensagens entre diferentes plataformas
        - **Nota**: O sistema aceita valores duplicados - nÃ£o hÃ¡ validaÃ§Ã£o de unicidade
        - Use o mesmo ID em vÃ¡rias mensagens se fizer sentido para sua integraÃ§Ã£o
        - Exemplo: `"msg_123456789"`

      ### Envio para Grupos

      - **`number`** *(string)*: Para enviar mensagem para grupo, use o ID do
      grupo que termina com `@g.us`
        - Exemplo: `"120363012345678901@g.us"`
        - **Como obter o ID do grupo:**
          - Use o `chatid` do webhook recebido quando alguÃ©m envia mensagem no grupo
          - Use o endpoint `GET /group/list` para listar todos os grupos e seus IDs

      ## Placeholders DisponÃ­veis


      Todos os endpoints de envio de mensagem suportam placeholders dinÃ¢micos
      para personalizaÃ§Ã£o automÃ¡tica:


      ### Campos de Nome

      - **`{{name}}`**: Nome consolidado do chat, usando a primeira opÃ§Ã£o
      disponÃ­vel:
        1. Nome do lead (`lead_name`)
        2. Nome completo do lead (`lead_fullName`)
        3. Nome do contato no WhatsApp (`wa_contactName`)
        4. Nome do perfil do WhatsApp (`wa_name`)

      - **`{{first_name}}`**: Primeira palavra vÃ¡lida do nome consolidado
      (mÃ­nimo 2 caracteres)


      ### Campos do WhatsApp

      - **`{{wa_name}}`**: Nome do perfil do WhatsApp

      - **`{{wa_contactName}}`**: Nome do contato como salvo no WhatsApp


      ### Campos do Lead

      - **`{{lead_name}}`**: Nome do lead

      - **`{{lead_fullName}}`**: Nome completo do lead

      - **`{{lead_personalid}}`**: ID pessoal (CPF, CNPJ, etc)

      - **`{{lead_email}}`**: Email do lead

      - **`{{lead_status}}`**: Status atual do lead

      - **`{{lead_notes}}`**: AnotaÃ§Ãµes do lead

      - **`{{lead_assignedAttendant_id}}`**: ID do atendente designado


      ### Campos Personalizados

      Campos adicionados via custom fields sÃ£o acessÃ­veis usando
      `{{lead_field01}}` Ã  `{{lead_field20}}` ou usar `{{nomedocampo}}` definido
      em `/instance/updateFieldsMap`.


      ### Exemplo de Uso

      ```

      OlÃ¡ {{name}}! Vi que vocÃª trabalha na {{company}}.

      Seu email {{lead_email}} estÃ¡ correto?

      ```


      **ðŸ’¡ Dica**: Use `/chat/find` para buscar dados do chat e ver os campos
      disponÃ­veis antes de enviar mensagens com placeholders.
  - name: AÃ§Ãµes na mensagem e Buscar
  - name: Chats
  - name: Contatos
  - name: Bloqueios
  - name: Etiquetas
  - name: Grupos e Comunidades
  - name: Respostas RÃ¡pidas
    description: >-
      Gerenciamento de respostas rÃ¡pidas para agilizar o atendimento.


      **âš ï¸ Importante**: Este recurso tem serventia apenas se vocÃª utilizar um
      sistema frontend/interface

      personalizada para registrar e utilizar as respostas. A API apenas
      armazena as respostas, 

      mas nÃ£o as aplica automaticamente.


      ### Como funciona:

      - **Criar**: Cadastre respostas prÃ©-definidas com tÃ­tulos e conteÃºdo

      - **Listar**: Recupere todas as respostas cadastradas para exibir na sua
      interface

      - **Usar**: Seu sistema frontend pode usar essas respostas para agilizar
      digitaÃ§Ã£o


      ### Casos de uso:

      - Interfaces web personalizadas de atendimento

      - Apps mobile com sugestÃµes de resposta

      - Sistemas CRM com templates de mensagem

      - Ferramentas de produtividade para atendentes


      **NÃ£o Ã© um chatbot**: Para respostas automÃ¡ticas, use os recursos de
      Chatbot.
  - name: CRM
    description: >-
      Sistema completo de gestÃ£o de relacionamento com clientes integrado Ã  API.


      **ðŸ’¾ Armazenamento interno**: Todos os dados dos leads ficam salvos
      diretamente na API,

      eliminando a necessidade de bancos de dados externos. Sua aplicaÃ§Ã£o pode
      focar apenas

      na interface e lÃ³gica de negÃ³cio.


      ### Recursos disponÃ­veis:

      - **ðŸ“‹ 20+ campos personalizÃ¡veis**: Nome, telefone, email, empresa,
      observaÃ§Ãµes, etc.

      - **ðŸ·ï¸ Sistema de etiquetas**: Organize e categorize seus contatos

      - **ðŸ” Busca avanÃ§ada**: Filtre por qualquer campo ou etiqueta

      - **ðŸ“Š HistÃ³rico completo**: Todas as interaÃ§Ãµes ficam registradas
      automaticamente


      ### ðŸŽ¯ Placeholders em mensagens:

      Use variÃ¡veis dinÃ¢micas nas mensagens para personalizaÃ§Ã£o automÃ¡tica:


      ```

      OlÃ¡ {{nome}}! Vi que vocÃª trabalha na {{empresa}}.

      Seu email {{email}} estÃ¡ correto?

      ObservaÃ§Ãµes: {{observacoes}}

      ```


      ### Fluxo tÃ­pico:

      1. **Captura**: Leads chegam via WhatsApp ou formulÃ¡rios

      2. **Enriquecimento**: Adicione dados usando `/chat/editLead`

      3. **SegmentaÃ§Ã£o**: Organize com etiquetas

      4. **ComunicaÃ§Ã£o**: Envie mensagens personalizadas com placeholders

      5. **Acompanhamento**: HistÃ³rico fica salvo automaticamente


      **Ideal para**: Vendas, marketing, atendimento, qualificaÃ§Ã£o de leads
  - name: Mensagem em massa
  - name: Chatbot ConfiguraÃ§Ãµes
  - name: Chatbot Trigger
  - name: ConfiguraÃ§Ã£o do Agente de IA
  - name: Conhecimento dos Agentes
  - name: FunÃ§Ãµes API dos Agentes
  - name: IntegraÃ§Ã£o Chatwoot
    description: >-
      **ðŸš§ INTEGRAÃ‡ÃƒO BETA - Sistema de integraÃ§Ã£o com Chatwoot para atendimento
      unificado**


      **âš ï¸ AVISO**: Esta integraÃ§Ã£o estÃ¡ em fase BETA. Use por sua conta e
      risco. Recomendamos testes em ambiente nÃ£o-produtivo antes do uso em
      produÃ§Ã£o.


      Esta categoria contÃ©m recursos para configurar e gerenciar a integraÃ§Ã£o
      com o Chatwoot, uma plataforma de atendimento ao cliente open-source. A
      integraÃ§Ã£o permite centralizar conversas do WhatsApp no Chatwoot.


      ### Recursos disponÃ­veis:

      - ðŸ”§ **ConfiguraÃ§Ã£o Completa**: Configure URL, tokens e credenciais do
      Chatwoot

      - ðŸ“¬ **SincronizaÃ§Ã£o Bidirecional**: Mensagens novas entre WhatsApp e
      Chatwoot sÃ£o sincronizadas automaticamente

      - ðŸ“± **Gerenciamento de Contatos**: SincronizaÃ§Ã£o automÃ¡tica de nomes e
      telefones

      - ðŸ”„ **AtualizaÃ§Ã£o LIDâ†’PN**: MigraÃ§Ã£o automÃ¡tica de Local ID para Phone
      Number

      - ðŸ·ï¸ **Nomes Inteligentes**: Sistema de nomes com til (~) para
      atualizaÃ§Ã£o automÃ¡tica

      - ðŸš« **SeparaÃ§Ã£o de Grupos**: OpÃ§Ã£o para ignorar grupos na sincronizaÃ§Ã£o

      - ðŸ‘¤ **Assinatura de Mensagens**: IdentificaÃ§Ã£o do agente nas mensagens
      enviadas

      - ðŸ”— **Webhook AutomÃ¡tico**: URL gerada automaticamente para configurar no
      Chatwoot


      ### ðŸ·ï¸ Sistema de Nomes Inteligentes:

      - **Nomes com til (~)**: Atualizados automaticamente quando contato
      modifica nome no WhatsApp

      - **Nomes especÃ­ficos**: Para nome fixo, remover til (~) do nome no
      Chatwoot

      - **Exemplo**: "~JoÃ£o Silva" = automÃ¡tico, "JoÃ£o Silva" = fixo

      - **MigraÃ§Ã£o LIDâ†’PN**: Sem duplicaÃ§Ã£o de conversas durante a transiÃ§Ã£o

      - **Respostas nativas**: Aparecem diretamente no Chatwoot sem marcaÃ§Ãµes
      externas


      ### âš ï¸ LimitaÃ§Ãµes conhecidas:

      - **SincronizaÃ§Ã£o de histÃ³rico**: NÃ£o implementada - apenas mensagens
      novas sÃ£o sincronizadas


      ### Casos de uso:

      - Atendimento centralizado no Chatwoot

      - Equipes de suporte com mÃºltiplos agentes

      - IntegraÃ§Ã£o com CRM via Chatwoot

      - CentralizaÃ§Ã£o de canais de comunicaÃ§Ã£o

      - GestÃ£o automÃ¡tica de contatos e nomes


      **Ideal para**: Empresas com equipes de atendimento, call centers, suporte
      tÃ©cnico (em ambiente de testes)


      **Requer**: InstÃ¢ncia do Chatwoot configurada, tokens de API e ambiente de
      testes


      **ðŸš§ Lembre-se**: IntegraÃ§Ã£o em BETA - funcionalidades podem mudar sem
      aviso prÃ©vio
paths:
  /instance/connect:
    post:
      tags:
        - Instancia
      summary: Conectar instÃ¢ncia ao WhatsApp
      description: >-
        Inicia o processo de conexÃ£o de uma instÃ¢ncia ao WhatsApp. Este
        endpoint:

        1. Requer o token de autenticaÃ§Ã£o da instÃ¢ncia

        2. Recebe o nÃºmero de telefone associado Ã  conta WhatsApp

        3. Gera um QR code caso nÃ£o passe o campo `phone`

        4. Ou Gera cÃ³digo de pareamento se passar o o campo `phone`

        5. Atualiza o status da instÃ¢ncia para "connecting"


        O processo de conexÃ£o permanece pendente atÃ© que:

        - O QR code seja escaneado no WhatsApp do celular, ou

        - O cÃ³digo de pareamento seja usado no WhatsApp

        - Timeout de 2 minutos para QRCode seja atingido ou 5 minutos para o
        cÃ³digo de pareamento


        Use o endpoint /instance/status para monitorar o progresso da conexÃ£o.


        Estados possÃ­veis da instÃ¢ncia:

        - `disconnected`: Desconectado do WhatsApp

        - `connecting`: Em processo de conexÃ£o

        - `connected`: Conectado e autenticado


        Exemplo de requisiÃ§Ã£o:

        ```json

        {
          "phone": "5511999999999"
        }

        ```
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                phone:
                  type: string
                  description: "NÃºmero de telefone no formato internacional (ex: 5511999999999)"
                  example: "5511999999999"
                  pattern: ^\d{10,15}$
              required:
                - phone
      responses:
        "200":
          description: Sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  connected:
                    type: boolean
                    description: Estado atual da conexÃ£o
                    example: false
                  loggedIn:
                    type: boolean
                    description: Estado do login
                    example: false
                  jid:
                    type: object
                    description: ID do WhatsApp (quando logado)
                    nullable: true
                    example: null
                  instance:
                    $ref: ../schemas/instance.yaml#/Instance
                    description: Detalhes completos da instÃ¢ncia
        "401":
          description: Token invÃ¡lido/expirado
        "404":
          description: InstÃ¢ncia nÃ£o encontrada
        "429":
          description: Limite de conexÃµes simultÃ¢neas atingido
        "500":
          description: Erro interno
  /instance/disconnect:
    post:
      tags:
        - Instancia
      summary: Desconectar instÃ¢ncia
      description: |-
        Desconecta a instÃ¢ncia do WhatsApp, encerrando a sessÃ£o atual.
        Esta operaÃ§Ã£o:

        - Encerra a conexÃ£o ativa

        - Requer novo QR code para reconectar


        DiferenÃ§as entre desconectar e hibernar:

        - Desconectar: Encerra completamente a sessÃ£o, exigindo novo login

        - Hibernar: MantÃ©m a sessÃ£o ativa, apenas pausa a conexÃ£o


        Use este endpoint para:

        1. Encerrar completamente uma sessÃ£o

        2. ForÃ§ar uma nova autenticaÃ§Ã£o

        3. Limpar credenciais de uma instÃ¢ncia

        4. Reiniciar o processo de conexÃ£o


        Estados possÃ­veis apÃ³s desconectar:

        - `disconnected`: Desconectado do WhatsApp

        - `connecting`: Em processo de reconexÃ£o (apÃ³s usar /instance/connect)
    responses:
      "200":
        description: Sucesso
        content:
          application/json:
            schema:
              type: object
              properties:
                instance:
                  $ref: ../schemas/instance.yaml#/Instance
                response:
                  type: string
                  example: Disconnected
                info:
                  type: string
                  example: The device has been successfully disconnected from WhatsApp. A new QR
                    code will be required for the next connection.
      "401":
        description: Token invÃ¡lido/expirado
      "404":
        description: InstÃ¢ncia nÃ£o encontrada
      "500":
        description: Erro interno
  /instance/status:
    get:
      tags:
        - Instancia
      summary: Verificar status da instÃ¢ncia
      description: >-
        Retorna o status atual de uma instÃ¢ncia, incluindo:

        - Estado da conexÃ£o (disconnected, connecting, connected)

        - QR code atualizado (se em processo de conexÃ£o)

        - CÃ³digo de pareamento (se disponÃ­vel)

        - InformaÃ§Ãµes da Ãºltima desconexÃ£o

        - Detalhes completos da instÃ¢ncia


        Este endpoint Ã© particularmente Ãºtil para:

        1. Monitorar o progresso da conexÃ£o

        2. Obter QR codes atualizados durante o processo de conexÃ£o

        3. Verificar o estado atual da instÃ¢ncia

        4. Identificar problemas de conexÃ£o


        Estados possÃ­veis:

        - `disconnected`: Desconectado do WhatsApp

        - `connecting`: Em processo de conexÃ£o (aguardando QR code ou cÃ³digo de
        pareamento)

        - `connected`: Conectado e autenticado com sucesso
      responses:
        "200":
          description: Sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  instance:
                    $ref: ../schemas/instance.yaml#/Instance
                  status:
                    type: object
                    properties:
                      connected:
                        type: boolean
                        description: Indica se estÃ¡ conectado ao WhatsApp
                      loggedIn:
                        type: boolean
                        description: Indica se estÃ¡ autenticado no WhatsApp
                      jid:
                        type: object
                        description: ID do WhatsApp quando conectado
                        nullable: true
              example:
                instance:
                  id: r183e2ef9597845
                  name: minha-instancia
                  status: connected
                  profileName: Meu WhatsApp
                  currentTime: 2024-01-25T12:00:00.000Z
                status:
                  connected: true
                  loggedIn: true
                  jid:
                    user: "5511999999999"
                    agent: 0
                    device: 0
                    server: s.whatsapp.net
        "401":
          description: Token invÃ¡lido/expirado
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: instance info not found
        "404":
          description: InstÃ¢ncia nÃ£o encontrada
        "500":
          description: Erro interno
  /instance/updatechatbotsettings:
    post:
      tags:
        - Chatbot ConfiguraÃ§Ãµes
      summary: Chatbot ConfiguraÃ§Ãµes
      description: >-
        ExplicaÃ§Ã£o dos campos:



        - `openai_apikey`: Chave da API OpenAI (comeÃ§a com "sk-")  


        - `chatbot_enabled`: Habilita/desabilita o chatbot  


        - `chatbot_ignoreGroups`: Define se o chatbot deve ignorar mensagens de
        grupos  


        - `chatbot_stopConversation`: Palavra-chave que os usuÃ¡rios podem usar
        para parar o chatbot  


        - `chatbot_stopMinutes`: Por quantos minutos o chatbot deve ficar
        desativado apÃ³s receber o comando de parada  


        - `chatbot_stopWhenYouSendMsg`: Por quantos minutos o chatbot deve ficar
        desativado apÃ³s vocÃª enviar uma mensagem fora da API, 0 desliga.
      requestBody:
        content:
          application/json:
            schema:
              type: object
              example:
                openai_apikey: sk-1234567890abcdefghijklmnopqrstuvwxyz
                chatbot_enabled: true
                chatbot_ignoreGroups: true
                chatbot_stopConversation: stop
                chatbot_stopMinutes: 30
                chatbot_stopWhenYouSendMsg: 5
      responses:
        "200":
          description: Sucesso
          content:
            application/json:
              schema:
                $ref: ../schemas/instance.yaml#/Instance
        "401":
          description: Token invÃ¡lido/expirado
        "404":
          description: InstÃ¢ncia nÃ£o encontrada
        "500":
          description: Erro interno
  /instance/updateFieldsMap:
    post:
      tags:
        - CRM
      summary: Atualizar campos personalizados de leads
      description: >-
        Atualiza os campos personalizados (custom fields) de uma instÃ¢ncia. 

        Permite configurar atÃ© 20 campos personalizados para armazenamento de 

        informaÃ§Ãµes adicionais sobre leads.


        Cada campo pode armazenar atÃ© 255 caracteres e aceita qualquer tipo de
        dado.


        Campos disponÃ­veis:

        - lead_field01 a lead_field20


        Exemplo de uso:

        1. Armazenar informaÃ§Ãµes adicionais sobre leads

        2. Criar campos personalizados para integraÃ§Ã£o com outros sistemas

        3. Armazenar tags ou categorias personalizadas

        4. Manter histÃ³rico de interaÃ§Ãµes com o lead


        Exemplo de requisiÃ§Ã£o:

        ```json

        {
          "lead_field01": "nome",
          "lead_field02": "email",
          "lead_field03": "telefone",
          "lead_field04": "cidade",
          "lead_field05": "estado",
          "lead_field06": "idade",
          "lead_field07": "interesses",
          "lead_field08": "origem",
          "lead_field09": "status",
          "lead_field10": "valor",
          "lead_field11": "observacoes",
          "lead_field12": "ultima_interacao",
          "lead_field13": "proximo_contato",
          "lead_field14": "vendedor",
          "lead_field15": "produto_interesse",
          "lead_field16": "fonte_captacao",
          "lead_field17": "score",
          "lead_field18": "tags",
          "lead_field19": "historico",
          "lead_field20": "custom"
        }

        ```


        Exemplo de resposta:

        ```json

        {
          "success": true,
          "message": "Custom fields updated successfully",
          "instance": {
            "id": "r183e2ef9597845",
            "name": "minha-instancia",
            "fieldsMap": {
              "lead_field01": "nome",
              "lead_field02": "email",
              "lead_field03": "telefone",
              "lead_field04": "cidade",
              "lead_field05": "estado",
              "lead_field06": "idade",
              "lead_field07": "interesses",
              "lead_field08": "origem",
              "lead_field09": "status",
              "lead_field10": "valor",
              "lead_field11": "observacoes",
              "lead_field12": "ultima_interacao",
              "lead_field13": "proximo_contato",
              "lead_field14": "vendedor",
              "lead_field15": "produto_interesse",
              "lead_field16": "fonte_captacao",
              "lead_field17": "score",
              "lead_field18": "tags",
              "lead_field19": "historico",
              "lead_field20": "custom"
            }
          }
        }

        ```


        Erros comuns:

        - 400: Campos invÃ¡lidos ou payload mal formatado

        - 401: Token invÃ¡lido ou expirado

        - 404: InstÃ¢ncia nÃ£o encontrada

        - 500: Erro ao atualizar campos no banco de dados


        RestriÃ§Ãµes:

        - Cada campo pode ter no mÃ¡ximo 255 caracteres

        - Campos vazios serÃ£o mantidos com seus valores atuais

        - Apenas os campos enviados serÃ£o atualizados
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                lead_field01:
                  type: string
                  description: Campo personalizado 01
                  maxLength: 255
                lead_field02:
                  type: string
                  description: Campo personalizado 02
                  maxLength: 255
                lead_field03:
                  type: string
                  description: Campo personalizado 03
                  maxLength: 255
                lead_field04:
                  type: string
                  description: Campo personalizado 04
                  maxLength: 255
                lead_field05:
                  type: string
                  description: Campo personalizado 05
                  maxLength: 255
                lead_field06:
                  type: string
                  description: Campo personalizado 06
                  maxLength: 255
                lead_field07:
                  type: string
                  description: Campo personalizado 07
                  maxLength: 255
                lead_field08:
                  type: string
                  description: Campo personalizado 08
                  maxLength: 255
                lead_field09:
                  type: string
                  description: Campo personalizado 09
                  maxLength: 255
                lead_field10:
                  type: string
                  description: Campo personalizado 10
                  maxLength: 255
                lead_field11:
                  type: string
                  description: Campo personalizado 11
                  maxLength: 255
                lead_field12:
                  type: string
                  description: Campo personalizado 12
                  maxLength: 255
                lead_field13:
                  type: string
                  description: Campo personalizado 13
                  maxLength: 255
                lead_field14:
                  type: string
                  description: Campo personalizado 14
                  maxLength: 255
                lead_field15:
                  type: string
                  description: Campo personalizado 15
                  maxLength: 255
                lead_field16:
                  type: string
                  description: Campo personalizado 16
                  maxLength: 255
                lead_field17:
                  type: string
                  description: Campo personalizado 17
                  maxLength: 255
                lead_field18:
                  type: string
                  description: Campo personalizado 18
                  maxLength: 255
                lead_field19:
                  type: string
                  description: Campo personalizado 19
                  maxLength: 255
                lead_field20:
                  type: string
                  description: Campo personalizado 20
                  maxLength: 255
      responses:
        "200":
          description: Sucesso
          content:
            application/json:
              schema:
                $ref: ../schemas/instance.yaml#/Instance
        "401":
          description: Token invÃ¡lido/expirado
        "404":
          description: InstÃ¢ncia nÃ£o encontrada
        "500":
          description: Erro interno
  /profile/name:
    post:
      tags:
        - Perfil
      summary: Altera o nome do perfil do WhatsApp
      description: |-
        Altera o nome de exibiÃ§Ã£o do perfil da instÃ¢ncia do WhatsApp.

        O endpoint realiza:
        - Atualiza o nome do perfil usando o WhatsApp AppState
        - Sincroniza a mudanÃ§a com o servidor do WhatsApp
        - Retorna confirmaÃ§Ã£o da alteraÃ§Ã£o

        **Importante**: 
        - A instÃ¢ncia deve estar conectada ao WhatsApp
        - O nome serÃ¡ visÃ­vel para todos os contatos
        - Pode haver um limite de alteraÃ§Ãµes por perÃ­odo (conforme WhatsApp)
      security:
        - token: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - name
              properties:
                name:
                  type: string
                  description: Novo nome do perfil do WhatsApp
                  example: Minha Empresa - Atendimento
                  maxLength: 25
      responses:
        "200":
          description: Nome do perfil alterado com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Nome do perfil alterado com sucesso
                  profile:
                    type: object
                    properties:
                      name:
                        type: string
                        description: Novo nome do perfil
                        example: Minha Empresa - Atendimento
                      updated_at:
                        type: integer
                        description: Timestamp da alteraÃ§Ã£o (Unix timestamp)
                        example: 1704067200
        "400":
          description: Dados invÃ¡lidos na requisiÃ§Ã£o
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Nome muito longo ou invÃ¡lido
        "401":
          description: Sem sessÃ£o ativa
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: No session
        "403":
          description: AÃ§Ã£o nÃ£o permitida
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Limite de alteraÃ§Ãµes excedido ou conta com restriÃ§Ãµes
        "500":
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Erro ao alterar nome do perfil
  /profile/image:
    post:
      tags:
        - Perfil
      summary: Altera a imagem do perfil do WhatsApp
      description: |-
        Altera a imagem de perfil da instÃ¢ncia do WhatsApp.

        O endpoint realiza:
        - Atualiza a imagem do perfil usando 
        - Processa a imagem (URL, base64 ou comando de remoÃ§Ã£o)
        - Sincroniza a mudanÃ§a com o servidor do WhatsApp
        - Retorna confirmaÃ§Ã£o da alteraÃ§Ã£o

        **Importante**: 
        - A instÃ¢ncia deve estar conectada ao WhatsApp
        - A imagem serÃ¡ visÃ­vel para todos os contatos
        - A imagem deve estar em formato JPEG e tamanho 640x640 pixels
      security:
        - token: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - image
              properties:
                image:
                  type: string
                  description: |-
                    Imagem do perfil. Pode ser:
                    - URL da imagem (http/https)
                    - String base64 da imagem
                    - "remove" ou "delete" para remover a imagem atual
                  example: https://picsum.photos/640/640.jpg
                  oneOf:
                    - description: URL da imagem
                      example: https://picsum.photos/640/640.jpg
                    - description: Imagem em base64
                      example: data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAYEBQYFBAYGBQYHBwYIChAKCgkJChQODwwQFxQYGBcUFhYaHSUfGhsjHBYWICwgIyYnKSopGR8tMC0oMCUoKSj/2wBDAQcHBwoIChMKChMoGhYaKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCj/wAARCAABAAEDASIAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAAAAv/xAAUEAEAAAAAAAAAAAAAAAAAAAAA/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAX/xAAUEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwCdABmX/9k=
                    - description: Comando para remover imagem
                      example: remove
      responses:
        "200":
          description: Imagem do perfil alterada com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Imagem do perfil alterada com sucesso
                  profile:
                    type: object
                    properties:
                      image_updated:
                        type: boolean
                        description: Indica se a imagem foi atualizada
                        example: true
                      image_removed:
                        type: boolean
                        description: Indica se a imagem foi removida
                        example: false
                      updated_at:
                        type: integer
                        description: Timestamp da alteraÃ§Ã£o (Unix timestamp)
                        example: 1704067200
        "400":
          description: Dados invÃ¡lidos na requisiÃ§Ã£o
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Formato de imagem invÃ¡lido ou URL inacessÃ­vel
        "401":
          description: Sem sessÃ£o ativa
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: No session
        "403":
          description: AÃ§Ã£o nÃ£o permitida
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Limite de alteraÃ§Ãµes excedido ou conta com restriÃ§Ãµes
        "413":
          description: Imagem muito grande
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Imagem muito grande, tamanho mÃ¡ximo permitido excedido
        "500":
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Erro ao alterar imagem do perfil
  /instance/privacy:
    get:
      tags:
        - Instancia
      summary: Buscar configuraÃ§Ãµes de privacidade
      description: >-
        Busca as configuraÃ§Ãµes de privacidade atuais da instÃ¢ncia do WhatsApp.


        **Importante - DiferenÃ§a entre Status e Broadcast:**


        - **Status**: Refere-se ao recado personalizado que aparece embaixo do
        nome do usuÃ¡rio (ex: "DisponÃ­vel", "Ocupado", texto personalizado)

        - **Broadcast**: Refere-se ao envio de "stories/reels" (fotos/vÃ­deos
        temporÃ¡rios)


        **LimitaÃ§Ã£o**: As configuraÃ§Ãµes de privacidade do broadcast
        (stories/reels) nÃ£o estÃ£o disponÃ­veis para alteraÃ§Ã£o via API.


        Retorna todas as configuraÃ§Ãµes de privacidade como quem pode:

        - Adicionar aos grupos

        - Ver visto por Ãºltimo

        - Ver status (recado embaixo do nome)

        - Ver foto de perfil

        - Receber confirmaÃ§Ã£o de leitura

        - Ver status online

        - Fazer chamadas
      operationId: getPrivacySettings
      responses:
        "200":
          description: ConfiguraÃ§Ãµes de privacidade obtidas com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  groupadd:
                    type: string
                    enum:
                      - all
                      - contacts
                      - contact_blacklist
                      - none
                    description: Quem pode adicionar aos grupos. Valores - all, contacts,
                      contact_blacklist, none
                    example: contacts
                  last:
                    type: string
                    enum:
                      - all
                      - contacts
                      - contact_blacklist
                      - none
                    description: Quem pode ver visto por Ãºltimo. Valores - all, contacts,
                      contact_blacklist, none
                    example: contacts
                  status:
                    type: string
                    enum:
                      - all
                      - contacts
                      - contact_blacklist
                      - none
                    description: Quem pode ver status (recado embaixo do nome). Valores - all,
                      contacts, contact_blacklist, none
                    example: contacts
                  profile:
                    type: string
                    enum:
                      - all
                      - contacts
                      - contact_blacklist
                      - none
                    description: Quem pode ver foto de perfil. Valores - all, contacts,
                      contact_blacklist, none
                    example: contacts
                  readreceipts:
                    type: string
                    enum:
                      - all
                      - none
                    description: ConfirmaÃ§Ã£o de leitura. Valores - all, none
                    example: all
                  online:
                    type: string
                    enum:
                      - all
                      - match_last_seen
                    description: Quem pode ver status online. Valores - all, match_last_seen
                    example: all
                  calladd:
                    type: string
                    enum:
                      - all
                      - known
                    description: Quem pode fazer chamadas. Valores - all, known
                    example: all
              examples:
                success:
                  summary: ConfiguraÃ§Ãµes de privacidade obtidas
                  value:
                    groupadd: contacts
                    last: contacts
                    status: contacts
                    profile: contacts
                    readreceipts: all
                    online: all
                    calladd: all
        "401":
          description: Token de autenticaÃ§Ã£o invÃ¡lido
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: client not found
        "500":
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: No session
    post:
      tags:
        - Instancia
      summary: Alterar configuraÃ§Ãµes de privacidade
      description: >-
        Altera uma ou mÃºltiplas configuraÃ§Ãµes de privacidade da instÃ¢ncia do
        WhatsApp de forma otimizada.


        **Importante - DiferenÃ§a entre Status e Broadcast:**


        - **Status**: Refere-se ao recado personalizado que aparece embaixo do
        nome do usuÃ¡rio (ex: "DisponÃ­vel", "Ocupado", texto personalizado)

        - **Broadcast**: Refere-se ao envio de "stories/reels" (fotos/vÃ­deos
        temporÃ¡rios)


        **LimitaÃ§Ã£o**: As configuraÃ§Ãµes de privacidade do broadcast
        (stories/reels) nÃ£o estÃ£o disponÃ­veis para alteraÃ§Ã£o via API.


        **CaracterÃ­sticas:**

        - âœ… **EficiÃªncia**: Altera apenas configuraÃ§Ãµes que realmente mudaram

        - âœ… **Flexibilidade**: Pode alterar uma ou mÃºltiplas configuraÃ§Ãµes na
        mesma requisiÃ§Ã£o

        - âœ… **Feedback completo**: Retorna todas as configuraÃ§Ãµes atualizadas


        **Formato de entrada:**

        ```json

        {
          "groupadd": "contacts",
          "last": "none",
          "status": "contacts"
        }

        ```


        **Tipos de privacidade disponÃ­veis:**

        - `groupadd`: Quem pode adicionar aos grupos

        - `last`: Quem pode ver visto por Ãºltimo

        - `status`: Quem pode ver status (recado embaixo do nome)

        - `profile`: Quem pode ver foto de perfil

        - `readreceipts`: ConfirmaÃ§Ã£o de leitura

        - `online`: Quem pode ver status online

        - `calladd`: Quem pode fazer chamadas


        **Valores possÃ­veis:**

        - `all`: Todos

        - `contacts`: Apenas contatos

        - `contact_blacklist`: Contatos exceto bloqueados

        - `none`: NinguÃ©m

        - `match_last_seen`: Corresponder ao visto por Ãºltimo (apenas para
        online)

        - `known`: NÃºmeros conhecidos (apenas para calladd)
      operationId: setPrivacySetting
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                groupadd:
                  type: string
                  enum:
                    - all
                    - contacts
                    - contact_blacklist
                    - none
                  description: Quem pode adicionar aos grupos. Valores - all, contacts,
                    contact_blacklist, none
                last:
                  type: string
                  enum:
                    - all
                    - contacts
                    - contact_blacklist
                    - none
                  description: Quem pode ver visto por Ãºltimo. Valores - all, contacts,
                    contact_blacklist, none
                status:
                  type: string
                  enum:
                    - all
                    - contacts
                    - contact_blacklist
                    - none
                  description: Quem pode ver status (recado embaixo do nome). Valores - all,
                    contacts, contact_blacklist, none
                profile:
                  type: string
                  enum:
                    - all
                    - contacts
                    - contact_blacklist
                    - none
                  description: Quem pode ver foto de perfil. Valores - all, contacts,
                    contact_blacklist, none
                readreceipts:
                  type: string
                  enum:
                    - all
                    - none
                  description: ConfirmaÃ§Ã£o de leitura. Valores - all, none
                online:
                  type: string
                  enum:
                    - all
                    - match_last_seen
                  description: Quem pode ver status online. Valores - all, match_last_seen
                calladd:
                  type: string
                  enum:
                    - all
                    - known
                  description: Quem pode fazer chamadas. Valores - all, known
              minProperties: 1
              additionalProperties: false
            examples:
              single_setting:
                summary: Alterar uma configuraÃ§Ã£o
                value:
                  groupadd: contacts
              multiple_settings:
                summary: Alterar mÃºltiplas configuraÃ§Ãµes
                value:
                  groupadd: contacts
                  last: none
                  status: contacts
                  profile: contacts
              privacy_strict:
                summary: ConfiguraÃ§Ã£o mais restritiva
                value:
                  groupadd: none
                  last: none
                  status: contacts
                  profile: contacts
                  readreceipts: none
      responses:
        "200":
          description: ConfiguraÃ§Ã£o de privacidade alterada com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  groupadd:
                    type: string
                    enum:
                      - all
                      - contacts
                      - contact_blacklist
                      - none
                    description: Quem pode adicionar aos grupos. Valores - all, contacts,
                      contact_blacklist, none
                  last:
                    type: string
                    enum:
                      - all
                      - contacts
                      - contact_blacklist
                      - none
                    description: Quem pode ver visto por Ãºltimo. Valores - all, contacts,
                      contact_blacklist, none
                  status:
                    type: string
                    enum:
                      - all
                      - contacts
                      - contact_blacklist
                      - none
                    description: Quem pode ver status (recado embaixo do nome). Valores - all,
                      contacts, contact_blacklist, none
                  profile:
                    type: string
                    enum:
                      - all
                      - contacts
                      - contact_blacklist
                      - none
                    description: Quem pode ver foto de perfil. Valores - all, contacts,
                      contact_blacklist, none
                  readreceipts:
                    type: string
                    enum:
                      - all
                      - none
                    description: ConfirmaÃ§Ã£o de leitura. Valores - all, none
                  online:
                    type: string
                    enum:
                      - all
                      - match_last_seen
                    description: Quem pode ver status online. Valores - all, match_last_seen
                  calladd:
                    type: string
                    enum:
                      - all
                      - known
                    description: Quem pode fazer chamadas. Valores - all, known
              examples:
                success:
                  summary: ConfiguraÃ§Ãµes atualizadas apÃ³s alteraÃ§Ã£o
                  value:
                    groupadd: contacts
                    last: contacts
                    status: contacts
                    profile: contacts
                    readreceipts: all
                    online: all
                    calladd: all
        "400":
          description: Dados de entrada invÃ¡lidos
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
              examples:
                no_valid_settings:
                  summary: Nenhuma configuraÃ§Ã£o vÃ¡lida encontrada
                  value:
                    error: 'No valid privacy settings found. Use format: {"groupadd": "contacts",
                      "last": "none"}'
                invalid_value_type:
                  summary: Valor deve ser string
                  value:
                    error: Value for groupadd must be a non-empty string
                invalid_privacy_type:
                  summary: Tipo de privacidade invÃ¡lido
                  value:
                    error: "invalid privacy type: invalidtype. Valid types: groupadd, last, status,
                      profile, readreceipts, online, calladd"
                invalid_privacy_value:
                  summary: Valor de privacidade invÃ¡lido
                  value:
                    error: "invalid privacy value: invalidvalue. Valid values: all, contacts,
                      contact_blacklist, none, match_last_seen, known"
        "401":
          description: Token de autenticaÃ§Ã£o invÃ¡lido
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: client not found
        "500":
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
              examples:
                no_session:
                  summary: Sem sessÃ£o ativa
                  value:
                    error: No session
                whatsapp_error:
                  summary: Erro do WhatsApp
                  value:
                    error: "Failed to set privacy setting: context deadline exceeded"
  /instance/presence:
    post:
      tags:
        - Instancia
      summary: Atualizar status de presenÃ§a da instÃ¢ncia
      description: >-
        Atualiza o status de presenÃ§a global da instÃ¢ncia do WhatsApp. Este
        endpoint permite:

        1. Definir se a instÃ¢ncia estÃ¡ disponÃ­vel (Aparece "online") ou
        indisponÃ­vel

        2. Controlar o status de presenÃ§a para todos os contatos

        3. Salvar o estado atual da presenÃ§a na instÃ¢ncia


        Tipos de presenÃ§a suportados:

        - available: Marca a instÃ¢ncia como disponÃ­vel/online

        - unavailable: Marca a instÃ¢ncia como indisponÃ­vel/offline


        **AtenÃ§Ã£o**:

        - O status de presenÃ§a pode ser temporariamente alterado para
        "available" (online) em algumas situaÃ§Ãµes internas da API, e com isso o
        visto por Ãºltimo tambÃ©m pode ser atualizado.

        - Caso isso for um problema, considere alterar suas configuraÃ§Ãµes de
        privacidade no WhatsApp para nÃ£o mostrar o visto por Ãºltimo e/ou quem
        pode ver seu status "online".


        **âš ï¸ Importante - LimitaÃ§Ã£o do Presence "unavailable"**:

        - **Quando a API Ã© o Ãºnico dispositivo ativo**: ConfirmaÃ§Ãµes de
        entrega/leitura (ticks cinzas/azuis) nÃ£o sÃ£o enviadas nem recebidas

        - **Impacto**: Eventos `message_update` com status de entrega podem nÃ£o
        ser recebidos

        - **SoluÃ§Ã£o**: Se precisar das confirmaÃ§Ãµes, mantenha WhatsApp Web ou
        aplicativo mÃ³vel ativo ou use presence "available" 


        Exemplo de requisiÃ§Ã£o:

        ```json

        {
          "presence": "available"
        }

        ```


        Exemplo de resposta:

        ```json

        {
          "response": "Presence updated successfully"
        }

        ```


        Erros comuns:

        - 401: Token invÃ¡lido ou expirado

        - 400: Valor de presenÃ§a invÃ¡lido

        - 500: Erro ao atualizar presenÃ§a
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                presence:
                  type: string
                  description: Status de presenÃ§a da instÃ¢ncia
                  enum:
                    - available
                    - unavailable
                  example: available
              required:
                - presence
      responses:
        "200":
          description: PresenÃ§a atualizada com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  response:
                    type: string
                    description: Mensagem de confirmaÃ§Ã£o
                    example: Presence updated successfully
        "400":
          description: RequisiÃ§Ã£o invÃ¡lida
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: DescriÃ§Ã£o do erro
                    examples:
                      invalid_payload: Invalid payload
                      invalid_presence: Invalid presence value, use available or unavailable
        "401":
          description: Token invÃ¡lido ou expirado
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: DescriÃ§Ã£o do erro de autenticaÃ§Ã£o
                    example: client not found
        "500":
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: DescriÃ§Ã£o do erro interno
                    example: No session
  /send/text:
    post:
      tags:
        - Enviar Mensagem
      summary: Enviar mensagem de texto
      description: >-
        Envia uma mensagem de texto para um contato ou grupo.


        ## Recursos EspecÃ­ficos


        - **Preview de links** com suporte a personalizaÃ§Ã£o automÃ¡tica ou
        customizada

        - **FormataÃ§Ã£o bÃ¡sica** do texto

        - **SubstituiÃ§Ã£o automÃ¡tica de placeholders** dinÃ¢micos


        ## Campos Comuns


        Este endpoint suporta todos os **campos opcionais comuns** documentados
        na tag **"Enviar Mensagem"**, incluindo:

        `delay`, `readchat`, `readmessages`, `replyid`, `mentions`, `forward`,
        `track_source`, `track_id`, placeholders e envio para grupos.


        ## Preview de Links


        ### Preview AutomÃ¡tico

        ```json

        {
          "number": "5511999999999",
          "text": "Confira: https://exemplo.com",
          "linkPreview": true
        }

        ```


        ### Preview Personalizado

        ```json

        {
          "number": "5511999999999",
          "text": "Confira nosso site! https://exemplo.com",
          "linkPreview": true,
          "linkPreviewTitle": "TÃ­tulo Personalizado",
          "linkPreviewDescription": "Uma descriÃ§Ã£o personalizada do link",
          "linkPreviewImage": "https://exemplo.com/imagem.jpg",
          "linkPreviewLarge": true
        }

        ```
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                number:
                  type: string
                  description: NÃºmero do destinatÃ¡rio (formato internacional)
                  example: "5511999999999"
                text:
                  type: string
                  description: Texto da mensagem (aceita placeholders)
                  example: OlÃ¡ {{name}}! Como posso ajudar?
                linkPreview:
                  type: boolean
                  description: >-
                    Ativa/desativa preview de links. Se true, procura
                    automaticamente um link no texto para gerar preview.


                    Comportamento:

                    - Se apenas linkPreview=true: gera preview automÃ¡tico do
                    primeiro link encontrado no texto

                    - Se fornecidos campos personalizados (title, description,
                    image): usa os valores fornecidos

                    - Se campos personalizados parciais: combina com dados
                    automÃ¡ticos do link como fallback
                  example: true
                linkPreviewTitle:
                  type: string
                  description: Define um tÃ­tulo personalizado para o preview do link
                  example: TÃ­tulo Personalizado
                linkPreviewDescription:
                  type: string
                  description: Define uma descriÃ§Ã£o personalizada para o preview do link
                  example: DescriÃ§Ã£o personalizada do link
                linkPreviewImage:
                  type: string
                  description: URL ou Base64 da imagem para usar no preview do link
                  example: https://exemplo.com/imagem.jpg
                linkPreviewLarge:
                  type: boolean
                  description: Se true, gera um preview grande com upload da imagem. Se false,
                    gera um preview pequeno sem upload
                  example: true
                replyid:
                  type: string
                  description: ID da mensagem para responder
                  example: 3EB0538DA65A59F6D8A251
                mentions:
                  type: string
                  description: NÃºmeros para mencionar (separados por vÃ­rgula)
                  example: 5511999999999,5511888888888
                readchat:
                  type: boolean
                  description: Marca conversa como lida apÃ³s envio
                  example: true
                readmessages:
                  type: boolean
                  description: Marca Ãºltimas mensagens recebidas como lidas
                  example: true
                delay:
                  type: integer
                  description: Atraso em milissegundos antes do envio, durante o atraso apacerÃ¡
                    'Digitando...'
                  example: 1000
                forward:
                  type: boolean
                  description: Marca a mensagem como encaminhada no WhatsApp
                  example: true
                track_source:
                  type: string
                  description: Origem do rastreamento da mensagem
                  example: chatwoot
                track_id:
                  type: string
                  description: ID para rastreamento da mensagem (aceita valores duplicados)
                  example: msg_123456789
              required:
                - number
                - text
            examples:
              basic:
                summary: Mensagem bÃ¡sica
                description: Exemplo mais simples possÃ­vel
                value:
                  number: "5511999999999"
                  text: OlÃ¡! Como posso ajudar?
              withLinkPreview:
                summary: Com preview automÃ¡tico
                description: Preview automÃ¡tico de link no texto
                value:
                  number: "5511999999999"
                  text: "Confira: https://exemplo.com"
                  linkPreview: true
              customLinkPreview:
                summary: Preview personalizado
                description: Preview com tÃ­tulo, descriÃ§Ã£o e imagem customizados
                value:
                  number: "5511999999999"
                  text: Confira nosso site! https://exemplo.com
                  linkPreview: true
                  linkPreviewTitle: TÃ­tulo Personalizado
                  linkPreviewDescription: Uma descriÃ§Ã£o personalizada do link
                  linkPreviewImage: https://exemplo.com/imagem.jpg
                  linkPreviewLarge: true
              withPlaceholders:
                summary: Com placeholders
                description: Texto com variÃ¡veis dinÃ¢micas
                value:
                  number: "5511999999999"
                  text: OlÃ¡ {{name}}! Sua empresa {{company}} estÃ¡ cadastrada.
      responses:
        "200":
          description: Mensagem enviada com sucesso
          content:
            application/json:
              schema:
                allOf:
                  - $ref: ../schemas/message.yaml#/Message
                  - type: object
                    properties:
                      response:
                        type: object
                        properties:
                          status:
                            type: string
                            example: success
                          message:
                            type: string
                            example: Message sent successfully
        "400":
          description: RequisiÃ§Ã£o invÃ¡lida
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Missing number or text
        "401":
          description: NÃ£o autorizado
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Invalid token
        "429":
          description: Limite de requisiÃ§Ãµes excedido
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Rate limit exceeded
        "500":
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Failed to send message
  /send/media:
    post:
      tags:
        - Enviar Mensagem
      summary: Enviar mÃ­dia (imagem, vÃ­deo, Ã¡udio ou documento)
      description: >-
        Envia diferentes tipos de mÃ­dia para um contato ou grupo. Suporta URLs
        ou arquivos base64.


        ## Tipos de MÃ­dia Suportados

        - **`image`**: Imagens (JPG preferencialmente)

        - **`video`**: VÃ­deos (apenas MP4)

        - **`document`**: Documentos (PDF, DOCX, XLSX, etc)

        - **`audio`**: Ãudio comum (MP3 ou OGG)

        - **`myaudio`**: Mensagem de voz (alternativa ao PTT)

        - **`ptt`**: Mensagem de voz (Push-to-Talk)

        - **`sticker`**: Figurinha/Sticker


        ## Recursos EspecÃ­ficos

        - **Upload por URL ou base64**

        - **Caption/legenda** opcional com suporte a placeholders

        - **Nome personalizado** para documentos (`docName`)

        - **GeraÃ§Ã£o automÃ¡tica de thumbnails**

        - **CompressÃ£o otimizada** conforme o tipo


        ## Campos Comuns


        Este endpoint suporta todos os **campos opcionais comuns** documentados
        na tag **"Enviar Mensagem"**, incluindo:

        `delay`, `readchat`, `readmessages`, `replyid`, `mentions`, `forward`,
        `track_source`, `track_id`, placeholders e envio para grupos.


        ## Exemplos BÃ¡sicos


        ### Imagem Simples

        ```json

        {
          "number": "5511999999999",
          "type": "image",
          "file": "https://exemplo.com/foto.jpg"
        }

        ```


        ### Documento com Nome

        ```json

        {
          "number": "5511999999999",
          "type": "document",
          "file": "https://exemplo.com/contrato.pdf",
          "docName": "Contrato.pdf",
          "text": "Segue o documento solicitado"
        }

        ```
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                number:
                  type: string
                  description: NÃºmero do destinatÃ¡rio (formato internacional)
                  example: "5511999999999"
                type:
                  type: string
                  description: Tipo de mÃ­dia (image, video, document, audio, myaudio, ptt,
                    sticker)
                  enum:
                    - image
                    - video
                    - document
                    - audio
                    - myaudio
                    - ptt
                    - sticker
                  example: image
                file:
                  type: string
                  description: URL ou base64 do arquivo
                  example: https://exemplo.com/imagem.jpg
                text:
                  type: string
                  description: Texto descritivo (caption) - aceita placeholders
                  example: Veja esta foto!
                docName:
                  type: string
                  description: Nome do arquivo (apenas para documents)
                  example: relatorio.pdf
                replyid:
                  type: string
                  description: ID da mensagem para responder
                  example: 3EB0538DA65A59F6D8A251
                mentions:
                  type: string
                  description: NÃºmeros para mencionar (separados por vÃ­rgula)
                  example: 5511999999999,5511888888888
                readchat:
                  type: boolean
                  description: Marca conversa como lida apÃ³s envio
                  example: true
                readmessages:
                  type: boolean
                  description: Marca Ãºltimas mensagens recebidas como lidas
                  example: true
                delay:
                  type: integer
                  description: Atraso em milissegundos antes do envio, durante o atraso apacerÃ¡
                    'Digitando...' ou 'Gravando Ã¡udio...'
                  example: 1000
                forward:
                  type: boolean
                  description: Marca a mensagem como encaminhada no WhatsApp
                  example: true
                track_source:
                  type: string
                  description: Origem do rastreamento da mensagem
                  example: chatwoot
                track_id:
                  type: string
                  description: ID para rastreamento da mensagem (aceita valores duplicados)
                  example: msg_123456789
              required:
                - number
                - type
                - file
            examples:
              image:
                summary: Imagem
                description: Envio de imagem simples
                value:
                  number: "5511999999999"
                  type: image
                  file: https://exemplo.com/foto.jpg
              imageWithCaption:
                summary: Imagem com legenda
                description: Imagem com texto descritivo
                value:
                  number: "5511999999999"
                  type: image
                  file: https://exemplo.com/foto.jpg
                  text: Veja esta foto!
              document:
                summary: Documento
                description: Documento PDF com nome personalizado
                value:
                  number: "5511999999999"
                  type: document
                  file: https://exemplo.com/contrato.pdf
                  docName: Contrato.pdf
                  text: Segue o documento solicitado
              audio:
                summary: Mensagem de voz
                description: Arquivo de Ã¡udio como mensagem de voz
                value:
                  number: "5511999999999"
                  type: ptt
                  file: https://exemplo.com/audio.ogg
              video:
                summary: VÃ­deo
                description: Arquivo de vÃ­deo com legenda
                value:
                  number: "5511999999999"
                  type: video
                  file: https://exemplo.com/video.mp4
                  text: Confira este vÃ­deo!
              sticker:
                summary: Figurinha
                description: Envio de figurinha/sticker
                value:
                  number: "5511999999999"
                  type: sticker
                  file: https://exemplo.com/sticker.webp
      responses:
        "200":
          description: MÃ­dia enviada com sucesso
          content:
            application/json:
              schema:
                allOf:
                  - $ref: ../schemas/message.yaml#/Message
                  - type: object
                    properties:
                      response:
                        type: object
                        properties:
                          status:
                            type: string
                            example: success
                          message:
                            type: string
                            example: Media sent successfully
                          fileUrl:
                            type: string
                            example: https://mmg.whatsapp.net/...
        "400":
          description: RequisiÃ§Ã£o invÃ¡lida
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Invalid media type or file format
        "401":
          description: NÃ£o autorizado
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Invalid token
        "413":
          description: Arquivo muito grande
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: File size exceeds limit
        "415":
          description: Formato de mÃ­dia nÃ£o suportado
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Unsupported media format
        "500":
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Failed to upload media
  /send/contact:
    post:
      tags:
        - Enviar Mensagem
      summary: Enviar cartÃ£o de contato (vCard)
      description: >-
        Envia um cartÃ£o de contato (vCard) para um contato ou grupo.


        ## Recursos EspecÃ­ficos


        - **vCard completo** com nome, telefones, organizaÃ§Ã£o, email e URL

        - **MÃºltiplos nÃºmeros de telefone** (separados por vÃ­rgula)

        - **CartÃ£o clicÃ¡vel** no WhatsApp para salvar na agenda

        - **InformaÃ§Ãµes profissionais** (organizaÃ§Ã£o/empresa)


        ## Campos Comuns


        Este endpoint suporta todos os **campos opcionais comuns** documentados
        na tag **"Enviar Mensagem"**, incluindo:

        `delay`, `readchat`, `readmessages`, `replyid`, `mentions`, `forward`,
        `track_source`, `track_id`, placeholders e envio para grupos.


        ## Exemplo BÃ¡sico

        ```json

        {
          "number": "5511999999999",
          "fullName": "JoÃ£o Silva",
          "phoneNumber": "5511999999999,5511888888888",
          "organization": "Empresa XYZ",
          "email": "joao.silva@empresa.com",
          "url": "https://empresa.com/joao"
        }

        ```
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                number:
                  type: string
                  description: NÃºmero do destinatÃ¡rio (formato internacional)
                  example: "5511999999999"
                fullName:
                  type: string
                  description: Nome completo do contato
                  example: JoÃ£o Silva
                phoneNumber:
                  type: string
                  description: NÃºmeros de telefone (separados por vÃ­rgula)
                  example: 5511999999999,5511888888888
                organization:
                  type: string
                  description: Nome da organizaÃ§Ã£o/empresa
                  example: Empresa XYZ
                email:
                  type: string
                  description: EndereÃ§o de email
                  example: joao@empresa.com
                url:
                  type: string
                  description: URL pessoal ou da empresa
                  example: https://empresa.com/joao
                replyid:
                  type: string
                  description: ID da mensagem para responder
                  example: 3EB0538DA65A59F6D8A251
                mentions:
                  type: string
                  description: NÃºmeros para mencionar (separados por vÃ­rgula)
                  example: 5511999999999,5511888888888
                readchat:
                  type: boolean
                  description: Marca conversa como lida apÃ³s envio
                  example: true
                readmessages:
                  type: boolean
                  description: Marca Ãºltimas mensagens recebidas como lidas
                  example: true
                delay:
                  type: integer
                  description: Atraso em milissegundos antes do envio, durante o atraso apacerÃ¡
                    'Digitando...'
                  example: 1000
                forward:
                  type: boolean
                  description: Marca a mensagem como encaminhada no WhatsApp
                  example: true
                track_source:
                  type: string
                  description: Origem do rastreamento da mensagem
                  example: chatwoot
                track_id:
                  type: string
                  description: ID para rastreamento da mensagem (aceita valores duplicados)
                  example: msg_123456789
              required:
                - number
                - fullName
                - phoneNumber
      responses:
        "200":
          description: CartÃ£o de contato enviado com sucesso
          content:
            application/json:
              schema:
                allOf:
                  - $ref: ../schemas/message.yaml#/Message
                  - type: object
                    properties:
                      response:
                        type: object
                        properties:
                          status:
                            type: string
                            example: success
                          message:
                            type: string
                            example: Contact card sent successfully
        "400":
          description: RequisiÃ§Ã£o invÃ¡lida
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Missing required fields
        "401":
          description: NÃ£o autorizado
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Invalid token
        "429":
          description: Limite de requisiÃ§Ãµes excedido
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Rate limit exceeded
        "500":
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Failed to send contact card
  /send/location:
    post:
      tags:
        - Enviar Mensagem
      summary: Enviar localizaÃ§Ã£o geogrÃ¡fica
      description: >-
        Envia uma localizaÃ§Ã£o geogrÃ¡fica para um contato ou grupo.


        ## Recursos EspecÃ­ficos


        - **Coordenadas precisas** (latitude e longitude obrigatÃ³rias)

        - **Nome do local** para identificaÃ§Ã£o

        - **Mapa interativo** no WhatsApp para navegaÃ§Ã£o

        - **Pin personalizado** com nome do local


        ## Campos Comuns


        Este endpoint suporta todos os **campos opcionais comuns** documentados
        na tag **"Enviar Mensagem"**, incluindo:

        `delay`, `readchat`, `readmessages`, `replyid`, `mentions`, `forward`,
        `track_source`, `track_id`, placeholders e envio para grupos.


        ## Exemplo BÃ¡sico

        ```json

        {
          "number": "5511999999999",
          "name": "MaracanÃ£",
          "address": "Av. Pres. Castelo Branco, PortÃ£o 3 - MaracanÃ£, Rio de Janeiro - RJ, 20271-130",
          "latitude": -22.912982815767986,
          "longitude": -43.23028153499254
        }

        ```
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                number:
                  type: string
                  description: NÃºmero do destinatÃ¡rio (formato internacional)
                  example: "5511999999999"
                name:
                  type: string
                  description: Nome do local
                  example: MASP
                address:
                  type: string
                  description: EndereÃ§o completo do local
                  example: Av. Paulista, 1578 - Bela Vista
                latitude:
                  type: number
                  description: Latitude (-90 a 90)
                  example: -23.5616
                longitude:
                  type: number
                  description: Longitude (-180 a 180)
                  example: -46.6562
                replyid:
                  type: string
                  description: ID da mensagem para responder
                  example: 3EB0538DA65A59F6D8A251
                mentions:
                  type: string
                  description: NÃºmeros para mencionar (separados por vÃ­rgula)
                  example: 5511999999999,5511888888888
                readchat:
                  type: boolean
                  description: Marca conversa como lida apÃ³s envio
                  example: true
                readmessages:
                  type: boolean
                  description: Marca Ãºltimas mensagens recebidas como lidas
                  example: true
                delay:
                  type: integer
                  description: Atraso em milissegundos antes do envio, durante o atraso apacerÃ¡
                    'Digitando...'
                  example: 1000
                forward:
                  type: boolean
                  description: Marca a mensagem como encaminhada no WhatsApp
                  example: true
                track_source:
                  type: string
                  description: Origem do rastreamento da mensagem
                  example: chatwoot
                track_id:
                  type: string
                  description: ID para rastreamento da mensagem (aceita valores duplicados)
                  example: msg_123456789
              required:
                - number
                - latitude
                - longitude
      responses:
        "200":
          description: LocalizaÃ§Ã£o enviada com sucesso
          content:
            application/json:
              schema:
                allOf:
                  - $ref: ../schemas/message.yaml#/Message
                  - type: object
                    properties:
                      response:
                        type: object
                        properties:
                          status:
                            type: string
                            example: success
                          message:
                            type: string
                            example: Location sent successfully
        "400":
          description: RequisiÃ§Ã£o invÃ¡lida
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Invalid coordinates or missing number
        "401":
          description: NÃ£o autorizado
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Invalid token
        "429":
          description: Limite de requisiÃ§Ãµes excedido
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Rate limit exceeded
        "500":
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Failed to send location
  /message/presence:
    post:
      tags:
        - Enviar Mensagem
      summary: Enviar atualizaÃ§Ã£o de presenÃ§a
      description: >-
        Envia uma atualizaÃ§Ã£o de presenÃ§a para um contato ou grupo de forma
        **assÃ­ncrona**.


        ## ðŸ”„ Comportamento AssÃ­ncrono:

        - **ExecuÃ§Ã£o independente**: A presenÃ§a Ã© gerenciada em background, nÃ£o
        bloqueia o retorno da API

        - **Limite mÃ¡ximo**: 5 minutos de duraÃ§Ã£o (300 segundos)

        - **Tick de atualizaÃ§Ã£o**: Reenvia a presenÃ§a a cada 10 segundos

        - **Cancelamento automÃ¡tico**: PresenÃ§a Ã© cancelada automaticamente ao
        enviar uma mensagem para o mesmo chat


        ## ðŸ“± Tipos de presenÃ§a suportados:

        - **composing**: Indica que vocÃª estÃ¡ digitando uma mensagem

        - **recording**: Indica que vocÃª estÃ¡ gravando um Ã¡udio

        - **paused**: Remove/cancela a indicaÃ§Ã£o de presenÃ§a atual


        ## â±ï¸ Controle de duraÃ§Ã£o:

        - **Sem delay**: Usa limite padrÃ£o de 5 minutos

        - **Com delay**: Usa o valor especificado (mÃ¡ximo 5 minutos)

        - **Cancelamento**: Envio de mensagem cancela presenÃ§a automaticamente


        ## ðŸ“‹ Exemplos de uso:


        ### Digitar por 30 segundos:

        ```json

        {
          "number": "5511999999999",
          "presence": "composing",
          "delay": 30000
        }

        ```


        ### Gravar Ã¡udio por 1 minuto:

        ```json

        {
          "number": "5511999999999",
          "presence": "recording",
          "delay": 60000
        }

        ```


        ### Cancelar presenÃ§a atual:

        ```json

        {
          "number": "5511999999999",
          "presence": "paused"
        }

        ```


        ### Usar limite mÃ¡ximo (5 minutos):

        ```json

        {
          "number": "5511999999999",
          "presence": "composing"
        }

        ```
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                number:
                  type: string
                  description: "NÃºmero do destinatÃ¡rio no formato internacional (ex:
                    5511999999999)"
                  example: "5511999999999"
                presence:
                  type: string
                  description: Tipo de presenÃ§a a ser enviada
                  enum:
                    - composing
                    - recording
                    - paused
                  example: composing
                delay:
                  type: integer
                  description: >-
                    DuraÃ§Ã£o em milissegundos que a presenÃ§a ficarÃ¡ ativa (mÃ¡ximo
                    5 minutos = 300000ms).

                    Se nÃ£o informado ou valor maior que 5 minutos, usa o limite
                    padrÃ£o de 5 minutos.

                    A presenÃ§a Ã© reenviada a cada 10 segundos durante este
                    perÃ­odo.
                  maximum: 300000
                  example: 30000
              required:
                - number
                - presence
      responses:
        "200":
          description: PresenÃ§a atualizada com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  response:
                    type: string
                    description: Mensagem de confirmaÃ§Ã£o
                    example: Chat presence sent successfully
        "400":
          description: RequisiÃ§Ã£o invÃ¡lida
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: DescriÃ§Ã£o do erro
                    example: NÃºmero invÃ¡lido ou tipo de presenÃ§a invÃ¡lido
        "401":
          description: Token invÃ¡lido ou expirado
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: DescriÃ§Ã£o do erro de autenticaÃ§Ã£o
                    example: Token invÃ¡lido ou expirado
        "500":
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: DescriÃ§Ã£o do erro interno
                    example: Erro ao enviar presenÃ§a
  /send/status:
    post:
      tags:
        - Enviar Mensagem
      summary: Enviar Stories (Status)
      description: >-
        Envia um story (status) com suporte para texto, imagem, vÃ­deo e Ã¡udio.


        **Suporte a campos de rastreamento**: Este endpoint tambÃ©m suporta
        `track_source` e `track_id` documentados na tag **"Enviar Mensagem"**.


        ## Tipos de Status

        - text: Texto com estilo e cor de fundo

        - image: Imagens com legenda opcional

        - video: VÃ­deos com thumbnail e legenda

        - audio: Ãudio normal ou mensagem de voz (PTT)


        ## Cores de Fundo

        - 1-3: Tons de amarelo

        - 4-6: Tons de verde

        - 7-9: Tons de azul

        - 10-12: Tons de lilÃ¡s

        - 13: Magenta

        - 14-15: Tons de rosa

        - 16: Marrom claro

        - 17-19: Tons de cinza (19 Ã© o padrÃ£o)


        ## Fontes (para texto)

        - 0: PadrÃ£o 

        - 1-8: Estilos alternativos


        ## Limites

        - Texto: MÃ¡ximo 656 caracteres

        - Imagem: JPG, PNG, GIF

        - VÃ­deo: MP4, MOV

        - Ãudio: MP3, OGG, WAV (convertido para OGG/OPUS)


        ## Exemplo

        ```json

        {
          "type": "text",
          "text": "Novidades chegando!",
          "background_color": 7,
          "font": 1
        }

        ```
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                type:
                  type: string
                  enum:
                    - text
                    - image
                    - video
                    - audio
                    - myaudio
                    - ptt
                  description: Tipo do status
                  example: text
                text:
                  type: string
                  description: Texto principal ou legenda
                  example: Novidades chegando!
                background_color:
                  type: integer
                  minimum: 1
                  maximum: 19
                  description: CÃ³digo da cor de fundo
                  example: 7
                font:
                  type: integer
                  minimum: 0
                  maximum: 8
                  description: Estilo da fonte (apenas para type=text)
                  example: 1
                file:
                  type: string
                  description: URL ou Base64 do arquivo de mÃ­dia
                  example: https://example.com/video.mp4
                thumbnail:
                  type: string
                  description: URL ou Base64 da miniatura (opcional para vÃ­deos)
                  example: https://example.com/thumb.jpg
                mimetype:
                  type: string
                  description: MIME type do arquivo (opcional)
                  example: video/mp4
                track_source:
                  type: string
                  description: Origem do rastreamento da mensagem
                  example: chatwoot
                track_id:
                  type: string
                  description: ID para rastreamento da mensagem (aceita valores duplicados)
                  example: msg_123456789
              required:
                - type
      responses:
        "200":
          description: Status enviado com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  Id:
                    type: string
                    example: ABCD1234
                  content:
                    type: object
                    description: ConteÃºdo processado da mensagem
                  messageTimestamp:
                    type: integer
                    example: 1672531200000
                  status:
                    type: string
                    example: Pending
        "400":
          description: RequisiÃ§Ã£o invÃ¡lida
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Text too long
        "401":
          description: NÃ£o autorizado
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: No session
        "500":
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Failed to upload media
  /send/menu:
    post:
      tags:
        - Enviar Mensagem
      summary: Enviar menu interativo (botÃµes, carrosel, lista ou enquete)
      description: >-
        Este endpoint oferece uma interface unificada para envio de quatro tipos
        principais de mensagens interativas:

        - BotÃµes: Para aÃ§Ãµes rÃ¡pidas e diretas

        - Carrosel de BotÃµes: Para uma lista horizontal de botÃµes com imagens

        - Listas: Para menus organizados em seÃ§Ãµes

        - Enquetes: Para coleta de opiniÃµes e votaÃ§Ãµes


        **Suporte a campos de rastreamento**: Este endpoint tambÃ©m suporta
        `track_source` e `track_id` documentados na tag **"Enviar Mensagem"**.


        ## Estrutura Base do Payload


        Todas as requisiÃ§Ãµes seguem esta estrutura base:


        ```json

        {
          "number": "5511999999999",
          "type": "button|list|poll|carousel",
          "text": "Texto principal da mensagem",
          "choices": ["opÃ§Ãµes baseadas no tipo escolhido"],
          "footerText": "Texto do rodapÃ© (opcional para botÃµes e listas)",
          "listButton": "Texto do botÃ£o (para listas)",
          "selectableCount": "NÃºmero de opÃ§Ãµes selecionÃ¡veis (apenas para enquetes)"
        }

        ```


        ## Tipos de Mensagens Interativas


        ### 1. BotÃµes (type: "button")


        Cria botÃµes interativos com diferentes funcionalidades de aÃ§Ã£o.


        #### Campos EspecÃ­ficos

        - `footerText`: Texto opcional exibido abaixo da mensagem principal

        - `choices`: Array de opÃ§Ãµes que serÃ£o convertidas em botÃµes


        #### Formatos de BotÃµes

        Cada botÃ£o pode ser configurado usando `|` (pipe) ou `\n` (quebra de
        linha) como separadores:


        - **BotÃ£o de Resposta**: 
          - `"texto|id"` ou 
          - `"texto\nid"` ou 
          - `"texto"` (ID serÃ¡ igual ao texto)

        - **BotÃ£o de CÃ³pia**: 
          - `"texto|copy:cÃ³digo"` ou 
          - `"texto\ncopy:cÃ³digo"`

        - **BotÃ£o de Chamada**: 
          - `"texto|call:+5511999999999"` ou 
          - `"texto\ncall:+5511999999999"`

        - **BotÃ£o de URL**: 
          - `"texto|https://exemplo.com"` ou 
          - `"texto|url:https://exemplo.com"`

        #### BotÃµes com Imagem

        Para adicionar uma imagem aos botÃµes, use o campo `imageButton` no
        payload:


        #### Exemplo com Imagem

        ```json

        {
          "number": "5511999999999",
          "type": "button",
          "text": "Escolha um produto:",
          "imageButton": "https://exemplo.com/produto1.jpg",
          "choices": [
            "Produto A|prod_a",
            "Mais Info|https://exemplo.com/produto-a",
            "Produto B|prod_b",
            "Ligar|call:+5511999999999"
          ],
          "footerText": "Produtos em destaque"
        }

        ```


        > **Suporte**: O campo `imageButton` aceita URLs ou imagens em base64.


        #### Exemplo Completo

        ```json

        {
          "number": "5511999999999",
          "type": "button",
          "text": "Como podemos ajudar?",
          "choices": [
            "Suporte TÃ©cnico|suporte",
            "Fazer Pedido|pedido",
            "Nosso Site|https://exemplo.com",
            "Falar Conosco|call:+5511999999999"
          ],
          "footerText": "Escolha uma das opÃ§Ãµes abaixo"
        }

        ```


        #### LimitaÃ§Ãµes e Compatibilidade

        > **Importante**: Ao combinar botÃµes de resposta com outros tipos (call,
        url, copy) na mesma mensagem, serÃ¡ exibido o aviso: "NÃ£o Ã© possÃ­vel
        exibir esta mensagem no WhatsApp Web. Abra o WhatsApp no seu celular
        para visualizÃ¡-la."


        ### 2. Listas (type: "list")


        Cria menus organizados em seÃ§Ãµes com itens selecionÃ¡veis.


        #### Campos EspecÃ­ficos

        - `listButton`: Texto do botÃ£o que abre a lista

        - `footerText`: Texto opcional do rodapÃ©

        - `choices`: Array com seÃ§Ãµes e itens da lista


        #### Formato das Choices

        - `"[TÃ­tulo da SeÃ§Ã£o]"`: Inicia uma nova seÃ§Ã£o

        - `"texto|id|descriÃ§Ã£o"`: Item da lista com:
          - texto: Label do item
          - id: Identificador Ãºnico, opcional
          - descriÃ§Ã£o: Texto descritivo adicional e opcional

        #### Exemplo Completo

        ```json

        {
          "number": "5511999999999",
          "type": "list",
          "text": "CatÃ¡logo de Produtos",
          "choices": [
            "[EletrÃ´nicos]",
            "Smartphones|phones|Ãšltimos lanÃ§amentos",
            "Notebooks|notes|Modelos 2024",
            "[AcessÃ³rios]",
            "Fones|fones|Bluetooth e com fio",
            "Capas|cases|ProteÃ§Ã£o para seu device"
          ],
          "listButton": "Ver CatÃ¡logo",
          "footerText": "PreÃ§os sujeitos a alteraÃ§Ã£o"
        }

        ```


        ### 3. Enquetes (type: "poll")


        Cria enquetes interativas para votaÃ§Ã£o.


        #### Campos EspecÃ­ficos

        - `selectableCount`: NÃºmero de opÃ§Ãµes que podem ser selecionadas
        (padrÃ£o: 1)

        - `choices`: Array simples com as opÃ§Ãµes de voto


        #### Exemplo Completo

        ```json

        {
          "number": "5511999999999",
          "type": "poll",
          "text": "Qual horÃ¡rio prefere para atendimento?",
          "choices": [
            "ManhÃ£ (8h-12h)",
            "Tarde (13h-17h)",
            "Noite (18h-22h)"
          ],
          "selectableCount": 1
        }

        ```


        ### 4. Carousel (type: "carousel")


        Cria um carrossel de cartÃµes com imagens e botÃµes interativos.


        #### Campos EspecÃ­ficos

        - `choices`: Array com elementos do carrossel na seguinte ordem:
          - `[Texto do cartÃ£o]`: Texto do cartÃ£o entre colchetes
          - `{URL ou base64 da imagem}`: Imagem entre chaves
          - BotÃµes do cartÃ£o (um por linha):
            - `"texto|copy:cÃ³digo"` para botÃ£o de copiar
            - `"texto|https://url"` para botÃ£o de link
            - `"texto|call:+nÃºmero"` para botÃ£o de ligaÃ§Ã£o

        #### Exemplo Completo

        ```json

        {
          "number": "5511999999999",
          "type": "carousel",
          "text": "ConheÃ§a nossos produtos",
          "choices": [
            "[Smartphone XYZ\nO mais avanÃ§ado smartphone da linha]",
            "{https://exemplo.com/produto1.jpg}",
            "Copiar CÃ³digo|copy:PROD123",
            "Ver no Site|https://exemplo.com/xyz",
            "Fale Conosco|call:+5511999999999",
            "[Notebook ABC\nO notebook ideal para profissionais]",
            "{https://exemplo.com/produto2.jpg}",
            "Copiar CÃ³digo|copy:NOTE456",
            "Comprar Online|https://exemplo.com/abc",
            "Suporte|call:+5511988888888"
          ]
        }

        ```


        > **Nota**: Criamos outro endpoint para carrossel: `/send/carousel`,
        funciona da mesma forma, mas com outro formato de payload. Veja o que Ã©
        mais fÃ¡cil para vocÃª.


        ## Termos de uso


        Os recursos de botÃµes interativos e listas podem ser descontinuados a
        qualquer momento sem aviso prÃ©vio. NÃ£o nos responsabilizamos por
        quaisquer alteraÃ§Ãµes ou indisponibilidade destes recursos.


        ### Alternativas e Compatibilidade


        Considerando a natureza dinÃ¢mica destes recursos, nosso endpoint foi
        projetado para facilitar a migraÃ§Ã£o entre diferentes tipos de mensagens
        (botÃµes, listas e enquetes). 


        Recomendamos criar seus fluxos de forma flexÃ­vel, preparados para
        alternar entre os diferentes tipos.


        Em caso de descontinuidade de algum recurso, vocÃª poderÃ¡ facilmente
        migrar para outro tipo de mensagem apenas alterando o campo "type" no
        payload, mantendo a mesma estrutura de choices.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                number:
                  type: string
                  description: NÃºmero do destinatÃ¡rio (formato internacional)
                  example: "5511999999999"
                type:
                  type: string
                  description: Tipo do menu (button, list, poll, carousel)
                  enum:
                    - button
                    - list
                    - poll
                    - carousel
                  example: list
                text:
                  type: string
                  description: Texto principal (aceita placeholders)
                  example: "Escolha uma opÃ§Ã£o:"
                footerText:
                  type: string
                  description: Texto do rodapÃ© (opcional)
                  example: Menu de serviÃ§os
                listButton:
                  type: string
                  description: Texto do botÃ£o principal
                  example: Ver opÃ§Ãµes
                selectableCount:
                  type: integer
                  description: NÃºmero mÃ¡ximo de opÃ§Ãµes selecionÃ¡veis (para enquetes)
                  example: 1
                choices:
                  type: array
                  description: Lista de opÃ§Ãµes. Use [TÃ­tulo] para seÃ§Ãµes em listas
                  items:
                    type: string
                  example:
                    - "[EletrÃ´nicos]"
                    - Smartphones|phones|Ãšltimos lanÃ§amentos
                    - Notebooks|notes|Modelos 2024
                    - "[AcessÃ³rios]"
                    - Fones|fones|Bluetooth e com fio
                    - Capas|cases|ProteÃ§Ã£o para seu device
                imageButton:
                  type: string
                  description: "URL da imagem para botÃµes (recomendado para type: button)"
                  example: https://exemplo.com/imagem-botao.jpg
                replyid:
                  type: string
                  description: ID da mensagem para responder
                  example: 3EB0538DA65A59F6D8A251
                mentions:
                  type: string
                  description: NÃºmeros para mencionar (separados por vÃ­rgula)
                  example: 5511999999999,5511888888888
                readchat:
                  type: boolean
                  description: Marca conversa como lida apÃ³s envio
                  example: true
                readmessages:
                  type: boolean
                  description: Marca Ãºltimas mensagens recebidas como lidas
                  example: true
                delay:
                  type: integer
                  description: Atraso em milissegundos antes do envio, durante o atraso apacerÃ¡
                    'Digitando...'
                  example: 1000
                track_source:
                  type: string
                  description: Origem do rastreamento da mensagem
                  example: chatwoot
                track_id:
                  type: string
                  description: ID para rastreamento da mensagem (aceita valores duplicados)
                  example: msg_123456789
              required:
                - number
                - type
                - text
                - choices
      responses:
        "200":
          description: Menu enviado com sucesso
          content:
            application/json:
              schema:
                allOf:
                  - $ref: ../schemas/message.yaml#/Message
                  - type: object
                    properties:
                      response:
                        type: object
                        properties:
                          status:
                            type: string
                            example: success
                          message:
                            type: string
                            example: Menu sent successfully
        "400":
          description: RequisiÃ§Ã£o invÃ¡lida
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Missing required fields or invalid menu type
        "401":
          description: NÃ£o autorizado
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Invalid token
        "429":
          description: Limite de requisiÃ§Ãµes excedido
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Rate limit exceeded
        "500":
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Failed to send menu
  /send/carousel:
    post:
      tags:
        - Enviar Mensagem
      summary: Enviar carrossel de mÃ­dia com botÃµes
      description: >-
        Este endpoint permite enviar um carrossel com imagens e botÃµes
        interativos.

        Funciona de maneira igual ao endpoint `/send/menu` com type: carousel,
        porÃ©m usando outro formato de payload.


        ## Campos Comuns


        Este endpoint suporta todos os **campos opcionais comuns** documentados
        na tag **"Enviar Mensagem"**, incluindo:

        `delay`, `readchat`, `readmessages`, `replyid`, `mentions`, `forward`,
        `track_source`, `track_id`, placeholders e envio para grupos.


        ## Estrutura do Payload


        ```json

        {
          "number": "5511999999999",
          "text": "Texto principal",
          "carousel": [
            {
              "text": "Texto do cartÃ£o",
              "image": "URL da imagem",
              "buttons": [
                {
                  "id": "resposta1",
                  "text": "Texto do botÃ£o",
                  "type": "REPLY"
                }
              ]
            }
          ],
          "delay": 1000,
          "readchat": true
        }

        ```


        ## Tipos de BotÃµes


        - `REPLY`: BotÃ£o de resposta rÃ¡pida
          - Quando clicado, envia o valor do id como resposta ao chat
          - O id serÃ¡ o texto enviado como resposta

        - `URL`: BotÃ£o com link
          - Quando clicado, abre a URL especificada
          - O id deve conter a URL completa (ex: https://exemplo.com)

        - `COPY`: BotÃ£o para copiar texto
          - Quando clicado, copia o texto para a Ã¡rea de transferÃªncia
          - O id serÃ¡ o texto que serÃ¡ copiado

        - `CALL`: BotÃ£o para realizar chamada
          - Quando clicado, inicia uma chamada telefÃ´nica
          - O id deve conter o nÃºmero de telefone

        ## Exemplo de BotÃµes

        ```json

        {
          "buttons": [
            {
              "id": "Sim, quero comprar!",
              "text": "Confirmar Compra",
              "type": "REPLY"
            },
            {
              "id": "https://exemplo.com/produto",
              "text": "Ver Produto",
              "type": "URL"
            },
            {
              "id": "CUPOM20",
              "text": "Copiar Cupom",
              "type": "COPY"
            },
            {
              "id": "5511999999999",
              "text": "Falar com Vendedor",
              "type": "CALL"
            }
          ]
        }

        ```


        ## Exemplo Completo de Carrossel

        ```json

        {
          "number": "5511999999999",
          "text": "Nossos Produtos em Destaque",
          "carousel": [
            {
              "text": "Smartphone XYZ\nO mais avanÃ§ado smartphone da linha",
              "image": "https://exemplo.com/produto1.jpg",
              "buttons": [
                {
                  "id": "SIM_COMPRAR_XYZ",
                  "text": "Comprar Agora",
                  "type": "REPLY"
                },
                {
                  "id": "https://exemplo.com/xyz",
                  "text": "Ver Detalhes",
                  "type": "URL"
                }
              ]
            },
            {
              "text": "Cupom de Desconto\nGanhe 20% OFF em qualquer produto",
              "image": "https://exemplo.com/cupom.jpg",
              "buttons": [
                {
                  "id": "DESCONTO20",
                  "text": "Copiar Cupom",
                  "type": "COPY"
                },
                {
                  "id": "5511999999999",
                  "text": "Falar com Vendedor",
                  "type": "CALL"
                }
              ]
            }
          ],
          "delay": 0,
          "readchat": true
        }

        ```
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                number:
                  type: string
                  description: NÃºmero do destinatÃ¡rio (formato internacional)
                  example: "5511999999999"
                text:
                  type: string
                  description: Texto principal da mensagem
                  example: Nossos Produtos em Destaque
                carousel:
                  type: array
                  description: Array de cartÃµes do carrossel
                  items:
                    type: object
                    properties:
                      text:
                        type: string
                        description: Texto do cartÃ£o
                        example: |-
                          Smartphone XYZ
                          O mais avanÃ§ado smartphone da linha
                      image:
                        type: string
                        description: URL da imagem (opcional)
                        example: https://exemplo.com/produto1.jpg
                      buttons:
                        type: array
                        description: Array de botÃµes do cartÃ£o
                        items:
                          type: object
                          properties:
                            id:
                              type: string
                              description: ID do botÃ£o
                              example: buy_xyz
                            text:
                              type: string
                              description: Texto exibido no botÃ£o
                              example: Comprar Agora
                            type:
                              type: string
                              description: >-
                                Tipo do botÃ£o:

                                * REPLY - O id serÃ¡ enviado como resposta ao
                                chat

                                * URL - O id deve ser a URL completa que serÃ¡
                                aberta

                                * COPY - O id serÃ¡ o texto copiado para Ã¡rea de
                                transferÃªncia

                                * CALL - O id deve ser o nÃºmero de telefone para
                                a chamada
                              enum:
                                - REPLY
                                - URL
                                - CALL
                                - COPY
                              example: REPLY
                    required:
                      - text
                      - buttons
                track_source:
                  type: string
                  description: Origem do rastreamento da mensagem
                  example: chatwoot
                track_id:
                  type: string
                  description: ID para rastreamento da mensagem (aceita valores duplicados)
                  example: msg_123456789
              required:
                - number
                - text
                - carousel
      responses:
        "200":
          description: Carrossel enviado com sucesso
          content:
            application/json:
              schema:
                allOf:
                  - $ref: ../schemas/message.yaml#/Message
                  - type: object
                    properties:
                      response:
                        type: object
                        properties:
                          status:
                            type: string
                            example: success
                          message:
                            type: string
                            example: Carousel sent successfully
        "400":
          description: RequisiÃ§Ã£o invÃ¡lida
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Missing required fields or invalid card format
        "401":
          description: NÃ£o autorizado
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Invalid token
        "500":
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Failed to send carousel
  /send/location-button:
    post:
      tags:
        - Enviar Mensagem
      summary: Solicitar localizaÃ§Ã£o do usuÃ¡rio
      description: >-
        Este endpoint envia uma mensagem com um botÃ£o que solicita a localizaÃ§Ã£o
        do usuÃ¡rio.

        Quando o usuÃ¡rio clica no botÃ£o, o WhatsApp abre a interface para
        compartilhar a localizaÃ§Ã£o atual.


        ## Campos Comuns


        Este endpoint suporta todos os **campos opcionais comuns** documentados
        na tag **"Enviar Mensagem"**, incluindo:

        `delay`, `readchat`, `readmessages`, `replyid`, `mentions`, `forward`,
        `track_source`, `track_id`, placeholders e envio para grupos.


        ## Estrutura do Payload


        ```json

        {
          "number": "5511999999999",
          "text": "Por favor, compartilhe sua localizaÃ§Ã£o",
          "delay": 0,
          "readchat": true
        }

        ```


        ## Exemplo de Uso


        ```json

        {
          "number": "5511999999999",
          "text": "Para continuar o atendimento, clique no botÃ£o abaixo e compartilhe sua localizaÃ§Ã£o"
        }

        ```


        > **Nota**: O botÃ£o de localizaÃ§Ã£o Ã© adicionado automaticamente Ã 
        mensagem
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                number:
                  type: string
                  description: NÃºmero do destinatÃ¡rio (formato internacional)
                  example: "5511999999999"
                text:
                  type: string
                  description: Texto da mensagem que serÃ¡ exibida
                  example: Por favor, compartilhe sua localizaÃ§Ã£o
                delay:
                  type: integer
                  description: Atraso em milissegundos antes do envio
                  example: 0
                readchat:
                  type: boolean
                  description: Se deve marcar a conversa como lida apÃ³s envio
                  example: true
                track_source:
                  type: string
                  description: Origem do rastreamento da mensagem
                  example: chatwoot
                track_id:
                  type: string
                  description: ID para rastreamento da mensagem (aceita valores duplicados)
                  example: msg_123456789
              required:
                - number
                - text
      responses:
        "200":
          description: LocalizaÃ§Ã£o enviada com sucesso
          content:
            application/json:
              schema:
                allOf:
                  - $ref: ../schemas/message.yaml#/Message
                  - type: object
                    properties:
                      response:
                        type: object
                        properties:
                          status:
                            type: string
                            example: success
                          message:
                            type: string
                            example: Location sent successfully
        "400":
          description: RequisiÃ§Ã£o invÃ¡lida
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Missing required fields or invalid coordinates
        "401":
          description: NÃ£o autorizado
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Invalid token
        "500":
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Failed to send location
  /send/request-payment:
    post:
      tags:
        - Enviar Mensagem
      summary: Solicitar pagamento
      description: >-
        Envia uma solicitaÃ§Ã£o de pagamento com o botÃ£o nativo **"Revisar e
        pagar"** do WhatsApp.

        O fluxo suporta PIX (estÃ¡tico, dinÃ¢mico ou desabilitado), boleto, link
        de pagamento e cartÃ£o,

        combinando tudo em uma Ãºnica mensagem interativa.


        ## Como funciona

        - Define o valor em `amount` (BRL por padrÃ£o) e opcionalmente
        personaliza tÃ­tulo, texto e nota adicional.

        - Por padrÃ£o exige `pixKey`.

        - O arquivo apontado por `fileUrl` Ã© anexado como documento (boleto ou
        fatura em PDF, por exemplo).

        - `paymentLink` habilita o botÃ£o externo.


        ### Links suportados (`paymentLink`)

        O WhatsApp apenas aceita URLs de provedores homologados. Utilize os
        padrÃµes abaixo:

        - Mercado Pago: `mpago.la/*`, `mpago.li/*`, `mercadopago.com.br/*`

        - PicPay: `picpay.me/*`, `link.picpay.com/*`, `app.picpay.com/user/*`

        - Stone: `payment-link.stone.com.br/*`

        - Cielo: `cielolink.com.br/*`, `cielo.mystore.com.br/*`

        - Getnet: `pag.getnet.com.br/*`

        - Rede: `userede.com.br/pagamentos/*`

        - SumUp: `pay.sumup.com/b2c/*`

        - Pagar.me: `payment-link.pagar.me/*`

        - TON: `payment-link.ton.com.br/*`

        - PagBank: `sacola.pagbank.com.br/*`, `pag.ae/*`

        - Nubank: `nubank.com.br/cobrar/*`, `checkout.nubank.com.br/*`

        - InfinitePay: `pay.infinitepay.io/*`

        - VTEX: `*.vtexpayments.com/*`, `*.myvtex.com/*`

        - EBANX: `payment.ebanx.com/*`

        - Asaas: `asaas.com/*`

        - Vindi: `pagar.vindi.com.br/*`

        - Adyen: `eu.adyen.link/*`

        - EFI (Gerencianet): `sejaefi.link/*`, `pagamento.sejaefi.com.br/*`

        - SafraPay: `portal.safrapay.com.br/*`, `safrapay.aditum.com.br/*`

        - Stripe: `buy.stripe.com/*`

        - Hotmart: `pay.hotmart.com/*`



        ## Campos comuns

        Este endpoint tambÃ©m suporta os campos padrÃ£o: `delay`, `readchat`,
        `readmessages`, `replyid`,

        `mentions`, `track_source`, `track_id` e `async`.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                number:
                  type: string
                  description: NÃºmero do destinatÃ¡rio (DDD + nÃºmero, formato internacional)
                  example: "5511999999999"
                title:
                  type: string
                  description: TÃ­tulo que aparece no cabeÃ§alho do fluxo
                  example: Detalhes do pedido
                text:
                  type: string
                  description: Mensagem exibida no corpo do fluxo
                  example: "Pedido #123 pronto para pagamento"
                footer:
                  type: string
                  description: Texto do rodapÃ© da mensagem
                  example: Loja Exemplo
                itemName:
                  type: string
                  description: Nome do item principal listado no fluxo
                  example: Assinatura Plano Ouro
                invoiceNumber:
                  type: string
                  description: Identificador ou nÃºmero da fatura
                  example: PED-123
                amount:
                  type: number
                  format: float
                  description: Valor da cobranÃ§a (em BRL por padrÃ£o)
                  example: 199.9
                pixKey:
                  type: string
                  description: Chave PIX estÃ¡tico (CPF/CNPJ/telefone/email/EVP)
                  example: 123e4567-e89b-12d3-a456-426614174000
                pixType:
                  type: string
                  description: Tipo da chave PIX (`CPF`, `CNPJ`, `PHONE`, `EMAIL`, `EVP`). PadrÃ£o
                    `EVP`
                  example: EVP
                pixName:
                  type: string
                  description: Nome do recebedor exibido no fluxo (padrÃ£o usa o nome do perfil da
                    instÃ¢ncia)
                  example: Loja Exemplo
                paymentLink:
                  type: string
                  description: URL externa para checkout (somente dominios homologados; veja lista
                    acima)
                  example: https://pagamentos.exemplo.com/checkout/abc
                fileUrl:
                  type: string
                  description: "URL ou caminho (base64) do documento a ser anexado (ex.: boleto
                    PDF)"
                  example: https://cdn.exemplo.com/boleto-123.pdf
                fileName:
                  type: string
                  description: Nome do arquivo exibido no WhatsApp ao anexar `fileUrl`
                  example: boleto-123.pdf
                boletoCode:
                  type: string
                  description: Linha digitÃ¡vel do boleto (habilita o mÃ©todo boleto
                    automaticamente)
                  example: 34191.79001 01043.510047 91020.150008 5 91070026000
                replyid:
                  type: string
                  description: ID da mensagem que serÃ¡ respondida
                mentions:
                  type: string
                  description: NÃºmeros mencionados separados por vÃ­rgula
                delay:
                  type: integer
                  description: Atraso em milissegundos antes do envio (exibe "digitando..." no
                    WhatsApp)
                readchat:
                  type: boolean
                  description: Marca o chat como lido apÃ³s enviar a mensagem
                readmessages:
                  type: boolean
                  description: Marca mensagens recentes como lidas apÃ³s o envio
                async:
                  type: boolean
                  description: Enfileira o envio para processamento assÃ­ncrono
                track_source:
                  type: string
                  description: "Origem de rastreamento (ex.: chatwoot, crm-interno)"
                track_id:
                  type: string
                  description: Identificador de rastreamento (aceita valores duplicados)
              required:
                - number
                - amount
            examples:
              pixSimples:
                summary: PIX simples
                value:
                  number: "5511999999999"
                  amount: 199.9
                  text: "Pedido #123 pronto para pagamento"
                  pixKey: 123e4567-e89b-12d3-a456-426614174000
                  pixType: EVP
              pixEBoleto:
                summary: PIX + boleto
                value:
                  number: "5511999999999"
                  amount: 349.5
                  text: "Pedido #457 com boleto"
                  pixKey: "12345678000190"
                  pixType: CNPJ
                  pixName: Loja Exemplo LTDA
                  boletoCode: 34191.79001 01043.510047 91020.150008 5 91070026000
                  additionalNote: Pague via PIX ou utilize o boleto em anexo
              completo:
                summary: PIX + boleto + link
                value:
                  number: "5511888888888"
                  title: Assinatura Premium
                  text: Plano anual disponÃ­vel para pagamento
                  footer: footer
                  invoiceNumber: INV-789
                  itemName: Bolo XYZ
                  amount: 599
                  pixKey: 123e4567-e89b-12d3-a456-426614174000
                  pixType: EVP
                  pixName: Empresa Exemplo
                  boletoCode: 23793.38128 60000.000123 45670.000012 3 45670000012345
                  fileUrl: https://cdn.exemplo.com/boleto-inv-789.pdf
                  fileName: Clique para abrir o PDF.pdf
                  paymentLink: https://payment-link.pagar.me/checkout/inv-789
      responses:
        "200":
          description: SolicitaÃ§Ã£o de pagamento enviada com sucesso
          content:
            application/json:
              schema:
                allOf:
                  - $ref: ../schemas/message.yaml#/Message
                  - type: object
                    properties:
                      response:
                        type: object
                        properties:
                          status:
                            type: string
                            example: success
                          message:
                            type: string
                            example: Payment request sent successfully
        "400":
          description: RequisiÃ§Ã£o invÃ¡lida
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Missing pixKey or pixCode
        "401":
          description: NÃ£o autorizado
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Invalid token
        "500":
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Failed to send payment request
  /send/pix-button:
    post:
      tags:
        - Enviar Mensagem
      summary: Enviar botÃ£o PIX
      description: >-
        Envia um botÃ£o nativo do WhatsApp que abre para pagamento PIX com a
        chave informada.

        O usuÃ¡rio visualiza o detalhe do recebedor, nome e chave.


        ## Regras principais

        - `pixType` aceita: `CPF`, `CNPJ`, `PHONE`, `EMAIL`, `EVP` (case
        insensitive)

        - `pixName` padrÃ£o: `"Pix"` quando nÃ£o informado - nome de quem recebe o
        pagamento



        ## Campos comuns

        Este endpoint herda os campos opcionais padronizados da tag **"Enviar
        Mensagem"**:

        `delay`, `readchat`, `readmessages`, `replyid`, `mentions`,
        `track_source`, `track_id` e `async`.


        ## Exemplo de payload

        ```json

        {
          "number": "5511999999999",
          "pixType": "EVP",
          "pixKey": "123e4567-e89b-12d3-a456-426614174000",
          "pixName": "Loja Exemplo"
        }

        ```
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                number:
                  type: string
                  description: NÃºmero do destinatÃ¡rio (DDD + nÃºmero, formato internacional)
                  example: "5511999999999"
                pixType:
                  type: string
                  description: "Tipo da chave PIX. Valores aceitos: CPF, CNPJ, PHONE, EMAIL ou
                    EVP"
                  example: EVP
                pixKey:
                  type: string
                  description: Valor da chave PIX (CPF/CNPJ/telefone/email/EVP)
                  example: 123e4567-e89b-12d3-a456-426614174000
                pixName:
                  type: string
                  description: Nome exibido como recebedor do PIX (padrÃ£o "Pix" se vazio)
                  example: Loja Exemplo
                async:
                  type: boolean
                  description: Enfileira o envio para processamento assÃ­ncrono
                delay:
                  type: integer
                  description: Atraso em milissegundos antes do envio (exibe "digitando..." no
                    WhatsApp)
                readchat:
                  type: boolean
                  description: Marca o chat como lido apÃ³s enviar a mensagem
                readmessages:
                  type: boolean
                  description: Marca mensagens recentes como lidas apÃ³s o envio
                replyid:
                  type: string
                  description: ID da mensagem que serÃ¡ respondida
                mentions:
                  type: string
                  description: Lista de nÃºmeros mencionados separados por vÃ­rgula
                track_source:
                  type: string
                  description: "Origem de rastreamento (ex.: chatwoot, crm-interno)"
                track_id:
                  type: string
                  description: Identificador de rastreamento (aceita valores duplicados)
              required:
                - number
                - pixType
                - pixKey
              example:
                number: "5511999999999"
                pixType: EVP
                pixKey: 123e4567-e89b-12d3-a456-426614174000
                pixName: Loja Exemplo
      responses:
        "200":
          description: BotÃ£o PIX enviado com sucesso
          content:
            application/json:
              schema:
                allOf:
                  - $ref: ../schemas/message.yaml#/Message
                  - type: object
                    properties:
                      response:
                        type: object
                        properties:
                          status:
                            type: string
                            example: success
                          message:
                            type: string
                            example: PIX button sent successfully
        "400":
          description: RequisiÃ§Ã£o invÃ¡lida
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Invalid keyType. Allowed: CPF, CNPJ, PHONE, EMAIL, EVP"
        "401":
          description: NÃ£o autorizado
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Invalid token
        "500":
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Failed to send PIX button
  /message/download:
    post:
      tags:
        - AÃ§Ãµes na mensagem e Buscar
      summary: Baixar arquivo de uma mensagem
      description: >-
        Baixa o arquivo associado a uma mensagem de mÃ­dia (imagem, vÃ­deo, Ã¡udio,
        documento ou sticker).


        ## ParÃ¢metros


        - **id** (string, obrigatÃ³rio): ID da mensagem

        - **return_base64** (boolean, default: false): Retorna arquivo em base64

        - **generate_mp3** (boolean, default: true): Para Ã¡udios, define formato
        de retorno
          - `true`: Retorna MP3
          - `false`: Retorna OGG
        - **return_link** (boolean, default: true): Retorna URL pÃºblica do
        arquivo

        - **transcribe** (boolean, default: false): Transcreve Ã¡udios para texto

        - **openai_apikey** (string, opcional): Chave OpenAI para transcriÃ§Ã£o
          - Se nÃ£o informada, usa a chave salva na instÃ¢ncia
          - Se informada, atualiza e salva na instÃ¢ncia para prÃ³ximas chamadas
        - **download_quoted** (boolean, default: false): Baixa mÃ­dia da mensagem
        citada
          - Ãštil para baixar conteÃºdo original de status do WhatsApp
          - Quando uma mensagem Ã© resposta a um status, permite baixar a mÃ­dia do status original
          - **ContextualizaÃ§Ã£o**: Ao baixar a mÃ­dia citada, vocÃª identifica o contexto da conversa
            - Exemplo: Se alguÃ©m responde a uma promoÃ§Ã£o, baixando a mÃ­dia vocÃª saberÃ¡ que a pergunta Ã© sobre aquela promoÃ§Ã£o especÃ­fica

        ## Exemplos


        ### Baixar Ã¡udio como MP3:

        ```json

        {
          "id": "7EB0F01D7244B421048F0706368376E0",
          "generate_mp3": true
        }

        ```


        ### Transcrever Ã¡udio:

        ```json

        {
          "id": "7EB0F01D7244B421048F0706368376E0",
          "transcribe": true
        }

        ```


        ### Apenas base64 (sem salvar):

        ```json

        {
          "id": "7EB0F01D7244B421048F0706368376E0",
          "return_base64": true,
          "return_link": false
        }

        ```


        ### Baixar mÃ­dia de status (mensagem citada):

        ```json

        {
          "id": "7EB0F01D7244B421048F0706368376E0",
          "download_quoted": true
        }

        ```

        *Ãštil quando o cliente responde a uma promoÃ§Ã£o/status - vocÃª baixa a
        mÃ­dia original para entender sobre qual produto/oferta ele estÃ¡
        perguntando.*


        ## Resposta


        ```json

        {
          "fileURL": "https://api.exemplo.com/files/arquivo.mp3",
          "mimetype": "audio/mpeg",
          "base64Data": "UklGRkj...",
          "transcription": "Texto transcrito"
        }

        ```


        **Nota**: 

        - Por padrÃ£o, se nÃ£o definido o contrÃ¡rio:
          1. Ã¡udios sÃ£o retornados como MP3. 
          2. E todos os pedidos de download sÃ£o retornados com URL pÃºblica.
        - TranscriÃ§Ã£o requer chave OpenAI vÃ¡lida. A chave pode ser configurada
        uma vez na instÃ¢ncia e serÃ¡ reutilizada automaticamente.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                id:
                  type: string
                  description: ID da mensagem contendo o arquivo
                  example: 7EB0F01D7244B421048F0706368376E0
                return_base64:
                  type: boolean
                  description: Se verdadeiro, retorna o conteÃºdo em base64
                  default: false
                generate_mp3:
                  type: boolean
                  description: Para Ã¡udios, define formato de retorno (true=MP3, false=OGG)
                  default: true
                return_link:
                  type: boolean
                  description: Salva e retorna URL pÃºblica do arquivo
                  default: true
                transcribe:
                  type: boolean
                  description: Se verdadeiro, transcreve Ã¡udios para texto
                  default: false
                openai_apikey:
                  type: string
                  description: Chave da API OpenAI para transcriÃ§Ã£o (opcional)
                  example: sk-...
                download_quoted:
                  type: boolean
                  description: Se verdadeiro, baixa mÃ­dia da mensagem citada ao invÃ©s da mensagem
                    principal
                  default: false
              required:
                - id
      responses:
        "200":
          description: Successful file download
          content:
            application/json:
              schema:
                type: object
                properties:
                  fileURL:
                    type: string
                    description: URL pÃºblica para acessar o arquivo (se return_link=true)
                    example: https://api.exemplo.com/files/arquivo.mp3
                  mimetype:
                    type: string
                    description: Tipo MIME do arquivo
                    example: audio/mpeg
                  base64Data:
                    type: string
                    description: ConteÃºdo do arquivo em base64 (se return_base64=true)
                    example: UklGRkj...
                  transcription:
                    type: string
                    description: Texto transcrito do Ã¡udio (se transcribe=true)
                    example: Texto transcrito
                required:
                  - mimetype
        "400":
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Unsupported media type or no media found in message
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Invalid token
        "404":
          description: Not Found
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Message not found
                examples:
                  message_not_found:
                    summary: Mensagem nÃ£o encontrada
                    value:
                      error: Message not found
                  no_quoted_message:
                    summary: Mensagem citada nÃ£o encontrada (quando download_quoted=true)
                    value:
                      error: No quoted message found in this message
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Failed to download media
  /message/find:
    post:
      tags:
        - AÃ§Ãµes na mensagem e Buscar
      summary: Buscar mensagens em um chat
      description: >-
        Busca mensagens com mÃºltiplos filtros disponÃ­veis. Este endpoint
        permite:


        1. **Busca por ID especÃ­fico**: Use `id` para encontrar uma mensagem
        exata

        2. **Filtrar por chat**: Use `chatid` para mensagens de uma conversa
        especÃ­fica

        3. **Filtrar por rastreamento**: Use `track_source` e `track_id` para
        mensagens com dados de tracking

        4. **Limitar resultados**: Use `limit` para controlar quantas mensagens
        retornar

        5. **OrdenaÃ§Ã£o**: Resultados ordenados por data (mais recentes primeiro)
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                id:
                  type: string
                  description: ID especÃ­fico da mensagem para busca exata
                  example: user123:r3EB0538
                chatid:
                  type: string
                  description: ID do chat no formato internacional
                  example: 5511999999999@s.whatsapp.net
                track_source:
                  type: string
                  description: Origem do rastreamento para filtrar mensagens
                  example: chatwoot
                track_id:
                  type: string
                  description: ID de rastreamento para filtrar mensagens
                  example: msg_123456789
                limit:
                  type: integer
                  description: NÃºmero mÃ¡ximo de mensagens a retornar
                  minimum: 1
                  default: 100
                  example: 10
            examples:
              chatSearch:
                summary: Buscar por chat especÃ­fico
                description: Busca mensagens de uma conversa especÃ­fica
                value:
                  chatid: 5511999999999@s.whatsapp.net
                  limit: 10
              idSearch:
                summary: Buscar por ID especÃ­fico
                description: Busca uma mensagem especÃ­fica pelo seu ID
                value:
                  id: user123:r3EB0538
              trackingSearch:
                summary: Buscar por rastreamento
                description: Busca mensagens usando dados de tracking
                value:
                  track_source: chatwoot
                  track_id: conv_123456
                  limit: 50
      responses:
        "200":
          description: Lista de mensagens encontradas
          content:
            application/json:
              schema:
                type: object
                properties:
                  messages:
                    type: array
                    items:
                      $ref: ../schemas/message.yaml#/Message
        "400":
          description: ParÃ¢metros invÃ¡lidos
        "401":
          description: Token invÃ¡lido ou expirado
        "404":
          description: Chat nÃ£o encontrado
        "500":
          description: Erro interno do servidor
  /message/markread:
    post:
      tags:
        - AÃ§Ãµes na mensagem e Buscar
      summary: Marcar mensagens como lidas
      description: |-
        Marca uma ou mais mensagens como lidas. Este endpoint permite:
        1. Marcar mÃºltiplas mensagens como lidas de uma vez
        2. Atualizar o status de leitura no WhatsApp
        3. Sincronizar o status de leitura entre dispositivos

        Exemplo de requisiÃ§Ã£o bÃ¡sica:
        ```json
        {
          "id": [
            "62AD1AD844E518180227BF68DA7ED710",
            "ECB9DE48EB41F77BFA8491BFA8D6EF9B"  
          ]
        }
        ```

        Exemplo de resposta:
        ```json
        {
          "success": true,
          "message": "Messages marked as read",
          "markedMessages": [
            {
              "id": "62AD1AD844E518180227BF68DA7ED710",
              "timestamp": 1672531200000
            },
            {
              "id": "ECB9DE48EB41F77BFA8491BFA8D6EF9B",
              "timestamp": 1672531300000
            }
          ]
        }
        ```

        ParÃ¢metros disponÃ­veis:
        - id: Lista de IDs das mensagens a serem marcadas como lidas

        Erros comuns:
        - 401: Token invÃ¡lido ou expirado
        - 400: Lista de IDs vazia ou invÃ¡lida
        - 404: Uma ou mais mensagens nÃ£o encontradas
        - 500: Erro ao marcar mensagens como lidas
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                id:
                  type: array
                  description: Lista de IDs das mensagens a serem marcadas como lidas
                  items:
                    type: string
                  example:
                    - 62AD1AD844E518180227BF68DA7ED710
                    - ECB9DE48EB41F77BFA8491BFA8D6EF9B
              required:
                - id
      responses:
        "200":
          description: Messages successfully marked as read
          content:
            application/json:
              schema:
                type: object
                properties:
                  results:
                    type: array
                    items:
                      type: object
                      properties:
                        message_id:
                          type: string
                          description: ID of the message that was processed
                        status:
                          type: string
                          enum:
                            - success
                            - error
                          description: Status of the mark as read operation
                        error:
                          type: string
                          description: Error message if status is error
                    example:
                      - message_id: 62AD1AD844E518180227BF68DA7ED710
                        status: success
                      - message_id: ECB9DE48EB41F77BFA8491BFA8D6EF9B
                        status: error
                        error: Message not found
        "400":
          description: Invalid request payload or missing required fields
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Missing Id in Payload
        "401":
          description: Unauthorized - invalid or missing token
        "500":
          description: Server error while processing the request
  /message/react:
    post:
      tags:
        - AÃ§Ãµes na mensagem e Buscar
      summary: Enviar reaÃ§Ã£o a uma mensagem
      description: >-
        Envia uma reaÃ§Ã£o (emoji) a uma mensagem especÃ­fica. Este endpoint
        permite:


        1. Adicionar ou remover reaÃ§Ãµes em mensagens


        2. Usar qualquer emoji Unicode vÃ¡lido


        3. Reagir a mensagens em chats individuais ou grupos


        4. Remover reaÃ§Ãµes existentes


        5. Verificar o status da reaÃ§Ã£o enviada



        Tipos de reaÃ§Ãµes suportados:


        - Qualquer emoji Unicode vÃ¡lido (ðŸ‘, â¤ï¸, ðŸ˜‚, etc)


        - String vazia para remover reaÃ§Ã£o



        Exemplo de requisiÃ§Ã£o bÃ¡sica:


        ```json


        {
          "number": "5511999999999@s.whatsapp.net",
          "text": "ðŸ‘",
          "id": "3EB0538DA65A59F6D8A251"
        }


        ```



        Exemplo de requisiÃ§Ã£o para remover reaÃ§Ã£o:


        ```json


        {
          "number": "5511999999999@s.whatsapp.net",
          "text": "",
          "id": "3EB0538DA65A59F6D8A251"
        }


        ```



        Exemplo de resposta:


        ```json


        {
          "success": true,
          "message": "Reaction sent",
          "reaction": {
            "id": "3EB0538DA65A59F6D8A251",
            "emoji": "ðŸ‘",
            "timestamp": 1672531200000,
            "status": "sent"
          }
        }


        ```



        Exemplo de resposta ao remover reaÃ§Ã£o:


        ```json


        {
          "success": true,
          "message": "Reaction removed",
          "reaction": {
            "id": "3EB0538DA65A59F6D8A251",
            "emoji": null,
            "timestamp": 1672531200000,
            "status": "removed"
          }
        }


        ```



        ParÃ¢metros disponÃ­veis:


        - number: NÃºmero do chat no formato internacional (ex:

        5511999999999@s.whatsapp.net)


        - text: Emoji Unicode da reaÃ§Ã£o (ou string vazia para remover reaÃ§Ã£o)


        - id: ID da mensagem que receberÃ¡ a reaÃ§Ã£o



        Erros comuns:


        - 401: Token invÃ¡lido ou expirado


        - 400: NÃºmero invÃ¡lido ou emoji nÃ£o suportado


        - 404: Mensagem nÃ£o encontrada


        - 500: Erro ao enviar reaÃ§Ã£o



        LimitaÃ§Ãµes:


        - SÃ³ Ã© possÃ­vel reagir a mensagens enviadas por outros usuÃ¡rios


        - NÃ£o Ã© possÃ­vel reagir a mensagens antigas (mais de 7 dias)


        - O mesmo usuÃ¡rio sÃ³ pode ter uma reaÃ§Ã£o ativa por mensagem
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                number:
                  type: string
                  description: NÃºmero do chat no formato internacional
                  example: 5511999999999@s.whatsapp.net
                text:
                  type: string
                  description: Emoji Unicode da reaÃ§Ã£o (ou string vazia para remover reaÃ§Ã£o)
                  example: ðŸ‘
                id:
                  type: string
                  description: ID da mensagem que receberÃ¡ a reaÃ§Ã£o
                  example: 3EB0538DA65A59F6D8A251
              required:
                - number
                - text
                - id
      responses:
        "200":
          description: ReaÃ§Ã£o enviada com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: string
                    description: ID Ãºnico da mensagem de reaÃ§Ã£o
                    example: owner:generated_message_id
                  messageid:
                    type: string
                    description: ID gerado para a mensagem de reaÃ§Ã£o
                    example: generated_message_id
                  content:
                    type: object
                    description: Detalhes da reaÃ§Ã£o
                  messageTimestamp:
                    type: number
                    description: Timestamp da mensagem em milissegundos
                    example: 1672531200000
                  messageType:
                    type: string
                    description: Tipo da mensagem
                    example: reaction
                  status:
                    type: string
                    description: Status atual da mensagem
                    example: Pending
                  owner:
                    type: string
                    description: ProprietÃ¡rio da instÃ¢ncia
                    example: instance_owner
        "400":
          description: Erro nos dados da requisiÃ§Ã£o
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Missing Id in Payload
        "401":
          description: NÃ£o autorizado
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: No session
        "404":
          description: Mensagem nÃ£o encontrada
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Message not found
        "500":
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Error sending message
  /message/delete:
    post:
      tags:
        - AÃ§Ãµes na mensagem e Buscar
      summary: Apagar Mensagem Para Todos
      description: |-
        Apaga uma mensagem para todos os participantes da conversa.

        ### Funcionalidades:
        - Apaga mensagens em conversas individuais ou grupos
        - Funciona com mensagens enviadas pelo usuÃ¡rio ou recebidas
        - Atualiza o status no banco de dados
        - Envia webhook de atualizaÃ§Ã£o

        **Notas TÃ©cnicas**:
        1. O ID da mensagem pode ser fornecido em dois formatos:
           - ID completo (contÃ©m ":"): usado diretamente
           - ID curto: concatenado com o owner para busca
        2. Gera evento webhook do tipo "messages_update"
        3. Atualiza o status da mensagem para "Deleted"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                id:
                  type: string
                  description: ID da mensagem a ser apagada
              required:
                - id
      responses:
        "200":
          description: Mensagem apagada com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  timestamp:
                    type: string
                    format: date-time
                  id:
                    type: string
        "400":
          description: Payload invÃ¡lido ou ID de chat/sender invÃ¡lido
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: invalid payload
        "401":
          description: Token nÃ£o fornecido
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Unauthorized
        "404":
          description: Mensagem nÃ£o encontrada
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: message not found
        "500":
          description: Erro interno do servidor ou sessÃ£o nÃ£o iniciada
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: No session
  /message/edit:
    post:
      tags:
        - AÃ§Ãµes na mensagem e Buscar
      summary: Edita uma mensagem enviada
      description: >-
        Edita o conteÃºdo de uma mensagem jÃ¡ enviada usando a funcionalidade
        nativa do WhatsApp.


        O endpoint realiza:

        - Busca a mensagem original no banco de dados usando o ID fornecido

        - Edita o conteÃºdo da mensagem para o novo texto no WhatsApp

        - Gera um novo ID para a mensagem editada

        - Retorna objeto de mensagem completo seguindo o padrÃ£o da API

        - Dispara eventos SSE/Webhook automaticamente


        **Importante**: 

        - SÃ³ Ã© possÃ­vel editar mensagens enviadas pela prÃ³pria instÃ¢ncia

        - A mensagem deve existir no banco de dados

        - O ID pode ser fornecido no formato completo (owner:messageid) ou
        apenas messageid

        - A mensagem deve estar dentro do prazo permitido pelo WhatsApp para
        ediÃ§Ã£o
      security:
        - token: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - id
                - text
              properties:
                id:
                  type: string
                  description: ID Ãºnico da mensagem que serÃ¡ editada (formato owner:messageid ou
                    apenas messageid)
                  example: 3A12345678901234567890123456789012
                text:
                  type: string
                  description: Novo conteÃºdo de texto da mensagem
                  example: Texto editado da mensagem
      responses:
        "200":
          description: Mensagem editada com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: string
                    description: ID Ãºnico da mensagem no formato owner:messageid
                    example: 5511999999999:3A12345678901234567890123456789012
                  messageid:
                    type: string
                    description: ID da mensagem no WhatsApp
                    example: 3A12345678901234567890123456789012
                  content:
                    type: string
                    description: ConteÃºdo da mensagem editada
                    example: Texto editado da mensagem
                  messageTimestamp:
                    type: integer
                    description: Timestamp da mensagem (Unix timestamp em milissegundos)
                    example: 1704067200000
                  messageType:
                    type: string
                    description: Tipo da mensagem
                    example: text
                  status:
                    type: string
                    description: Status da mensagem
                    example: Pending
                  owner:
                    type: string
                    description: ProprietÃ¡rio da instÃ¢ncia
                    example: "5511999999999"
        "400":
          description: Dados invÃ¡lidos na requisiÃ§Ã£o
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Invalid payload
        "401":
          description: Sem sessÃ£o ativa
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: No session
        "404":
          description: Mensagem nÃ£o encontrada
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Message not found
        "500":
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Error fetching message from database
  /group/create:
    post:
      tags:
        - Grupos e Comunidades
      summary: Criar um novo grupo
      description: |-
        Cria um novo grupo no WhatsApp com participantes iniciais.

        ### Detalhes
        - Requer autenticaÃ§Ã£o via token da instÃ¢ncia
        - Os nÃºmeros devem ser fornecidos sem formataÃ§Ã£o (apenas dÃ­gitos)

        ### LimitaÃ§Ãµes
        - MÃ­nimo de 1 participante alÃ©m do criador
          
        ### Comportamento
        - Retorna informaÃ§Ãµes detalhadas do grupo criado
        - Inclui lista de participantes adicionados com sucesso/falha
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                  description: Nome do grupo
                  minLength: 1
                  maxLength: 100
                  example: zaptoswppGO grupo
                participants:
                  type: array
                  description: Lista de nÃºmeros de telefone dos participantes iniciais
                  items:
                    type: string
                    description: NÃºmero de telefone sem formataÃ§Ã£o
                  minItems: 1
                  maxItems: 50
                  example:
                    - "5521987905995"
                    - "5511912345678"
              required:
                - name
                - participants
            examples:
              default:
                value:
                  name: Meu Novo Grupo
                  participants:
                    - "5521987905995"
              multiple_participants:
                value:
                  name: Equipe de Projeto
                  participants:
                    - "5521987905995"
                    - "5511912345678"
                    - "5519987654321"
      responses:
        "200":
          description: Grupo criado com sucesso
          content:
            application/json:
              schema:
                $ref: ../schemas/group.yaml#/Group
        "400":
          description: Erro de payload invÃ¡lido
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Could not parse phone
        "500":
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Failed to create group
      security:
        - token: []
  /group/info:
    post:
      tags:
        - Grupos e Comunidades
      summary: Obter informaÃ§Ãµes detalhadas de um grupo
      description: |-
        Recupera informaÃ§Ãµes completas de um grupo do WhatsApp, incluindo:
        - Detalhes do grupo
        - Participantes
        - ConfiguraÃ§Ãµes
        - Link de convite (opcional)
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                groupjid:
                  type: string
                  description: Identificador Ãºnico do grupo (JID)
                  example: 120363153742561022@g.us
                getInviteLink:
                  type: boolean
                  description: Recuperar link de convite do grupo
                  default: false
                  example: true
                getRequestsParticipants:
                  type: boolean
                  description: Recuperar lista de solicitaÃ§Ãµes pendentes de participaÃ§Ã£o
                  default: false
                  example: false
                force:
                  type: boolean
                  description: ForÃ§ar atualizaÃ§Ã£o, ignorando cache
                  default: false
                  example: false
              required:
                - groupjid
      responses:
        "200":
          description: InformaÃ§Ãµes do grupo obtidas com sucesso
          content:
            application/json:
              schema:
                $ref: ../schemas/group.yaml#/Group
              example:
                JID: 120363153742561022@g.us
                Name: zaptoswppGO Community
                Participants:
                  - JID: 5521987654321@s.whatsapp.net
                    IsAdmin: true
                IsLocked: false
                IsAnnounce: false
        "400":
          description: CÃ³digo de convite invÃ¡lido ou mal formatado
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Invalid invite code
        "404":
          description: Grupo nÃ£o encontrado ou link de convite expirado
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Group invite link is invalid or has expired
        "500":
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Failed to retrieve group information
  /group/inviteInfo:
    post:
      tags:
        - Grupos e Comunidades
      summary: Obter informaÃ§Ãµes de um grupo pelo cÃ³digo de convite
      description: >-
        Retorna informaÃ§Ãµes detalhadas de um grupo usando um cÃ³digo de convite
        ou URL completo do WhatsApp.


        Esta rota permite:

        - Recuperar informaÃ§Ãµes bÃ¡sicas sobre um grupo antes de entrar

        - Validar um link de convite

        - Obter detalhes como nome do grupo, nÃºmero de participantes e
        restriÃ§Ãµes de entrada
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                inviteCode:
                  type: string
                  description: |-
                    CÃ³digo de convite ou URL completo do grupo.
                    Pode ser um cÃ³digo curto ou a URL completa do WhatsApp.
                  examples:
                    - IYnl5Zg9bUcJD32rJrDzO7
                    - https://chat.whatsapp.com/IYnl5Zg9bUcJD32rJrDzO7
              required:
                - inviteCode
      responses:
        "200":
          description: InformaÃ§Ãµes do grupo obtidas com sucesso
          content:
            application/json:
              schema:
                $ref: ../schemas/group.yaml#/Group
              example:
                JID: 120363153742561022@g.us
                Name: zaptoswppGO Community
                Participants:
                  - JID: 5521987654321@s.whatsapp.net
                    IsAdmin: true
                IsLocked: false
                IsAnnounce: false
        "400":
          description: CÃ³digo de convite invÃ¡lido ou mal formatado
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Invalid invite code
        "404":
          description: Grupo nÃ£o encontrado ou link de convite expirado
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Group invite link is invalid or has expired
        "500":
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Failed to retrieve group information
  /group/invitelink/:groupJID:
    get:
      tags:
        - Grupos e Comunidades
      summary: Gerar link de convite para um grupo
      description: |-
        Retorna o link de convite para o grupo especificado. 
        Esta operaÃ§Ã£o requer que o usuÃ¡rio seja um administrador do grupo.
      parameters:
        - name: groupJID
          in: path
          required: true
          schema:
            type: string
            description: JID (ID do grupo) no formato WhatsApp
            example: 120363153742561022@g.us
      responses:
        "200":
          description: Link de convite gerado com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  inviteLink:
                    type: string
                    description: Link de convite completo para o grupo
                    example: https://chat.whatsapp.com/AbCdEfGhIjKlMnOpQrStUv
        "400":
          description: Erro ao processar a solicitaÃ§Ã£o
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: DescriÃ§Ã£o do erro
        "403":
          description: UsuÃ¡rio nÃ£o tem permissÃ£o para gerar link
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Mensagem indicando falta de permissÃ£o
        "500":
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Detalhes do erro interno
  /group/join:
    post:
      tags:
        - Grupos e Comunidades
      summary: Entrar em um grupo usando cÃ³digo de convite
      description: >-
        Permite entrar em um grupo do WhatsApp usando um cÃ³digo de convite ou
        URL completo. 


        CaracterÃ­sticas:

        - Suporta cÃ³digo de convite ou URL completo

        - Valida o cÃ³digo antes de tentar entrar no grupo

        - Retorna informaÃ§Ãµes bÃ¡sicas do grupo apÃ³s entrada bem-sucedida

        - Trata possÃ­veis erros como convite invÃ¡lido ou expirado
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - inviteCode
              properties:
                inviteCode:
                  type: string
                  description: >-
                    CÃ³digo de convite ou URL completo do grupo. 

                    Formatos aceitos:

                    - CÃ³digo completo: "IYnl5Zg9bUcJD32rJrDzO7"

                    - URL completa:
                    "https://chat.whatsapp.com/IYnl5Zg9bUcJD32rJrDzO7"
                  example: https://chat.whatsapp.com/IYnl5Zg9bUcJD32rJrDzO7
                  minLength: 10
                  maxLength: 50
      responses:
        "200":
          description: Entrada no grupo realizada com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  response:
                    type: string
                    example: Group join successful
                  group:
                    $ref: ../schemas/group.yaml#/Group
        "400":
          description: CÃ³digo de convite invÃ¡lido
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Invalid invite code
        "403":
          description: UsuÃ¡rio jÃ¡ estÃ¡ no grupo ou nÃ£o tem permissÃ£o para entrar
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Unable to join group
        "500":
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Error processing group invite
  /group/leave:
    post:
      tags:
        - Grupos e Comunidades
      summary: Sair de um grupo
      description: |-
        Remove o usuÃ¡rio atual de um grupo especÃ­fico do WhatsApp.

        Requisitos:
        - O usuÃ¡rio deve estar conectado a uma instÃ¢ncia vÃ¡lida
        - O usuÃ¡rio deve ser um membro do grupo

        Comportamentos:
        - Se o usuÃ¡rio for o Ãºltimo administrador, o grupo serÃ¡ dissolvido
        - Se o usuÃ¡rio for um membro comum, serÃ¡ removido do grupo
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                groupjid:
                  type: string
                  description: |-
                    Identificador Ãºnico do grupo (JID)
                    - Formato: nÃºmero@g.us
                    - Exemplo vÃ¡lido: 120363324255083289@g.us
                  example: 120363324255083289@g.us
                  pattern: ^\d+@g\.us$
              required:
                - groupjid
      responses:
        "200":
          description: SaÃ­da do grupo realizada com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  response:
                    type: string
                    example: Group leave successful
        "400":
          description: Erro de payload invÃ¡lido
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: invalid payload
        "500":
          description: Erro interno do servidor ou falha na conexÃ£o
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: error leaving group
  /group/list:
    get:
      tags:
        - Grupos e Comunidades
      summary: Listar todos os grupos
      description: >-
        Retorna uma lista com todos os grupos disponÃ­veis para a instÃ¢ncia atual
        do WhatsApp.


        Recursos adicionais:

        - Suporta atualizaÃ§Ã£o forÃ§ada do cache de grupos

        - Recupera informaÃ§Ãµes detalhadas de grupos conectados
      parameters:
        - name: force
          in: query
          schema:
            type: boolean
            default: false
          description: >-
            Se definido como `true`, forÃ§a a atualizaÃ§Ã£o do cache de grupos.

            Ãštil para garantir que as informaÃ§Ãµes mais recentes sejam
            recuperadas.


            Comportamentos:

            - `false` (padrÃ£o): Usa informaÃ§Ãµes em cache

            - `true`: Busca dados atualizados diretamente do WhatsApp
        - name: noparticipants
          in: query
          schema:
            type: boolean
            default: false
          description: >-
            Se definido como `true`, retorna a lista de grupos sem incluir os
            participantes.

            Ãštil para otimizar a resposta quando nÃ£o hÃ¡ necessidade dos dados
            dos participantes.


            Comportamentos:

            - `false` (padrÃ£o): Retorna grupos com lista completa de
            participantes

            - `true`: Retorna grupos sem incluir os participantes
      responses:
        "200":
          description: Lista de grupos recuperada com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  groups:
                    type: array
                    items:
                      $ref: ../schemas/group.yaml#/Group
                    description: Lista detalhada de grupos
        "500":
          description: Erro interno do servidor ao recuperar grupos
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Mensagem detalhando o erro encontrado
  /group/resetInviteCode:
    post:
      tags:
        - Grupos e Comunidades
      summary: Resetar cÃ³digo de convite do grupo
      description: >-
        Gera um novo cÃ³digo de convite para o grupo, invalidando o cÃ³digo de
        convite anterior. 

        Somente administradores do grupo podem realizar esta aÃ§Ã£o.


        Principais caracterÃ­sticas:

        - Invalida o link de convite antigo

        - Cria um novo link Ãºnico

        - Retorna as informaÃ§Ãµes atualizadas do grupo
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                groupjid:
                  type: string
                  description: Identificador Ãºnico do grupo (JID)
                  example: 120363308883996631@g.us
              required:
                - groupjid
      responses:
        "200":
          description: CÃ³digo de convite resetado com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  InviteLink:
                    type: string
                    description: Novo link de convite gerado
                    example: https://chat.whatsapp.com/AbCdEfGhIjKlMnOpQrStUv
                  group:
                    $ref: ../schemas/group.yaml#/Group
        "400":
          description: Erro de validaÃ§Ã£o
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Could not parse Group JID
        "403":
          description: UsuÃ¡rio sem permissÃ£o
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: User is not an admin of this group
        "500":
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Failed to reset group invite link
  /group/updateAnnounce:
    post:
      tags:
        - Grupos e Comunidades
      summary: Configurar permissÃµes de envio de mensagens no grupo
      description: >-
        Define as permissÃµes de envio de mensagens no grupo, permitindo
        restringir o envio apenas para administradores.


        Quando ativado (announce=true):

        - Apenas administradores podem enviar mensagens

        - Outros participantes podem apenas ler

        - Ãštil para anÃºncios importantes ou controle de spam


        Quando desativado (announce=false):

        - Todos os participantes podem enviar mensagens

        - ConfiguraÃ§Ã£o padrÃ£o para grupos normais


        Requer que o usuÃ¡rio seja administrador do grupo para fazer alteraÃ§Ãµes.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                groupjid:
                  type: string
                  description: Identificador Ãºnico do grupo no formato xxxx@g.us
                  example: 120363339858396166@g.us
                announce:
                  type: boolean
                  description: Controla quem pode enviar mensagens no grupo
                  example: true
              required:
                - groupjid
                - announce
      responses:
        "200":
          description: ConfiguraÃ§Ã£o atualizada com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  response:
                    type: string
                    example: Group announce enabled successfully
                  group:
                    $ref: ../schemas/group.yaml#/Group
        "401":
          description: Token de autenticaÃ§Ã£o ausente ou invÃ¡lido
        "403":
          description: UsuÃ¡rio nÃ£o Ã© administrador do grupo
        "404":
          description: Grupo nÃ£o encontrado
        "500":
          description: Erro interno do servidor ou falha na API do WhatsApp
  /group/updateDescription:
    post:
      tags:
        - Grupos e Comunidades
      summary: Atualizar descriÃ§Ã£o do grupo
      description: >-
        Altera a descriÃ§Ã£o (tÃ³pico) do grupo WhatsApp especificado.

        Requer que o usuÃ¡rio seja administrador do grupo.

        A descriÃ§Ã£o aparece na tela de informaÃ§Ãµes do grupo e pode ser
        visualizada por todos os participantes.
      operationId: updateGroupDescription
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - groupjid
                - description
              properties:
                groupjid:
                  type: string
                  description: JID (ID) do grupo no formato xxxxx@g.us
                  example: 120363339858396166@g.us
                  pattern: ^[0-9]+@g\.us$
                description:
                  type: string
                  description: Nova descriÃ§Ã£o/tÃ³pico do grupo
                  example: Grupo oficial de suporte
                  maxLength: 512
      responses:
        "200":
          description: DescriÃ§Ã£o atualizada com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  response:
                    type: string
                    example: Group description updated successfully
                  group:
                    $ref: ../schemas/group.yaml#/Group
        "401":
          description: Token invÃ¡lido ou ausente
        "403":
          description: UsuÃ¡rio nÃ£o Ã© administrador do grupo
        "404":
          description: Grupo nÃ£o encontrado
        "413":
          description: DescriÃ§Ã£o excede o limite mÃ¡ximo permitido
  /group/updateImage:
    post:
      tags:
        - Grupos e Comunidades
      summary: Atualizar imagem do grupo
      description: >-
        Altera a imagem do grupo especificado. A imagem pode ser enviada como
        URL ou como string base64.


        Requisitos da imagem:

        - Formato: JPEG

        - ResoluÃ§Ã£o mÃ¡xima: 640x640 pixels

        - Imagens maiores ou diferente de JPEG nÃ£o sÃ£o aceitas pelo WhatsApp


        Para remover a imagem atual, envie "remove" ou "delete" no campo image.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                groupjid:
                  type: string
                  description: JID do grupo
                  example: 120363308883996631@g.us
                image:
                  type: string
                  description: >-
                    URL da imagem, string base64 ou "remove"/"delete" para
                    remover.

                    A imagem deve estar em formato JPEG e ter resoluÃ§Ã£o mÃ¡xima
                    de 640x640.
                  examples:
                    url:
                      value: https://example.com/image.jpg
                      summary: URL da imagem
                    base64:
                      value: data:image/jpeg;base64,/9j/4AAQSkZJRg...
                      summary: Imagem em base64
                    remove:
                      value: remove
                      summary: Remover imagem atual
              required:
                - groupjid
                - image
      parameters: []
      responses:
        "200":
          description: Imagem atualizada com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  response:
                    type: string
                    example: Group image updated successfully
                  group:
                    $ref: ../schemas/group.yaml#/Group
        "400":
          description: Erro nos parÃ¢metros da requisiÃ§Ã£o
        "401":
          description: Token invÃ¡lido ou expirado
        "403":
          description: UsuÃ¡rio nÃ£o Ã© administrador do grupo
        "413":
          description: Imagem muito grande
        "415":
          description: Formato de imagem invÃ¡lido
  /group/updateLocked:
    post:
      tags:
        - Grupos e Comunidades
      summary: Configurar permissÃ£o de ediÃ§Ã£o do grupo
      description: >-
        Define se apenas administradores podem editar as informaÃ§Ãµes do grupo. 

        Quando bloqueado (locked=true), apenas administradores podem alterar
        nome, descriÃ§Ã£o, 

        imagem e outras configuraÃ§Ãµes do grupo. Quando desbloqueado
        (locked=false), 

        qualquer participante pode editar as informaÃ§Ãµes.


        Importante:

        - Requer que o usuÃ¡rio seja administrador do grupo

        - Afeta ediÃ§Ãµes de nome, descriÃ§Ã£o, imagem e outras informaÃ§Ãµes do grupo

        - NÃ£o controla permissÃµes de adiÃ§Ã£o de membros
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                groupjid:
                  type: string
                  description: Identificador Ãºnico do grupo (JID)
                  example: 120363308883996631@g.us
                locked:
                  type: boolean
                  description: |-
                    Define permissÃµes de ediÃ§Ã£o:
                    - true = apenas admins podem editar infos do grupo
                    - false = qualquer participante pode editar infos do grupo
                  example: true
              required:
                - groupjid
                - locked
      responses:
        "200":
          description: OperaÃ§Ã£o realizada com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  response:
                    type: string
                    example: Group lock status changed successfully
                  group:
                    $ref: ../schemas/group.yaml#/Group
        "403":
          description: UsuÃ¡rio nÃ£o Ã© administrador do grupo
        "404":
          description: Grupo nÃ£o encontrado
  /group/updateName:
    post:
      tags:
        - Grupos e Comunidades
      summary: Atualizar nome do grupo
      description: >-
        Altera o nome de um grupo do WhatsApp. Apenas administradores do grupo
        podem realizar esta operaÃ§Ã£o.

        O nome do grupo deve seguir as diretrizes do WhatsApp e ter entre 1 e 25
        caracteres.
      security:
        - token: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - groupjid
                - name
              properties:
                groupjid:
                  type: string
                  description: Identificador Ãºnico do grupo no formato JID
                  example: 120363339858396166@g.us
                name:
                  type: string
                  description: Novo nome para o grupo
                  example: Grupo de Suporte
                  minLength: 1
                  maxLength: 25
      responses:
        "200":
          description: Nome do grupo atualizado com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  response:
                    type: string
                    example: Group name updated successfully
                  group:
                    $ref: ../schemas/group.yaml#/Group
        "400":
          description: Erro de validaÃ§Ã£o na requisiÃ§Ã£o
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Invalid payload
        "401":
          description: Token de autenticaÃ§Ã£o ausente ou invÃ¡lido
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Unauthorized
        "403":
          description: UsuÃ¡rio nÃ£o Ã© administrador do grupo
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: User is not an admin of this group
        "404":
          description: Grupo nÃ£o encontrado
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Group not found
        "500":
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Failed to update group name
  /group/updateParticipants:
    post:
      tags:
        - Grupos e Comunidades
      summary: Gerenciar participantes do grupo
      description: |-
        Gerencia participantes do grupo atravÃ©s de diferentes aÃ§Ãµes:
        - Adicionar ou remover participantes
        - Promover ou rebaixar administradores
        - Aprovar ou rejeitar solicitaÃ§Ãµes pendentes

        Requer que o usuÃ¡rio seja administrador do grupo para executar as aÃ§Ãµes.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                groupjid:
                  type: string
                  description: JID (identificador) do grupo
                  example: 120363308883996631@g.us
                action:
                  type: string
                  description: |-
                    AÃ§Ã£o a ser executada:
                    - add: Adicionar participantes ao grupo
                    - remove: Remover participantes do grupo
                    - promote: Promover participantes a administradores
                    - demote: Remover privilÃ©gios de administrador
                    - approve: Aprovar solicitaÃ§Ãµes pendentes de entrada
                    - reject: Rejeitar solicitaÃ§Ãµes pendentes de entrada
                  enum:
                    - add
                    - remove
                    - promote
                    - demote
                    - approve
                    - reject
                  example: promote
                participants:
                  type: array
                  items:
                    type: string
                  description: >-
                    Lista de nÃºmeros de telefone ou JIDs dos participantes.

                    Para nÃºmeros de telefone, use formato internacional sem '+'
                    ou espaÃ§os.
                  example:
                    - "5521987654321"
                    - "5511999887766"
              required:
                - groupjid
                - action
                - participants
      responses:
        "200":
          description: Sucesso na operaÃ§Ã£o
          content:
            application/json:
              schema:
                type: object
                properties:
                  groupUpdated:
                    type: array
                    items:
                      type: object
                      properties:
                        JID:
                          type: string
                          description: JID do participante
                        Error:
                          type: integer
                          description: CÃ³digo de erro (0 para sucesso)
                    description: Status da operaÃ§Ã£o para cada participante
                  group:
                    $ref: ../schemas/group.yaml#/Group
                    description: InformaÃ§Ãµes atualizadas do grupo
        "400":
          description: Erro nos parÃ¢metros da requisiÃ§Ã£o
        "403":
          description: UsuÃ¡rio nÃ£o Ã© administrador do grupo
        "500":
          description: Erro interno do servidor
  /community/create:
    post:
      tags:
        - Grupos e Comunidades
      summary: Criar uma comunidade
      description: >-
        Cria uma nova comunidade no WhatsApp. Uma comunidade Ã© uma estrutura que
        permite agrupar mÃºltiplos grupos relacionados sob uma Ãºnica
        administraÃ§Ã£o. 


        A comunidade criada inicialmente terÃ¡ apenas o grupo principal
        (announcements), e grupos adicionais podem ser vinculados posteriormente
        usando o endpoint `/community/updategroups`.


        **ObservaÃ§Ãµes importantes:**

        - O nÃºmero que cria a comunidade torna-se automaticamente o
        administrador

        - A comunidade terÃ¡ um grupo principal de anÃºncios criado
        automaticamente
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                  description: Nome da comunidade
                  example: Comunidade do Bairro
              required:
                - name
      responses:
        "200":
          description: Comunidade criada com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  group:
                    $ref: ../schemas/group.yaml#/Group
                  failed:
                    type: array
                    description: Lista de JIDs que falharam ao serem adicionados
                    items:
                      type: string
                      format: jid
        "400":
          description: Erro na requisiÃ§Ã£o
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: invalid payload
        "401":
          description: Token invÃ¡lido ou nÃ£o fornecido
        "403":
          description: Sem permissÃ£o para criar comunidades
        "429":
          description: Limite de criaÃ§Ã£o de comunidades atingido
        "500":
          description: Erro interno do servidor
  /community/editgroups:
    post:
      tags:
        - Grupos e Comunidades
      summary: Gerenciar grupos em uma comunidade
      description: >-
        Adiciona ou remove grupos de uma comunidade do WhatsApp. Apenas
        administradores da comunidade podem executar estas operaÃ§Ãµes.


        ## Funcionalidades

        - Adicionar mÃºltiplos grupos simultaneamente a uma comunidade

        - Remover grupos de uma comunidade existente

        - Suporta operaÃ§Ãµes em lote


        ## LimitaÃ§Ãµes

        - Os grupos devem existir previamente

        - A comunidade deve existir e o usuÃ¡rio deve ser administrador

        - Grupos jÃ¡ vinculados nÃ£o podem ser adicionados novamente

        - Grupos nÃ£o vinculados nÃ£o podem ser removidos


        ## AÃ§Ãµes DisponÃ­veis

        - `add`: Adiciona os grupos especificados Ã  comunidade

        - `remove`: Remove os grupos especificados da comunidade
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - community
                - action
                - groupjids
              properties:
                community:
                  type: string
                  description: JID (identificador Ãºnico) da comunidade
                  example: 120363153742561022@g.us
                action:
                  type: string
                  enum:
                    - add
                    - remove
                  description: |-
                    Tipo de operaÃ§Ã£o a ser realizada:
                    * add - Adiciona grupos Ã  comunidade
                    * remove - Remove grupos da comunidade
                groupjids:
                  type: array
                  items:
                    type: string
                    pattern: ^[0-9]+@g.us$
                  minItems: 1
                  description: Lista de JIDs dos grupos para adicionar ou remover
                  example:
                    - 120363324255083289@g.us
                    - 120363308883996631@g.us
      responses:
        "200":
          description: OperaÃ§Ã£o realizada com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: community updated
                  success:
                    type: array
                    items:
                      type: string
                    description: Lista de JIDs dos grupos processados com sucesso
                  failed:
                    type: array
                    items:
                      type: string
                    description: Lista de JIDs dos grupos que falharam no processamento
        "400":
          description: RequisiÃ§Ã£o invÃ¡lida
        "401":
          description: NÃ£o autorizado
        "403":
          description: UsuÃ¡rio nÃ£o Ã© administrador da comunidade
  /webhook:
    get:
      tags:
        - Webhooks e SSE
      summary: Ver Webhook da InstÃ¢ncia
      description: >-
        Retorna a configuraÃ§Ã£o atual do webhook da instÃ¢ncia, incluindo:

        - URL configurada

        - Eventos ativos

        - Filtros aplicados

        - ConfiguraÃ§Ãµes adicionais


        Exemplo de resposta:

        ```json

        [
          {
            "id": "123e4567-e89b-12d3-a456-426614174000",
            "enabled": true,
            "url": "https://example.com/webhook",
            "events": ["messages", "messages_update"],
            "excludeMessages": ["wasSentByApi", "isGroupNo"],
            "addUrlEvents": true,
            "addUrlTypesMessages": true
          },
          {
            "id": "987fcdeb-51k3-09j8-x543-864297539100",
            "enabled": true,
            "url": "https://outro-endpoint.com/webhook",
            "events": ["connection", "presence"],
            "excludeMessages": [],
            "addUrlEvents": false,
            "addUrlTypesMessages": false
          }
        ]

        ```


        A resposta Ã© sempre um array, mesmo quando hÃ¡ apenas um webhook
        configurado.
      responses:
        "200":
          description: ConfiguraÃ§Ã£o do webhook retornada com sucesso
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: ../schemas/webhook.yaml#/Webhook
              example:
                - id: 123e4567-e89b-12d3-a456-426614174000
                  enabled: true
                  url: https://example.com/webhook
                  events:
                    - messages
                    - messages_update
                  excludeMessages:
                    - wasSentByApi
                    - isGroupNo
                  addUrlEvents: true
                  addUrlTypesMessages: true
                - id: 987fcdeb-51k3-09j8-x543-864297539100
                  enabled: true
                  url: https://outro-endpoint.com/webhook
                  events:
                    - connection
                    - presence
                  excludeMessages: []
                  addUrlEvents: false
                  addUrlTypesMessages: false
        "401":
          description: Token invÃ¡lido ou nÃ£o fornecido
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: missing token
        "500":
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Failed to process webhook data
    post:
      tags:
        - Webhooks e SSE
      summary: Configurar Webhook da InstÃ¢ncia
      description: >-
        Gerencia a configuraÃ§Ã£o de webhooks para receber eventos em tempo real
        da instÃ¢ncia.

        Permite gerenciar mÃºltiplos webhooks por instÃ¢ncia atravÃ©s do campo ID e
        action.


        ### ðŸš€ Modo Simples (Recomendado)


        **Uso mais fÃ¡cil - sem complexidade de IDs**:

        - NÃ£o inclua `action` nem `id` no payload

        - Gerencia automaticamente um Ãºnico webhook por instÃ¢ncia

        - Cria novo ou atualiza o existente automaticamente

        - **Recomendado**: Sempre use `"excludeMessages": ["wasSentByApi"]` para
        evitar loops

        - **Exemplo**: `{"url": "https://meusite.com/webhook", "events":
        ["messages"], "excludeMessages": ["wasSentByApi"]}`


        ### ðŸ§ª Sites para Testes (ordenados por qualidade)


        **Para testar webhooks durante desenvolvimento**:

        1. **https://webhook.cool/** - â­ Melhor opÃ§Ã£o (sem rate limit, interface
        limpa)

        2. **https://rbaskets.in/** - â­ Boa alternativa (confiÃ¡vel, baixo rate
        limit)

        3. **https://webhook.site/** - âš ï¸ Evitar se possÃ­vel (rate limit
        agressivo)


        ### âš™ï¸ Modo AvanÃ§ado (Para mÃºltiplos webhooks)


        **Para usuÃ¡rios que precisam de mÃºltiplos webhooks por instÃ¢ncia**:


        ðŸ’¡ **Dica**: Mesmo precisando de mÃºltiplos webhooks, considere usar
        `addUrlEvents` no modo simples.

        Um Ãºnico webhook pode receber diferentes tipos de eventos em URLs
        especÃ­ficas 

        (ex: `/webhook/message`, `/webhook/connection`), eliminando a
        necessidade de mÃºltiplos webhooks.


        1. **Criar Novo Webhook**:
           - Use `action: "add"`
           - NÃ£o inclua `id` no payload
           - O sistema gera ID automaticamente

        2. **Atualizar Webhook Existente**:
           - Use `action: "update"`
           - Inclua o `id` do webhook no payload
           - Todos os campos serÃ£o atualizados

        3. **Remover Webhook**:
           - Use `action: "delete"`
           - Inclua apenas o `id` do webhook
           - Outros campos sÃ£o ignorados



        ### Eventos DisponÃ­veis

        - `connection`: AlteraÃ§Ãµes no estado da conexÃ£o

        - `history`: Recebimento de histÃ³rico de mensagens

        - `messages`: Novas mensagens recebidas

        - `messages_update`: AtualizaÃ§Ãµes em mensagens existentes

        - `call`: Eventos de chamadas VoIP

        - `contacts`: AtualizaÃ§Ãµes na agenda de contatos

        - `presence`: AlteraÃ§Ãµes no status de presenÃ§a

        - `groups`: ModificaÃ§Ãµes em grupos

        - `labels`: Gerenciamento de etiquetas

        - `chats`: Eventos de conversas

        - `chat_labels`: AlteraÃ§Ãµes em etiquetas de conversas

        - `blocks`: Bloqueios/desbloqueios

        - `leads`: AtualizaÃ§Ãµes de leads

        - `sender`: AtualizaÃ§Ãµes de campanhas, quando inicia, e quando completa


        **Remover mensagens com base nos filtros**:

        - `wasSentByApi`: Mensagens originadas pela API âš ï¸ **IMPORTANTE:** Use
        sempre este filtro para evitar loops em automaÃ§Ãµes

        - `wasNotSentByApi`: Mensagens nÃ£o originadas pela API

        - `fromMeYes`: Mensagens enviadas pelo usuÃ¡rio

        - `fromMeNo`: Mensagens recebidas de terceiros

        - `isGroupYes`: Mensagens em grupos

        - `isGroupNo`: Mensagens em conversas individuais


        ðŸ’¡ **PrevenÃ§Ã£o de Loops**: Se vocÃª tem automaÃ§Ãµes que enviam mensagens
        via API, sempre inclua `"excludeMessages": ["wasSentByApi"]` no seu
        webhook. Caso prefira receber esses eventos, certifique-se de que sua
        automaÃ§Ã£o detecta mensagens enviadas pela prÃ³pria API para nÃ£o criar
        loops infinitos.


        **AÃ§Ãµes Suportadas**:

        - `add`: Registrar novo webhook

        - `delete`: Remover webhook existente


        **ParÃ¢metros de URL**:

        - `addUrlEvents` (boolean): Quando ativo, adiciona o tipo do evento como
        path parameter na URL.
          Exemplo: `https://api.example.com/webhook/{evento}`
        - `addUrlTypesMessages` (boolean): Quando ativo, adiciona o tipo da
        mensagem como path parameter na URL.
          Exemplo: `https://api.example.com/webhook/{tipo_mensagem}`

        **CombinaÃ§Ãµes de ParÃ¢metros**:

        - Ambos ativos:
        `https://api.example.com/webhook/{evento}/{tipo_mensagem}`
          Exemplo real: `https://api.example.com/webhook/message/conversation`
        - Apenas eventos: `https://api.example.com/webhook/message`

        - Apenas tipos: `https://api.example.com/webhook/conversation`


        **Notas TÃ©cnicas**:

        1. Os parÃ¢metros sÃ£o adicionados na ordem: evento â†’ tipo mensagem

        2. A URL deve ser configurada para aceitar esses parÃ¢metros dinÃ¢micos

        3. Funciona com qualquer combinaÃ§Ã£o de eventos/mensagens
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                id:
                  type: string
                  description: ID Ãºnico do webhook (necessÃ¡rio para update/delete)
                  example: 123e4567-e89b-12d3-a456-426614174000
                enabled:
                  type: boolean
                  description: Habilita/desabilita o webhook
                  example: true
                url:
                  type: string
                  description: URL para receber os eventos
                  example: https://example.com/webhook
                events:
                  type: array
                  description: Lista de eventos monitorados
                  items:
                    type: string
                    enum:
                      - connection
                      - history
                      - messages
                      - messages_update
                      - call
                      - contacts
                      - presence
                      - groups
                      - labels
                      - chats
                      - chat_labels
                      - blocks
                      - leads
                excludeMessages:
                  type: array
                  description: Filtros para excluir tipos de mensagens
                  items:
                    type: string
                    enum:
                      - wasSentByApi
                      - wasNotSentByApi
                      - fromMeYes
                      - fromMeNo
                      - isGroupYes
                      - isGroupNo
                addUrlEvents:
                  type: boolean
                  description: |-
                    Adiciona o tipo do evento como parÃ¢metro na URL.
                    - `false` (padrÃ£o): URL normal
                    - `true`: Adiciona evento na URL (ex: `/webhook/message`)
                  default: false
                addUrlTypesMessages:
                  type: boolean
                  description: >-
                    Adiciona o tipo da mensagem como parÃ¢metro na URL.

                    - `false` (padrÃ£o): URL normal  

                    - `true`: Adiciona tipo da mensagem (ex:
                    `/webhook/conversation`)
                  default: false
                action:
                  type: string
                  description: |-
                    AÃ§Ã£o a ser executada:
                    - add: criar novo webhook
                    - update: atualizar webhook existente (requer id)
                    - delete: remover webhook (requer apenas id)
                    Se nÃ£o informado, opera no modo simples (Ãºnico webhook)
                  enum:
                    - add
                    - update
                    - delete
              required:
                - url
            examples:
              modo_simples:
                summary: Exemplo Modo Simples (Recomendado)
                description: ConfiguraÃ§Ã£o bÃ¡sica sem complexidade
                value:
                  enabled: true
                  url: https://webhook.cool/example
                  events:
                    - messages
                    - connection
                  excludeMessages:
                    - wasSentByApi
              modo_avancado_criar:
                summary: Modo AvanÃ§ado - Criar Webhook
                description: Criar novo webhook com ID automÃ¡tico
                value:
                  action: add
                  enabled: true
                  url: https://api.exemplo.com/webhook
                  events:
                    - messages
                    - groups
                  excludeMessages:
                    - wasSentByApi
              modo_simples_com_urls:
                summary: Modo Simples com URLs DinÃ¢micas
                description: Alternativa ao modo avanÃ§ado usando addUrlEvents
                value:
                  enabled: true
                  url: https://webhook.cool/api
                  events:
                    - messages
                    - connection
                    - groups
                  excludeMessages:
                    - wasSentByApi
                  addUrlEvents: true
      responses:
        "200":
          description: Webhook configurado ou atualizado com sucesso
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: ../schemas/webhook.yaml#/Webhook
        "400":
          description: RequisiÃ§Ã£o invÃ¡lida
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Invalid action
        "401":
          description: Token invÃ¡lido ou nÃ£o fornecido
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: missing token
        "500":
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Could not save webhook
  /sse:
    get:
      tags:
        - Webhooks e SSE
      summary: Server-Sent Events (SSE)
      description: >-
        Receber eventos em tempo real via Server-Sent Events (SSE)


        ### Funcionalidades Principais:

        - ConfiguraÃ§Ã£o de URL para recebimento de eventos

        - SeleÃ§Ã£o granular de tipos de eventos

        - Filtragem avanÃ§ada de mensagens

        - ParÃ¢metros adicionais na URL

        - Gerenciamento mÃºltiplo de webhooks


        **Eventos DisponÃ­veis**:

        - `connection`: AlteraÃ§Ãµes no estado da conexÃ£o

        - `history`: Recebimento de histÃ³rico de mensagens

        - `messages`: Novas mensagens recebidas

        - `messages_update`: AtualizaÃ§Ãµes em mensagens existentes

        - `call`: Eventos de chamadas VoIP

        - `contacts`: AtualizaÃ§Ãµes na agenda de contatos

        - `presence`: AlteraÃ§Ãµes no status de presenÃ§a

        - `groups`: ModificaÃ§Ãµes em grupos

        - `labels`: Gerenciamento de etiquetas

        - `chats`: Eventos de conversas

        - `chat_labels`: AlteraÃ§Ãµes em etiquetas de conversas

        - `blocks`: Bloqueios/desbloqueios

        - `leads`: AtualizaÃ§Ãµes de leads



        Estabelece uma conexÃ£o persistente para receber eventos em tempo real.
        Este

        endpoint:


        1. Requer autenticaÃ§Ã£o via token


        2. MantÃ©m uma conexÃ£o HTTP aberta com o cliente


        3. Envia eventos conforme ocorrem no servidor


        4. Suporta diferentes tipos de eventos


        Exemplo de uso:


        ```javascript


        const eventSource = new

        EventSource('/sse?token=SEU_TOKEN&events=chats,messages');



        eventSource.onmessage = function(event) {
          const data = JSON.parse(event.data);
          console.log('Novo evento:', data);
        };



        eventSource.onerror = function(error) {
          console.error('Erro na conexÃ£o SSE:', error);
        };


        ```



        Estrutura de um evento:


        ```json


        {
          "type": "message",
          "data": {
            "id": "3EB0538DA65A59F6D8A251",
            "from": "5511999999999@s.whatsapp.net",
            "to": "5511888888888@s.whatsapp.net",
            "text": "OlÃ¡!",
            "timestamp": 1672531200000
          }
        }


        ```
      security: []
      parameters:
        - name: token
          in: query
          schema:
            type: string
          required: true
          description: Token de autenticaÃ§Ã£o da instÃ¢ncia
          example: "{{token}}"
        - name: events
          in: query
          schema:
            type: string
          required: true
          description: Tipos de eventos a serem recebidos (separados por vÃ­rgula)
          example: chats,messages
  /agent/edit:
    post:
      tags:
        - ConfiguraÃ§Ã£o do Agente de IA
      summary: Criar/Editar Agente
      description: >-
        # DocumentaÃ§Ã£o dos Campos de ConfiguraÃ§Ã£o


        ## Campos BÃ¡sicos


        ### Nome e IdentificaÃ§Ã£o


        O agente precisa ser configurado com informaÃ§Ãµes bÃ¡sicas que determinam
        sua identidade e funcionamento.


        #### Nome do Agente

        **name**: Define como o agente serÃ¡ identificado nas conversas.


        Exemplos vÃ¡lidos:

        - "Assistente de Vendas"

        - "Suporte TÃ©cnico" 

        - "JoÃ£o"

        - "Maria"


        #### Provedor do ServiÃ§o

        **provider**: Especifica qual serviÃ§o de IA serÃ¡ utilizado.


        Provedores disponÃ­veis:

        - "openai" (ChatGPT)

        - "anthropic" (Claude)

        - "gemini" (Google)

        - "deepseek" (DeepSeek)


        #### Chave de API

        **apikey**: Credencial necessÃ¡ria para autenticaÃ§Ã£o com o provedor
        escolhido.

        - Deve ser obtida atravÃ©s do site oficial do provedor selecionado

        - Mantenha esta chave em seguranÃ§a e nunca a compartilhe


        ### ConfiguraÃ§Ã£o do Modelo


        #### SeleÃ§Ã£o do Modelo

        **model**: Especifica qual modelo de IA serÃ¡ utilizado. A
        disponibilidade depende do provedor selecionado.


        ##### OpenAI

        DocumentaÃ§Ã£o: https://platform.openai.com/docs/models

        - gpt-4o

        - gpt-4o-mini

        - gpt-3.5-turbo


        ##### Claude

        DocumentaÃ§Ã£o: https://docs.anthropic.com/en/docs/about-claude/models

        - claude-3-5-sonnet-latest

        - claude-3-5-haiku-latest

        - claude-3-opus-latest


        ##### Gemini

        DocumentaÃ§Ã£o: https://ai.google.dev/models/gemini

        - gemini-2.0-flash-exp

        - gemini-1.5-pro

        - gemini-1.5-flash


        ##### DeepSeek

        DocumentaÃ§Ã£o: https://api-docs.deepseek.com/quick_start/pricing

        - deepseek-chat

        - deepseek-reasoner

                

        ## ConfiguraÃ§Ãµes de Comportamento



        ### Prompt Base (**basePrompt**)



        InstruÃ§Ãµes iniciais para definir o comportamento do agente
            
        Exemplo para assistente de vendas:


        "VocÃª Ã© um assistente especializado em vendas, focado em ajudar clientes
        a encontrar os produtos ideais. Mantenha um tom profissional e
        amigÃ¡vel."
                
        Exemplo para suporte:


        "VocÃª Ã© um agente de suporte tÃ©cnico especializado em nossos produtos.
        ForneÃ§a respostas claras e objetivas para ajudar os clientes a
        resolverem seus problemas."

                

        ### ParÃ¢metros de GeraÃ§Ã£o



        - **temperature**: Controla a criatividade das respostas (0-100)
            
            - 0-30: Respostas mais conservadoras e precisas
                
            - 30-70: EquilÃ­brio entre criatividade e precisÃ£o
                
            - 70-100: Respostas mais criativas e variadas


                
        - **maxTokens**: Limite mÃ¡ximo de tokens por resposta
            
            - Recomendado: 1000-4000 para respostas detalhadas
                
            - Para respostas curtas: 500-1000
                
            - Limite mÃ¡ximo varia por modelo


                
        - **diversityLevel**: Controla a diversidade das respostas (0-100)
            
            - Valores mais altos geram respostas mais variadas
                
            - Recomendado: 30-70 para uso geral


                
        - **frequencyPenalty**: Penalidade para repetiÃ§Ã£o de palavras (0-100)
            
            - Valores mais altos reduzem repetiÃ§Ãµes
                
            - Recomendado: 20-50 para comunicaÃ§Ã£o natural


                
        - **presencePenalty**: Penalidade para manter foco no tÃ³pico (0-100)
            
            - Valores mais altos incentivam mudanÃ§as de tÃ³pico
                
            - Recomendado: 10-30 para manter coerÃªncia


                

        ## ConfiguraÃ§Ãµes de InteraÃ§Ã£o



        ### Mensagens



        - **signMessages**: Se verdadeiro, adiciona a assinatura do agente nas
        mensagens
            
            - Ãštil para identificar quem estÃ¡ enviando a mensagem


                
        - **readMessages**: Se verdadeiro, marca as mensagens como lidas ao
        responder
            
            - Recomendado para simular comportamento humano


                

        ## Exemplos de ConfiguraÃ§Ã£o



        ### Assistente de Vendas



        ``` json


        {
          "name": "Assistente de Vendas",
          "provider": "openai",
          "model": "gpt-4",
          "basePrompt": "VocÃª Ã© um assistente de vendas especializado...",
          "temperature": 70,
          "maxTokens": 2000,
          "diversityLevel": 50,
          "frequencyPenalty": 30,
          "presencePenalty": 20,
          "signMessages": true,
          "readMessages": true
        }

          ```

        ### Suporte TÃ©cnico



        ``` json


        {
          "name": "Suporte TÃ©cnico",
          "provider": "anthropic",
          "model": "claude-3-sonnet-20240229",
          "basePrompt": "VocÃª Ã© um agente de suporte tÃ©cnico...",
          "temperature": 30,
          "maxTokens": 3000,
          "diversityLevel": 40,
          "frequencyPenalty": 40,
          "presencePenalty": 15,
          "signMessages": true,
          "readMessages": true
        }

          ```

        ## Dicas de OtimizaÃ§Ã£o



        1. **Ajuste Gradual**: Comece com valores moderados e ajuste conforme
        necessÃ¡rio
            
        2. **Teste o Base Prompt**: Verifique se as instruÃ§Ãµes estÃ£o claras e
        completas
            
        3. **Monitore o Desempenho**: Observe as respostas e ajuste os
        parÃ¢metros para melhor adequaÃ§Ã£o
            
        4. **Backup**: Mantenha um backup das configuraÃ§Ãµes que funcionaram bem
            
        5. **DocumentaÃ§Ã£o**: Registre as alteraÃ§Ãµes e seus impactos para
        referÃªncia futura
      requestBody:
        content:
          application/json:
            schema:
              type: object
              example:
                id: ""
                delete: false
                agent:
                  name: zaptosbot
                  provider: openai
                  apikey: sk-proj-HfXFgA
                  basePrompt: Seu nome Ã© Sara e vocÃª faz parte do time de suporte ao cliente da
                    TechShop...
                  model: gpt-4o-mini
                  maxTokens: 2000
                  temperature: 70
                  diversityLevel: 50
                  frequencyPenalty: 30
                  presencePenalty: 30
                  signMessages: true
                  readMessages: true
                  maxMessageLength: 500
                  typingDelay_seconds: 3
                  contextTimeWindow_hours: 24
                  contextMaxMessages: 50
                  contextMinMessages: 3
      responses:
        "200":
          description: Agente atualizado com sucesso
          content:
            application/json:
              schema:
                $ref: ../schemas/chatbot_ai_agent.yaml#/ChatbotAIAgent
        "201":
          description: Novo agente criado com sucesso
          content:
            application/json:
              schema:
                $ref: ../schemas/chatbot_ai_agent.yaml#/ChatbotAIAgent
        "400":
          description: Erro na requisiÃ§Ã£o
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Missing required fields
        "401":
          description: NÃ£o autorizado
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: No session
        "404":
          description: Agente nÃ£o encontrado
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Agent not found
        "500":
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Failed to create agent
  /agent/list:
    get:
      tags:
        - ConfiguraÃ§Ã£o do Agente de IA
      summary: Todos os agentes
      parameters: []
      responses:
        "200":
          description: Lista de todos os agentes de IA
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: ../schemas/chatbot_ai_agent.yaml#/ChatbotAIAgent
        "401":
          description: SessÃ£o nÃ£o encontrada
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: No session
        "500":
          description: Erro ao buscar agentes
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Failed to fetch agents
  /sender/simple:
    post:
      tags:
        - Mensagem em massa
      summary: Criar nova campanha (Simples)
      description: Cria uma nova campanha de envio com configuraÃ§Ãµes bÃ¡sicas
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - numbers
                - type
                - folder
                - delayMin
                - delayMax
                - scheduled_for
              properties:
                numbers:
                  type: array
                  description: Lista de nÃºmeros para envio
                  items:
                    type: string
                  example:
                    - 5511999999999@s.whatsapp.net
                type:
                  type: string
                  description: Tipo da mensagem
                  enum:
                    - text
                    - image
                    - video
                    - audio
                    - document
                    - contact
                    - location
                    - list
                    - button
                    - poll
                    - carousel
                delayMin:
                  type: integer
                  description: Delay mÃ­nimo entre mensagens em segundos
                  minimum: 1
                  example: 10
                delayMax:
                  type: integer
                  description: Delay mÃ¡ximo entre mensagens em segundos
                  minimum: 1
                  example: 30
                scheduled_for:
                  type: integer
                  description: Timestamp em milissegundos ou minutos a partir de agora para
                    agendamento
                  example: 1706198400000
                info:
                  type: string
                  description: InformaÃ§Ãµes adicionais sobre a campanha
                delay:
                  type: integer
                  description: Delay fixo entre mensagens (opcional)
                mentions:
                  type: string
                  description: MenÃ§Ãµes na mensagem em formato JSON
                text:
                  type: string
                  description: Texto da mensagem
                linkPreview:
                  type: boolean
                  description: Habilitar preview de links em mensagens de texto. O preview serÃ¡
                    gerado automaticamente a partir da URL contida no texto.
                linkPreviewTitle:
                  type: string
                  description: TÃ­tulo personalizado para o preview do link (opcional)
                linkPreviewDescription:
                  type: string
                  description: DescriÃ§Ã£o personalizada para o preview do link (opcional)
                linkPreviewImage:
                  type: string
                  description: URL ou dados base64 da imagem para o preview do link (opcional)
                linkPreviewLarge:
                  type: boolean
                  description: Se deve usar preview grande ou pequeno (opcional, padrÃ£o false)
                file:
                  type: string
                  description: URL da mÃ­dia ou arquivo (quando type Ã© image, video, audio,
                    document, etc.)
                docName:
                  type: string
                  description: Nome do arquivo (quando type Ã© document)
                fullName:
                  type: string
                  description: Nome completo (quando type Ã© contact)
                phoneNumber:
                  type: string
                  description: NÃºmero do telefone (quando type Ã© contact)
                organization:
                  type: string
                  description: OrganizaÃ§Ã£o (quando type Ã© contact)
                email:
                  type: string
                  description: Email (quando type Ã© contact)
                url:
                  type: string
                  description: URL (quando type Ã© contact)
                latitude:
                  type: number
                  description: Latitude (quando type Ã© location)
                longitude:
                  type: number
                  description: Longitude (quando type Ã© location)
                name:
                  type: string
                  description: Nome do local (quando type Ã© location)
                address:
                  type: string
                  description: EndereÃ§o (quando type Ã© location)
                footerText:
                  type: string
                  description: Texto do rodapÃ© (quando type Ã© list, button, poll ou carousel)
                buttonText:
                  type: string
                  description: Texto do botÃ£o (quando type Ã© list, button, poll ou carousel)
                listButton:
                  type: string
                  description: Texto do botÃ£o da lista (quando type Ã© list)
                selectableCount:
                  type: integer
                  description: Quantidade de opÃ§Ãµes selecionÃ¡veis (quando type Ã© poll)
                choices:
                  type: array
                  items:
                    type: string
                  description: Lista de opÃ§Ãµes (quando type Ã© list, button, poll ou carousel).
                    Para carousel, use formato especÃ­fico com [texto], {imagem}
                    e botÃµes
                imageButton:
                  type: string
                  description: URL da imagem para o botÃ£o (quando type Ã© button)
      responses:
        "200":
          description: campanha criada com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  folder_id:
                    type: string
                    description: ID Ãºnico da campanha criada
                  count:
                    type: integer
                    description: Quantidade de mensagens agendadas
                  status:
                    type: string
                    description: Status da operaÃ§Ã£o
                    example: queued
        "400":
          description: Erro nos parÃ¢metros da requisiÃ§Ã£o
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
        "401":
          description: Erro de autenticaÃ§Ã£o
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
        "409":
          description: Conflito - campanha jÃ¡ existe
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
        "500":
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
  /sender/advanced:
    post:
      tags:
        - Mensagem em massa
      summary: Criar envio em massa avanÃ§ado
      description: >-
        Cria um novo envio em massa com configuraÃ§Ãµes avanÃ§adas, permitindo
        definir

        mÃºltiplos destinatÃ¡rios e mensagens com delays personalizados.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                delayMin:
                  type: integer
                  description: Delay mÃ­nimo entre mensagens (segundos)
                  minimum: 0
                  example: 3
                delayMax:
                  type: integer
                  description: Delay mÃ¡ximo entre mensagens (segundos)
                  minimum: 0
                  example: 6
                info:
                  type: string
                  description: DescriÃ§Ã£o ou informaÃ§Ã£o sobre o envio em massa
                  example: Campanha de lanÃ§amento
                scheduled_for:
                  type: integer
                  description: Timestamp em milissegundos (date unix) ou minutos a partir de agora
                    para agendamento
                  example: 1
                messages:
                  type: array
                  description: Lista de mensagens a serem enviadas
                  items:
                    type: object
                    required:
                      - number
                      - type
                    properties:
                      number:
                        type: string
                        description: ID do chat ou nÃºmero do destinatÃ¡rio.
                        example: "5511999999999"
                      type:
                        type: string
                        enum:
                          - text
                          - image
                          - document
                          - audio
                          - ptt
                          - myaudio
                          - sticker
                          - video
                          - contact
                          - location
                          - poll
                          - list
                          - button
                          - carousel
                        description: |-
                          Tipo da mensagem:
                          - text: Mensagem de texto
                          - image: Imagem
                          - document: Documento/arquivo
                          - audio: Ãudio
                          - ptt: Mensagem de voz
                          - myaudio: Ãudio (opÃ§Ã£o alternativa)
                          - sticker: Figurinha
                          - video: VÃ­deo
                          - contact: Contato
                          - location: LocalizaÃ§Ã£o
                          - poll: Enquete
                          - list: Lista de opÃ§Ãµes
                          - button: BotÃµes interativos
                          - carousel: Carrossel de cartÃµes com imagens e botÃµes
                      text:
                        type: string
                        description: Texto da mensagem (quando type Ã© "text") ou legenda para mÃ­dia
                      file:
                        type: string
                        description: URL da mÃ­dia (quando type Ã© image, video, audio, document, etc)
                      docName:
                        type: string
                        description: Nome do arquivo (quando type Ã© document)
                      linkPreview:
                        type: boolean
                        description: Se deve gerar preview de links (quando type Ã© text). O preview serÃ¡
                          gerado automaticamente a partir da URL contida no
                          texto.
                      linkPreviewTitle:
                        type: string
                        description: TÃ­tulo personalizado para o preview do link (opcional)
                      linkPreviewDescription:
                        type: string
                        description: DescriÃ§Ã£o personalizada para o preview do link (opcional)
                      linkPreviewImage:
                        type: string
                        description: URL ou dados base64 da imagem para o preview do link (opcional)
                      linkPreviewLarge:
                        type: boolean
                        description: Se deve usar preview grande ou pequeno (opcional, padrÃ£o false)
                      fullName:
                        type: string
                        description: Nome completo (quando type Ã© contact)
                      phoneNumber:
                        type: string
                        description: NÃºmero do telefone (quando type Ã© contact)
                      organization:
                        type: string
                        description: OrganizaÃ§Ã£o (quando type Ã© contact)
                      email:
                        type: string
                        description: Email (quando type Ã© contact)
                      url:
                        type: string
                        description: URL (quando type Ã© contact)
                      latitude:
                        type: number
                        description: Latitude (quando type Ã© location)
                      longitude:
                        type: number
                        description: Longitude (quando type Ã© location)
                      name:
                        type: string
                        description: Nome do local (quando type Ã© location)
                      address:
                        type: string
                        description: EndereÃ§o (quando type Ã© location)
                      footerText:
                        type: string
                        description: Texto do rodapÃ© (quando type Ã© list, button, poll ou carousel)
                      buttonText:
                        type: string
                        description: Texto do botÃ£o (quando type Ã© list, button, poll ou carousel)
                      listButton:
                        type: string
                        description: Texto do botÃ£o da lista (quando type Ã© list)
                      selectableCount:
                        type: integer
                        description: Quantidade de opÃ§Ãµes selecionÃ¡veis (quando type Ã© poll)
                      choices:
                        type: array
                        items:
                          type: string
                        description: Lista de opÃ§Ãµes (quando type Ã© list, button, poll ou carousel).
                          Para carousel, use formato especÃ­fico com [texto],
                          {imagem} e botÃµes
                      imageButton:
                        type: string
                        description: URL da imagem para o botÃ£o (quando type Ã© button)
              required:
                - messages
              example:
                delayMin: 3
                delayMax: 6
                info: teste avanÃ§ado
                scheduled_for: 1
                messages:
                  - number: "5511999999999"
                    type: text
                    text: First message
                  - number: "5511999999999"
                    type: button
                    text: |-
                      PromoÃ§Ã£o Especial!
                      Confira nossas ofertas incrÃ­veis
                    footerText: VÃ¡lido atÃ© 31/12/2024
                    imageButton: https://exemplo.com/banner-promocao.jpg
                    choices:
                      - Ver Ofertas|https://loja.exemplo.com/ofertas
                      - Falar com Vendedor|reply:vendedor
                      - Copiar Cupom|copy:PROMO2024
                  - number: "5511999999999"
                    type: list
                    text: "Escolha sua categoria preferida:"
                    listButton: Ver Categorias
                    choices:
                      - "[EletrÃ´nicos]"
                      - Smartphones|eletronicos_smartphones
                      - Notebooks|eletronicos_notebooks
                      - "[Roupas]"
                      - Camisetas|roupas_camisetas
                      - Sapatos|roupas_sapatos
                  - number: "5511999999999"
                    type: document
                    file: https://example.com/doc.pdf
                    docName: Documento.pdf
                  - number: "5511999999999"
                    type: carousel
                    text: ConheÃ§a nossos produtos
                    choices:
                      - |-
                        [Smartphone XYZ
                        O mais avanÃ§ado smartphone da linha]
                      - "{https://exemplo.com/produto1.jpg}"
                      - Copiar CÃ³digo|copy:PROD123
                      - Ver no Site|https://exemplo.com/xyz
                      - |-
                        [Notebook ABC
                        O notebook ideal para profissionais]
                      - "{https://exemplo.com/produto2.jpg}"
                      - Copiar CÃ³digo|copy:NOTE456
                      - Comprar Online|https://exemplo.com/abc
      responses:
        "200":
          description: Mensagens adicionadas Ã  fila com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  folder_id:
                    type: string
                    description: ID da pasta/lote criado
                  count:
                    type: integer
                    description: Total de mensagens adicionadas Ã  fila
                  status:
                    type: string
                    description: Status da operaÃ§Ã£o
                    example: queued
        "400":
          description: Erro nos parÃ¢metros da requisiÃ§Ã£o
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: DescriÃ§Ã£o do erro
                    example: Formato de nÃºmero invÃ¡lido
        "401":
          description: NÃ£o autorizado - token invÃ¡lido ou ausente
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Mensagem de erro
                    example: Token invÃ¡lido ou ausente
        "500":
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Detalhes do erro interno
  /sender/edit:
    post:
      tags:
        - Mensagem em massa
      summary: Controlar campanha de envio em massa
      description: >-
        Permite controlar campanhas de envio de mensagens em massa atravÃ©s de
        diferentes aÃ§Ãµes:


        ## AÃ§Ãµes DisponÃ­veis:


        **ðŸ›‘ stop** - Pausar campanha

        - Pausa uma campanha ativa ou agendada

        - Altera o status para "paused" 

        - Use quando quiser interromper temporariamente o envio

        - Mensagens jÃ¡ enviadas nÃ£o sÃ£o afetadas


        **â–¶ï¸ continue** - Continuar campanha  

        - Retoma uma campanha pausada

        - Altera o status para "scheduled"

        - Use para continuar o envio apÃ³s pausar uma campanha

        - NÃ£o funciona em campanhas jÃ¡ concluÃ­das ("done")


        **ðŸ—‘ï¸ delete** - Deletar campanha

        - Remove completamente a campanha

        - Deleta apenas mensagens NÃƒO ENVIADAS (status "scheduled")

        - Mensagens jÃ¡ enviadas sÃ£o preservadas no histÃ³rico

        - OperaÃ§Ã£o Ã© executada de forma assÃ­ncrona


        ## Status de Campanhas:

        - **scheduled**: Agendada para envio

        - **sending**: Enviando mensagens  

        - **paused**: Pausada pelo usuÃ¡rio

        - **done**: ConcluÃ­da (nÃ£o pode ser alterada)

        - **deleting**: Sendo deletada (operaÃ§Ã£o em andamento)
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                folder_id:
                  type: string
                  description: Identificador Ãºnico da campanha de envio
                  example: folder_123
                action:
                  type: string
                  enum:
                    - stop
                    - continue
                    - delete
                  description: >-
                    AÃ§Ã£o a ser executada na campanha:

                    - **stop**: Pausa a campanha (muda para status "paused")

                    - **continue**: Retoma campanha pausada (muda para status
                    "scheduled") 

                    - **delete**: Remove campanha e mensagens nÃ£o enviadas
                    (assÃ­ncrono)
                  example: stop
              required:
                - folder_id
                - action
      responses:
        "200":
          description: AÃ§Ã£o realizada com sucesso
          content:
            application/json:
              schema:
                oneOf:
                  - type: object
                    title: Resposta para aÃ§Ã£o 'stop'
                    properties:
                      status:
                        type: string
                        enum:
                          - paused
                        description: Status da campanha apÃ³s pausar
                        example: paused
                  - type: object
                    title: Resposta para aÃ§Ã£o 'continue'
                    properties:
                      status:
                        type: string
                        enum:
                          - scheduled
                        description: Status da campanha apÃ³s retomar
                        example: scheduled
                      message:
                        type: string
                        description: Mensagem de confirmaÃ§Ã£o
                        example: Folder resumed successfully
                  - type: object
                    title: Resposta para aÃ§Ã£o 'delete'
                    properties:
                      status:
                        type: string
                        enum:
                          - deleting
                        description: Status indicando que a deleÃ§Ã£o foi iniciada
                        example: deleting
                      message:
                        type: string
                        description: Mensagem informando que a deleÃ§Ã£o Ã© assÃ­ncrona
                        example: Folder deletion has been initiated
        "400":
          description: RequisiÃ§Ã£o invÃ¡lida
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: folder_id is required
  /sender/cleardone:
    post:
      tags:
        - Mensagem em massa
      summary: Limpar mensagens enviadas
      description: Inicia processo de limpeza de mensagens antigas em lote que jÃ¡
        foram enviadas com sucesso. Por padrÃ£o, remove mensagens mais antigas
        que 7 dias.
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                hours:
                  type: integer
                  description: Quantidade de horas para manter mensagens. Mensagens mais antigas
                    que esse valor serÃ£o removidas.
                  example: 168
                  default: 168
      responses:
        "200":
          description: Limpeza iniciada com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    description: Status da operaÃ§Ã£o
                    example: cleanup started
  /sender/clearall:
    delete:
      tags:
        - Mensagem em massa
      summary: Limpar toda fila de mensagens
      description: >-
        Remove todas as mensagens da fila de envio em massa, incluindo mensagens
        pendentes e jÃ¡ enviadas.

        Esta Ã© uma operaÃ§Ã£o irreversÃ­vel.
      responses:
        "200":
          description: Fila de mensagens limpa com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  info:
                    type: string
                    description: Mensagem de confirmaÃ§Ã£o
                    example: Fila de mensagens limpa com sucesso
        "401":
          description: NÃ£o autorizado - token invÃ¡lido ou ausente
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Mensagem de erro
                    example: Token invÃ¡lido ou ausente
        "500":
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Detalhes do erro interno
  /sender/listfolders:
    get:
      tags:
        - Mensagem em massa
      summary: Listar campanhas de envio
      description: Retorna todas as campanhas de mensagens em massa com possibilidade
        de filtro por status
      security: []
      parameters:
        - in: query
          name: status
          schema:
            type: string
            enum:
              - Active
              - Archived
          description: Filtrar campanhas por status
      responses:
        "200":
          description: Lista de campanhas retornada com sucesso
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: ../schemas/message_queue_folder.yaml#/MessageQueueFolder
        "500":
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
  /sender/listmessages:
    post:
      tags:
        - Mensagem em massa
      summary: Listar mensagens de uma campanha
      description: Retorna a lista de mensagens de uma campanha especÃ­fica, com opÃ§Ãµes
        de filtro por status e paginaÃ§Ã£o
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                folder_id:
                  type: string
                  description: ID da campanha a ser consultada
                messageStatus:
                  type: string
                  enum:
                    - Scheduled
                    - Sent
                    - Failed
                  description: Status das mensagens para filtrar
                page:
                  type: integer
                  minimum: 1
                  default: 1
                  description: NÃºmero da pÃ¡gina para paginaÃ§Ã£o
                pageSize:
                  type: integer
                  minimum: 1
                  maximum: 1000
                  default: 1000
                  description: Quantidade de itens por pÃ¡gina
              required:
                - folder_id
      responses:
        "200":
          description: Lista de mensagens retornada com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  messages:
                    type: array
                    items:
                      $ref: ../schemas/message.yaml#/Message
                  pagination:
                    type: object
                    properties:
                      total:
                        type: integer
                        description: Total de mensagens encontradas
                      page:
                        type: integer
                        description: PÃ¡gina atual
                      pageSize:
                        type: integer
                        description: Itens por pÃ¡gina
                      lastPage:
                        type: integer
                        description: NÃºmero da Ãºltima pÃ¡gina
        "400":
          description: RequisiÃ§Ã£o invÃ¡lida
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: folder_id is required
        "500":
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Failed to fetch messages
    components:
      schemas:
        MessageQueue:
          $ref: ../schemas/message.yaml#/Message
  /trigger/edit:
    post:
      tags:
        - Chatbot Trigger
      summary: Criar, atualizar ou excluir um trigger do chatbot
      description: |-
        Endpoint para gerenciar triggers do chatbot. Suporta:
        - CriaÃ§Ã£o de novos triggers
        - AtualizaÃ§Ã£o de triggers existentes
        - ExclusÃ£o de triggers por ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - trigger
              properties:
                id:
                  type: string
                  description: ID do trigger. Vazio para criaÃ§Ã£o, obrigatÃ³rio para
                    atualizaÃ§Ã£o/exclusÃ£o
                delete:
                  type: boolean
                  description: Quando verdadeiro, exclui o trigger especificado pelo id
                  default: false
                trigger:
                  $ref: ../schemas/chatbot_trigger.yaml#/ChatbotTrigger
            examples:
              create:
                summary: Criar novo trigger
                value:
                  id: ""
                  delete: false
                  trigger:
                    active: true
                    type: agent
                    agent_id: ref2ed7ab21d4ea
                    ignoreGroups: true
                    lead_field: lead_status
                    lead_operator: equals
                    lead_value: novo
                    priority: 1
                    wordsToStart: ola|oi|iniciar
                    responseDelay_seconds: 6
              update:
                summary: Atualizar trigger existente
                value:
                  id: r7ab21d4
                  delete: false
                  trigger:
                    active: false
                    type: agent
                    agent_id: ref2ed7ab21d4ea
              delete:
                summary: Excluir trigger
                value:
                  id: r7ab21d4
                  delete: true
      responses:
        "200":
          description: Trigger atualizado com sucesso
          content:
            application/json:
              schema:
                $ref: ../schemas/chatbot_trigger.yaml#/ChatbotTrigger
        "201":
          description: Trigger criado com sucesso
          content:
            application/json:
              schema:
                $ref: ../schemas/chatbot_trigger.yaml#/ChatbotTrigger
        "400":
          description: Corpo da requisiÃ§Ã£o invÃ¡lido ou campos obrigatÃ³rios ausentes
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
        "404":
          description: Trigger nÃ£o encontrado
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
        "500":
          description: Erro no servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
  /trigger/list:
    get:
      tags:
        - Chatbot Trigger
      summary: Listar todos os triggers do chatbot
      description: Retorna a lista completa de triggers configurados para a instÃ¢ncia atual
      parameters: []
      responses:
        "200":
          description: Lista de triggers retornada com sucesso
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: ../schemas/chatbot_trigger.yaml#/ChatbotTrigger
        "401":
          description: NÃ£o autorizado
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: No session
        "500":
          description: Erro no servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Failed to fetch triggers
  /knowledge/edit:
    post:
      tags:
        - Conhecimento dos Agentes
      summary: Criar/Editar Conhecimento do Agente
      description: >-
        Gerencia o conhecimento base usado pelos agentes de IA para responder
        consultas.

        O conhecimento pode ser fornecido como texto direto ou atravÃ©s de
        arquivos PDF/CSV.


        CaracterÃ­sticas principais:

        - Suporta criaÃ§Ã£o, ediÃ§Ã£o e exclusÃ£o de conhecimento

        - Aceita conteÃºdo em:
          - Texto puro
          - URLs pÃºblicas
          - Base64 encoded de arquivos
          - Upload direto de arquivos
        - Formatos suportados: PDF, CSV, TXT, HTML

        - Processa automaticamente qualquer formato de entrada

        - Vetoriza automaticamente o conteÃºdo para busca semÃ¢ntica


        Nota sobre URLs e Base64:

        - URLs devem ser pÃºblicas e acessÃ­veis

        - Para PDFs/CSVs, especifique fileType se nÃ£o for detectÃ¡vel da extensÃ£o

        - Base64 deve incluir o encoding completo do arquivo

        - O servidor detecta e processa automaticamente conteÃºdo Base64
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                id:
                  type: string
                  description: ID do conhecimento (vazio para criar novo)
                delete:
                  type: boolean
                  description: Define se Ã© uma operaÃ§Ã£o de exclusÃ£o
                knowledge:
                  type: object
                  properties:
                    isActive:
                      type: boolean
                      description: Status de ativaÃ§Ã£o do conhecimento
                    tittle:
                      type: string
                      description: TÃ­tulo identificador do conhecimento
                    content:
                      type: string
                      description: ConteÃºdo textual, URL ou Base64
                fileType:
                  type: string
                  enum:
                    - pdf
                    - txt
                    - html
                    - csv
                  description: Tipo do arquivo quando nÃ£o detectado automaticamente
              example:
                id: ""
                delete: false
                knowledge:
                  isActive: true
                  tittle: InformaÃ§Ãµes sobre a zaptoswpp
                  content: A zaptoswpp foi originalmente desenvolvida...
      responses:
        "200":
          description: Conhecimento atualizado com sucesso
          content:
            application/json:
              schema:
                $ref: ../schemas/chatbot_ai_knowledge.yaml#/ChatbotAIKnowledge
        "201":
          description: Novo conhecimento criado com sucesso
          content:
            application/json:
              schema:
                $ref: ../schemas/chatbot_ai_knowledge.yaml#/ChatbotAIKnowledge
        "400":
          description: RequisiÃ§Ã£o invÃ¡lida
        "404":
          description: Conhecimento nÃ£o encontrado
        "500":
          description: Erro interno do servidor
  /knowledge/list:
    get:
      tags:
        - Conhecimento dos Agentes
      summary: Listar Base de Conhecimento
      description: >-
        Retorna todos os conhecimentos cadastrados para o agente de IA da
        instÃ¢ncia.

        Estes conhecimentos sÃ£o utilizados pelo chatbot para responder perguntas

        e interagir com os usuÃ¡rios de forma contextualizada.
      parameters: []
      responses:
        "200":
          description: Lista de conhecimentos recuperada com sucesso
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: ../schemas/chatbot_ai_knowledge.yaml#/ChatbotAIKnowledge
        "401":
          description: Token de autenticaÃ§Ã£o ausente ou invÃ¡lido
        "500":
          description: Erro interno do servidor ao buscar conhecimentos
  /function/edit:
    post:
      tags:
        - FunÃ§Ãµes API dos Agentes
      summary: Criar/Editar funÃ§Ã£o para integraÃ§Ã£o com APIs externas
      description: >-
        # ConfiguraÃ§Ã£o de FunÃ§Ãµes de API para Agentes IA


        DocumentaÃ§Ã£o para criar/editar funÃ§Ãµes utilizadas pelos agentes de IA
        para integraÃ§Ã£o com APIs externas. Inclui validaÃ§Ã£o automÃ¡tica e
        controle de ativaÃ§Ã£o.


        ## 1. Estrutura Base da FunÃ§Ã£o


        ### Campos Principais

        ```json

        {
          "name": "nomeDaFuncao",
          "description": "DescriÃ§Ã£o detalhada",
          "isActive": true,
          "method": "POST",
          "endpoint": "https://api.exemplo.com/recurso",
          "headers": {},
          "body": {},
          "parameters": []
        }

        ```


        ### Detalhamento dos Campos


        #### `name`

        - Identificador Ãºnico e descritivo

        - Sem espaÃ§os ou caracteres especiais

        - Ex: "createProduct", "updateUserStatus"


        #### `description`

        - PropÃ³sito e funcionamento da funÃ§Ã£o

        - Inclua casos de uso e resultados esperados

        - Ex: "Cria produto no catÃ¡logo com nome, preÃ§o e categoria"


        #### `isActive`

        - Controla disponibilidade da funÃ§Ã£o

        - Desativa automaticamente se houver erros

        - Default: false


        #### `method`

        - GET: buscar dados

        - POST: criar recurso

        - PUT: atualizar completo

        - PATCH: atualizaÃ§Ã£o parcial

        - DELETE: remover recurso


        #### `endpoint`

        - URL completa da API

        - Aceita placeholders: {{variavel}}

        - Exemplos:
          ```
          https://api.exemplo.com/produtos
          https://api.exemplo.com/usuarios/{{userId}}
          https://api.exemplo.com/busca?q={{query}}&limit={{limit}}
          ```

        #### `headers`

        ```json

        {
          "Authorization": "Bearer {{apiKey}}",
          "Content-Type": "application/json",
          "Accept": "application/json"
        }

        ```


        #### `body` (POST/PUT/PATCH)

        ```json

        {
          "name": "{{productName}}",
          "price": "{{price}}",
          "metadata": {
            "tags": "{{tags}}"
          }
        }

        ```


        ## 2. ConfiguraÃ§Ã£o de ParÃ¢metros


        ### Estrutura do ParÃ¢metro

        ```json

        {
          "name": "nomeParametro",
          "type": "string",
          "description": "DescriÃ§Ã£o do uso",
          "required": true,
          "enum": "valor1,valor2,valor3",
          "minimum": 0,
          "maximum": 100
        }

        ```


        ### Tipos de ParÃ¢metros


        #### String

        ```json

        {
          "name": "status",
          "type": "string",
          "description": "Status do pedido",
          "required": true,
          "enum": "pending,processing,completed"
        }

        ```


        #### NÃºmero

        ```json

        {
          "name": "price",
          "type": "number",
          "description": "PreÃ§o em reais",
          "required": true,
          "minimum": 0.01,
          "maximum": 99999.99
        }

        ```


        #### Inteiro

        ```json

        {
          "name": "quantity",
          "type": "integer",
          "description": "Quantidade",
          "minimum": 0,
          "maximum": 1000
        }

        ```


        #### Boolean

        ```json

        {
          "name": "active",
          "type": "boolean",
          "description": "Status de ativaÃ§Ã£o"
        }

        ```


        ## 3. Sistema de ValidaÃ§Ã£o


        ### ValidaÃ§Ãµes AutomÃ¡ticas

        1. JSON
          - Headers e body devem ser vÃ¡lidos
          - Erros desativam a funÃ§Ã£o

        2. Placeholders ({{variavel}})
          - Case-sensitive
          - Devem ter parÃ¢metro correspondente

        3. ParÃ¢metros
          - Nomes Ãºnicos
          - Tipos corretos
          - Limites numÃ©ricos vÃ¡lidos
          - Enums sem valores vazios

        ### Erros e Avisos

        - FunÃ§Ã£o desativa se houver:
          - JSON invÃ¡lido
          - ParÃ¢metros nÃ£o documentados
          - ViolaÃ§Ãµes de tipo
        - Erros aparecem em `undocumentedParameters`


        ## 4. Exemplo Completo


        ```json

        {
          "name": "createProduct",
          "description": "Criar novo produto no catÃ¡logo",
          "isActive": true,
          "method": "POST",
          "endpoint": "https://api.store.com/v1/products",
          "headers": {
            "Authorization": "Bearer {{apiKey}}",
            "Content-Type": "application/json"
          },
          "body": {
            "name": "{{productName}}",
            "price": "{{price}}",
            "category": "{{category}}"
          },
          "parameters": [
            {
              "name": "apiKey",
              "type": "string",
              "description": "Chave de API",
              "required": true
            },
            {
              "name": "productName",
              "type": "string",
              "description": "Nome do produto",
              "required": true
            },
            {
              "name": "price",
              "type": "number",
              "description": "PreÃ§o em reais",
              "required": true,
              "minimum": 0.01
            },
            {
              "name": "category",
              "type": "string",
              "description": "Categoria do produto",
              "required": true,
              "enum": "electronics,clothing,books"
            }
          ]
        }

        ```
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - id
                - delete
                - function
              properties:
                id:
                  type: string
                  description: ID da funÃ§Ã£o. Vazio para criar nova, preenchido para editar
                    existente.
                delete:
                  type: boolean
                  description: Se true, deleta a funÃ§Ã£o especificada pelo ID.
                function:
                  type: object
                  required:
                    - name
                    - description
                    - method
                    - endpoint
                  properties:
                    name:
                      type: string
                      description: Nome da funÃ§Ã£o
                      example: createProduct
                    isActive:
                      type: boolean
                      description: Status de ativaÃ§Ã£o da funÃ§Ã£o
                      default: false
                    description:
                      type: string
                      description: DescriÃ§Ã£o detalhada da funÃ§Ã£o e seu propÃ³sito
                      example: Cria um novo produto no catÃ¡logo
                    method:
                      type: string
                      description: MÃ©todo HTTP da requisiÃ§Ã£o
                      enum:
                        - GET
                        - POST
                        - PUT
                        - DELETE
                        - PATCH
                      example: POST
                    endpoint:
                      type: string
                      description: URL do endpoint da API
                      example: https://api.example.com/products
                    headers:
                      type: object
                      description: CabeÃ§alhos da requisiÃ§Ã£o. Suporta placeholders no formato
                        {{variavel}}
                      example:
                        Authorization: Bearer {{apiKey}}
                        Content-Type: application/json
                    body:
                      type: object
                      description: Corpo da requisiÃ§Ã£o. Suporta placeholders no formato {{variavel}}
                      example:
                        name: "{{productName}}"
                        price: "{{price}}"
                        category: "{{category}}"
                    parameters:
                      type: array
                      description: Lista de parÃ¢metros aceitos pela funÃ§Ã£o
                      items:
                        type: object
                        required:
                          - name
                          - type
                          - description
                        properties:
                          name:
                            type: string
                            description: Nome do parÃ¢metro
                          type:
                            type: string
                            enum:
                              - string
                              - number
                              - integer
                              - boolean
                              - array
                              - object
                            description: Tipo do parÃ¢metro
                          description:
                            type: string
                            description: DescriÃ§Ã£o do parÃ¢metro
                          required:
                            type: boolean
                            description: Indica se o parÃ¢metro Ã© obrigatÃ³rio
                          enum:
                            type: string
                            description: Lista de valores permitidos para parÃ¢metros do tipo string,
                              separados por vÃ­rgula
                          minimum:
                            type: number
                            description: Valor mÃ­nimo para parÃ¢metros numÃ©ricos
                          maximum:
                            type: number
                            description: Valor mÃ¡ximo para parÃ¢metros numÃ©ricos
                      example:
                        - name: apiKey
                          type: string
                          description: Chave de API para autenticaÃ§Ã£o
                          required: true
                        - name: price
                          type: number
                          description: PreÃ§o do produto
                          minimum: 0.01
                          maximum: 999999.99
                          required: true
      responses:
        "200":
          description: FunÃ§Ã£o atualizada com sucesso
          content:
            application/json:
              schema:
                $ref: ../schemas/chatbot_ai_function.yaml#/ChatbotAIFunction
        "201":
          description: Nova funÃ§Ã£o criada com sucesso
          content:
            application/json:
              schema:
                $ref: ../schemas/chatbot_ai_function.yaml#/ChatbotAIFunction
        "400":
          description: Erro de validaÃ§Ã£o nos dados fornecidos
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
        "404":
          description: FunÃ§Ã£o nÃ£o encontrada
        "500":
          description: Erro interno do servidor
  /function/list:
    get:
      tags:
        - FunÃ§Ãµes API dos Agentes
      summary: Lista todas as funÃ§Ãµes de API
      description: Retorna todas as funÃ§Ãµes de API configuradas para a instÃ¢ncia atual
      responses:
        "200":
          description: Lista de funÃ§Ãµes recuperada com sucesso
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: ../schemas/chatbot_ai_function.yaml#/ChatbotAIFunction
        "500":
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
  /chat/block:
    post:
      summary: Bloqueia ou desbloqueia contato do WhatsApp
      description: >-
        Bloqueia ou desbloqueia um contato do WhatsApp. Contatos bloqueados nÃ£o
        podem enviar mensagens 

        para a instÃ¢ncia e a instÃ¢ncia nÃ£o pode enviar mensagens para eles.
      tags:
        - Bloqueios
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                number:
                  type: string
                  description: NÃºmero do WhatsApp no formato internacional (ex. 5511999999999)
                  example: "5511999999999"
                block:
                  type: boolean
                  description: True para bloquear, False para desbloquear
                  example: true
              required:
                - number
                - block
      responses:
        "200":
          description: OperaÃ§Ã£o realizada com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  response:
                    type: string
                    description: Mensagem de confirmaÃ§Ã£o
                    example: Blocked successfully
                  blockList:
                    type: array
                    description: Lista atualizada de contatos bloqueados
                    items:
                      type: string
                    example:
                      - 5511999999999@s.whatsapp.net
                      - 5511888888888@s.whatsapp.net
        "401":
          description: NÃ£o autorizado - token invÃ¡lido
        "404":
          description: Contato nÃ£o encontrado
        "500":
          description: Erro do servidor ao processar a requisiÃ§Ã£o
  /chat/blocklist:
    get:
      summary: Lista contatos bloqueados
      description: >-
        Retorna a lista completa de contatos que foram bloqueados pela
        instÃ¢ncia.

        Esta lista Ã© atualizada em tempo real conforme contatos sÃ£o
        bloqueados/desbloqueados.
      tags:
        - Bloqueios
      responses:
        "200":
          description: Lista de contatos bloqueados recuperada com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  blockList:
                    type: array
                    items:
                      type: string
                      description: JIDs dos contatos bloqueados no formato "nÃºmero@s.whatsapp.net"
                    example:
                      - 5511999999999@s.whatsapp.net
                      - 5511888888888@s.whatsapp.net
        "401":
          description: Token invÃ¡lido ou nÃ£o fornecido
        "500":
          description: Erro interno do servidor ou instÃ¢ncia nÃ£o conectada
  /chat/labels:
    post:
      summary: Gerencia labels de um chat
      description: >-
        Atualiza as labels associadas a um chat especÃ­fico. Este endpoint
        oferece trÃªs modos de operaÃ§Ã£o:


        1. **Definir todas as labels** (labelids): Define o conjunto completo de
        labels para o chat, substituindo labels existentes

        2. **Adicionar uma label** (add_labelid): Adiciona uma Ãºnica label ao
        chat sem afetar as existentes

        3. **Remover uma label** (remove_labelid): Remove uma Ãºnica label do
        chat sem afetar as outras


        **Importante**: Use apenas um dos trÃªs parÃ¢metros por requisiÃ§Ã£o. Labels
        inexistentes serÃ£o rejeitadas.


        As labels devem ser fornecidas no formato id ou labelid encontradas na
        funÃ§Ã£o get labels.
      tags:
        - Etiquetas
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                number:
                  type: string
                  description: NÃºmero do chat ou grupo
                  example: "5511999999999"
                labelids:
                  type: array
                  items:
                    type: string
                  description: Lista de IDs das labels a serem aplicadas ao chat (define todas as
                    labels)
                  example:
                    - "10"
                    - "20"
                add_labelid:
                  type: string
                  description: ID da label a ser adicionada ao chat
                  example: "10"
                remove_labelid:
                  type: string
                  description: ID da label a ser removida do chat
                  example: "20"
              required:
                - number
              oneOf:
                - required:
                    - labelids
                - required:
                    - add_labelid
                - required:
                    - remove_labelid
            examples:
              definir_todas_labels:
                summary: Definir todas as labels do chat
                description: Define o conjunto completo de labels, substituindo as existentes
                value:
                  number: "5511999999999"
                  labelids:
                    - "10"
                    - "20"
                    - "30"
              adicionar_label:
                summary: Adicionar uma label ao chat
                description: Adiciona uma Ãºnica label sem afetar as existentes
                value:
                  number: "5511999999999"
                  add_labelid: "10"
              remover_label:
                summary: Remover uma label do chat
                description: Remove uma Ãºnica label sem afetar as outras
                value:
                  number: "5511999999999"
                  remove_labelid: "20"
      responses:
        "200":
          description: Labels atualizadas com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  response:
                    type: string
                    description: Mensagem de confirmaÃ§Ã£o
                  editions:
                    type: array
                    items:
                      type: string
                    description: Lista de operaÃ§Ãµes realizadas (apenas para operaÃ§Ã£o labelids)
              examples:
                definir_todas_labels:
                  summary: Resposta para definir todas as labels
                  value:
                    response: Labels updated successfully
                    editions:
                      - Added label 10 to chat
                      - Added label 20 to chat
                      - Removed label 5 from chat
                adicionar_label:
                  summary: Resposta para adicionar uma label
                  value:
                    response: Label added to chat
                remover_label:
                  summary: Resposta para remover uma label
                  value:
                    response: Label removed from chat
        "400":
          description: Erro na requisiÃ§Ã£o
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Use only one operation: labelids, add_labelid, or remove_labelid"
        "404":
          description: Chat nÃ£o encontrado
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Chat not found
  /chat/delete:
    post:
      summary: Deleta chat
      description: |-
        Deleta um chat e/ou suas mensagens do WhatsApp e/ou banco de dados. 
        VocÃª pode escolher deletar:
        - Apenas do WhatsApp
        - Apenas do banco de dados
        - Apenas as mensagens do banco de dados
        - Qualquer combinaÃ§Ã£o das opÃ§Ãµes acima
      tags:
        - Chats
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                number:
                  type: string
                  description: |-
                    NÃºmero do chat no formato internacional.
                    Para grupos use o ID completo do grupo.
                  example: "5511999999999"
                deleteChatDB:
                  type: boolean
                  description: Se true, deleta o chat do banco de dados
                  default: false
                  example: true
                deleteMessagesDB:
                  type: boolean
                  description: Se true, deleta todas as mensagens do chat do banco de dados
                  default: false
                  example: true
                deleteChatWhatsApp:
                  type: boolean
                  description: Se true, deleta o chat do WhatsApp
                  default: false
                  example: true
              required:
                - number
      responses:
        "200":
          description: OperaÃ§Ã£o realizada com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  response:
                    type: string
                    description: Mensagem de sucesso
                    example: Chat deletion process completed
                  actions:
                    type: array
                    description: Lista de aÃ§Ãµes realizadas
                    items:
                      type: string
                    example:
                      - Chat deleted from WhatsApp
                      - Chat deleted from database
                      - "Messages associated with chat deleted from database: 42"
                  errors:
                    type: array
                    description: Lista de erros ocorridos, se houver
                    items:
                      type: string
                    example:
                      - "Error deleting chat from WhatsApp: connection timeout"
        "400":
          description: Erro nos parÃ¢metros da requisiÃ§Ã£o
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Missing number in payload
        "401":
          description: Token invÃ¡lido ou nÃ£o fornecido
        "404":
          description: Chat nÃ£o encontrado
        "500":
          description: Erro interno do servidor
  /chat/archive:
    post:
      summary: Arquivar/desarquivar chat
      description: >-
        Altera o estado de arquivamento de um chat do WhatsApp.

        - Quando arquivado, o chat Ã© movido para a seÃ§Ã£o de arquivados no
        WhatsApp

        - A aÃ§Ã£o Ã© sincronizada entre todos os dispositivos conectados

        - NÃ£o afeta as mensagens ou o conteÃºdo do chat
      tags:
        - Chats
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - number
                - archive
              properties:
                number:
                  type: string
                  description: NÃºmero do telefone (formato E.164) ou ID do grupo
                  example: "5511999999999"
                archive:
                  type: boolean
                  description: true para arquivar, false para desarquivar
                  example: true
      responses:
        "200":
          description: Chat arquivado/desarquivado com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  response:
                    type: string
                    example: Chat updated successfully
        "400":
          description: Dados da requisiÃ§Ã£o invÃ¡lidos
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Invalid phone number format
        "401":
          description: Token de autenticaÃ§Ã£o ausente ou invÃ¡lido
        "500":
          description: Erro ao executar a operaÃ§Ã£o
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Error archiving chat
  /chat/read:
    post:
      summary: Marcar chat como lido/nÃ£o lido
      description: |-
        Atualiza o status de leitura de um chat no WhatsApp.

        Quando um chat Ã© marcado como lido:
        - O contador de mensagens nÃ£o lidas Ã© zerado
        - O indicador visual de mensagens nÃ£o lidas Ã© removido
        - O remetente recebe confirmaÃ§Ã£o de leitura (se ativado)

        Quando marcado como nÃ£o lido:
        - O chat aparece como pendente de leitura
        - NÃ£o afeta as confirmaÃ§Ãµes de leitura jÃ¡ enviadas
      tags:
        - Chats
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - number
                - read
              properties:
                number:
                  type: string
                  description: >-
                    Identificador do chat no formato:

                    - Para usuÃ¡rios: [nÃºmero]@s.whatsapp.net (ex:
                    5511999999999@s.whatsapp.net)

                    - Para grupos: [id-grupo]@g.us (ex:
                    123456789-987654321@g.us)
                  example: 5511999999999@s.whatsapp.net
                read:
                  type: boolean
                  description: |-
                    - true: marca o chat como lido
                    - false: marca o chat como nÃ£o lido
      responses:
        "200":
          description: Status de leitura atualizado com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  response:
                    type: string
                    example: Chat read status updated successfully
        "401":
          description: Token de autenticaÃ§Ã£o ausente ou invÃ¡lido
        "404":
          description: Chat nÃ£o encontrado
        "500":
          description: Erro ao atualizar status de leitura
  /chat/mute:
    post:
      summary: Silenciar chat
      description: |-
        Silencia notificaÃ§Ãµes de um chat por um perÃ­odo especÃ­fico. 
        As opÃ§Ãµes de silenciamento sÃ£o:
        * 0 - Remove o silenciamento
        * 8 - Silencia por 8 horas
        * 168 - Silencia por 1 semana (168 horas)
        * -1 - Silencia permanentemente
      tags:
        - Chats
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - number
                - muteEndTime
              properties:
                number:
                  type: string
                  description: ID do chat no formato 123456789@s.whatsapp.net ou
                    123456789-123456@g.us
                  example: 5511999999999@s.whatsapp.net
                muteEndTime:
                  type: integer
                  description: |-
                    DuraÃ§Ã£o do silenciamento:
                    * 0 = Remove silenciamento
                    * 8 = Silencia por 8 horas
                    * 168 = Silencia por 1 semana
                    * -1 = Silencia permanentemente
                  enum:
                    - 0
                    - 8
                    - 168
                    - -1
                  example: 8
      responses:
        "200":
          description: Chat silenciado com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  response:
                    type: string
                    example: Chat mute settings updated successfully
        "400":
          description: DuraÃ§Ã£o invÃ¡lida ou formato de nÃºmero incorreto
        "401":
          description: Token invÃ¡lido ou ausente
        "404":
          description: Chat nÃ£o encontrado
  /chat/pin:
    post:
      summary: Fixar/desafixar chat
      description: >-
        Fixa ou desafixa um chat no topo da lista de conversas. Chats fixados
        permanecem 

        no topo mesmo quando novas mensagens sÃ£o recebidas em outros chats.
      tags:
        - Chats
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                number:
                  type: string
                  description: >-
                    NÃºmero do chat no formato internacional completo (ex:
                    "5511999999999") 

                    ou ID do grupo (ex: "123456789-123456@g.us")
                  example: "5511999999999"
                pin:
                  type: boolean
                  description: Define se o chat deve ser fixado (true) ou desafixado (false)
                  example: true
              required:
                - number
                - pin
      responses:
        "200":
          description: Chat fixado/desafixado com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  response:
                    type: string
                    description: Mensagem de confirmaÃ§Ã£o
                    example: Chat pinned
        "400":
          description: Erro na requisiÃ§Ã£o
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: DescriÃ§Ã£o do erro
                    example: Could not parse phone
        "401":
          description: NÃ£o autorizado
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Mensagem de erro de autenticaÃ§Ã£o
                    example: Invalid token
  /chat/find:
    post:
      summary: Busca chats com filtros
      description: >-
        Busca chats com diversos filtros e ordenaÃ§Ã£o. Suporta filtros em todos
        os campos do chat, 

        paginaÃ§Ã£o e ordenaÃ§Ã£o customizada.


        Operadores de filtro:

        - `~` : LIKE (contÃ©m)

        - `!~` : NOT LIKE (nÃ£o contÃ©m)

        - `!=` : diferente

        - `>=` : maior ou igual

        - `>` : maior que

        - `<=` : menor ou igual

        - `<` : menor que

        - Sem operador: LIKE (contÃ©m)
      tags:
        - Chats
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                operator:
                  type: string
                  enum:
                    - AND
                    - OR
                  default: AND
                  description: Operador lÃ³gico entre os filtros
                sort:
                  type: string
                  description: Campo para ordenaÃ§Ã£o (+/-campo). Ex -wa_lastMsgTimestamp
                limit:
                  type: integer
                  description: Limite de resultados por pÃ¡gina
                  default: 2000
                offset:
                  type: integer
                  description: Offset para paginaÃ§Ã£o
                  default: 0
                wa_fastid:
                  type: string
                wa_chatid:
                  type: string
                wa_archived:
                  type: boolean
                wa_contactName:
                  type: string
                wa_name:
                  type: string
                name:
                  type: string
                wa_isBlocked:
                  type: boolean
                wa_isGroup:
                  type: boolean
                wa_isGroup_admin:
                  type: boolean
                wa_isGroup_announce:
                  type: boolean
                wa_isGroup_member:
                  type: boolean
                wa_isPinned:
                  type: boolean
                wa_label:
                  type: string
                lead_tags:
                  type: string
                lead_isTicketOpen:
                  type: boolean
                lead_assignedAttendant_id:
                  type: string
                lead_status:
                  type: string
              example:
                operator: AND
                sort: -wa_lastMsgTimestamp
                limit: 50
                offset: 0
                wa_isGroup: true
                lead_status: ~novo
                wa_label: ~importante
      responses:
        "200":
          description: Lista de chats encontrados
          content:
            application/json:
              schema:
                type: object
                properties:
                  chats:
                    type: array
                    items:
                      $ref: ../schemas/chat.yaml#/Chat
                  totalChatsStats:
                    type: object
                    description: Contadores totais de chats
                  pagination:
                    type: object
                    properties:
                      totalRecords:
                        type: integer
                      pageSize:
                        type: integer
                      currentPage:
                        type: integer
                      totalPages:
                        type: integer
  /chat/editLead:
    post:
      summary: Edita informaÃ§Ãµes de lead
      description: >-
        Atualiza as informaÃ§Ãµes de lead associadas a um chat. Permite modificar
        status do ticket, 

        atribuiÃ§Ã£o de atendente, posiÃ§Ã£o no kanban, tags e outros campos
        customizados.


        As alteraÃ§Ãµes sÃ£o refletidas imediatamente no banco de dados e disparam
        eventos webhook/SSE

        para manter a aplicaÃ§Ã£o sincronizada.
      tags:
        - CRM
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - id
              properties:
                id:
                  type: string
                  description: |-
                    Identificador do chat. Pode ser:
                    - wa_chatid (ex: "5511999999999@s.whatsapp.net")
                    - wa_fastid (ex: "5511888888888:5511999999999")
                  example: 5511999999999@s.whatsapp.net
                chatbot_disableUntil:
                  type: integer
                  format: int64
                  description: >-
                    Timestamp UTC atÃ© quando o chatbot deve ficar desativado
                    para este chat.

                    Use 0 para reativar imediatamente.
                  example: 1735686000
                lead_isTicketOpen:
                  type: boolean
                  description: |-
                    Status do ticket associado ao lead.
                    - true: Ticket estÃ¡ aberto/em atendimento
                    - false: Ticket estÃ¡ fechado/resolvido
                  example: true
                lead_assignedAttendant_id:
                  type: string
                  description: |-
                    ID do atendente atribuÃ­do ao lead.
                    Use string vazia ("") para remover a atribuiÃ§Ã£o.
                  example: att_123456
                lead_kanbanOrder:
                  type: integer
                  format: int64
                  description: |-
                    PosiÃ§Ã£o do card no quadro kanban.
                    Valores maiores aparecem primeiro.
                  example: 1000
                lead_tags:
                  type: array
                  items:
                    type: string
                  description: |-
                    Lista de tags associadas ao lead.
                    Tags inexistentes sÃ£o criadas automaticamente.
                    Envie array vazio ([]) para remover todas as tags.
                  example:
                    - vip
                    - suporte
                    - prioridade-alta
                lead_name:
                  type: string
                  description: Nome principal do lead
                  example: JoÃ£o Silva
                lead_fullName:
                  type: string
                  description: Nome completo do lead
                  example: JoÃ£o Silva Pereira
                lead_email:
                  type: string
                  format: email
                  description: Email do lead
                  example: joao@exemplo.com
                lead_personalId:
                  type: string
                  description: |-
                    Documento de identificaÃ§Ã£o (CPF/CNPJ)
                    Apenas nÃºmeros ou formatado
                  example: 123.456.789-00
                lead_status:
                  type: string
                  description: Status do lead no funil de vendas
                  example: qualificado
                lead_notes:
                  type: string
                  description: AnotaÃ§Ãµes sobre o lead
                  example: Cliente interessado em plano premium
                lead_field01:
                  type: string
                  description: Campo personalizado 1
                lead_field02:
                  type: string
                  description: Campo personalizado 2
                lead_field03:
                  type: string
                  description: Campo personalizado 3
                lead_field04:
                  type: string
                  description: Campo personalizado 4
                lead_field05:
                  type: string
                  description: Campo personalizado 5
                lead_field06:
                  type: string
                  description: Campo personalizado 6
                lead_field07:
                  type: string
                  description: Campo personalizado 7
                lead_field08:
                  type: string
                  description: Campo personalizado 8
                lead_field09:
                  type: string
                  description: Campo personalizado 9
                lead_field10:
                  type: string
                  description: Campo personalizado 10
                lead_field11:
                  type: string
                  description: Campo personalizado 11
                lead_field12:
                  type: string
                  description: Campo personalizado 12
                lead_field13:
                  type: string
                  description: Campo personalizado 13
                lead_field14:
                  type: string
                  description: Campo personalizado 14
                lead_field15:
                  type: string
                  description: Campo personalizado 15
                lead_field16:
                  type: string
                  description: Campo personalizado 16
                lead_field17:
                  type: string
                  description: Campo personalizado 17
                lead_field18:
                  type: string
                  description: Campo personalizado 18
                lead_field19:
                  type: string
                  description: Campo personalizado 19
                lead_field20:
                  type: string
                  description: Campo personalizado 20
      responses:
        "200":
          description: Lead atualizado com sucesso
          content:
            application/json:
              schema:
                $ref: ../schemas/chat.yaml#/Chat
              example:
                wa_fastid: 5511888888888:5511999999999
                wa_chatid: 5511999999999@s.whatsapp.net
                lead_name: JoÃ£o Silva
                lead_status: qualificado
                lead_tags:
                  - vip
                  - suporte
                lead_isTicketOpen: true
                lead_assignedAttendant_id: att_123456
        "400":
          description: Payload invÃ¡lido
        "404":
          description: Chat nÃ£o encontrado
        "500":
          description: Erro interno do servidor
  /contacts:
    get:
      tags:
        - Contatos
      summary: Retorna lista de contatos do WhatsApp
      description: >-
        Retorna a lista de contatos salvos na agenda do celular e que estÃ£o no
        WhatsApp.


        O endpoint realiza:

        - Busca todos os contatos armazenados

        - Retorna dados formatados incluindo JID e informaÃ§Ãµes de nome
      security:
        - token: []
      responses:
        "200":
          description: Lista de contatos retornada com sucesso
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    jid:
                      type: string
                      description: "ID Ãºnico do contato no WhatsApp (formato: nÃºmero@s.whatsapp.net)"
                      example: 5511999999999@s.whatsapp.net
                    contactName:
                      type: string
                      description: Nome completo do contato
                      example: JoÃ£o Silva
                    contact_FirstName:
                      type: string
                      description: Primeiro nome do contato
                      example: JoÃ£o
        "401":
          description: Sem sessÃ£o ativa
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: No session
        "500":
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Internal server error
  /contact/add:
    post:
      tags:
        - Contatos
      summary: Adiciona um contato Ã  agenda
      description: >-
        Adiciona um novo contato Ã  agenda do celular.


        O endpoint realiza:

        - Adiciona o contato Ã  agenda usando o WhatsApp

        - Usa o campo 'name' tanto para o nome completo quanto para o primeiro
        nome

        - Salva as informaÃ§Ãµes do contato na agenda do WhatsApp

        - Retorna informaÃ§Ãµes do contato adicionado
      security:
        - token: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - phone
                - name
              properties:
                phone:
                  type: string
                  description: >-
                    NÃºmero de telefone no formato internacional com cÃ³digo do
                    paÃ­s obrigatÃ³rio. 

                    Para Brasil, deve comeÃ§ar com 55. Aceita variaÃ§Ãµes com/sem
                    sÃ­mbolo +, 

                    com/sem parÃªnteses, com/sem hÃ­fen e com/sem espaÃ§os. TambÃ©m
                    aceita formato 

                    JID do WhatsApp (@s.whatsapp.net). NÃ£o aceita contatos
                    comerciais (@lid) 

                    nem grupos (@g.us).
                  examples:
                    - +55 (21) 99999-9999
                    - +55 21 99999-9999
                    - +55 21 999999999
                    - "+5521999999999"
                    - "5521999999999"
                    - 5521999999999@s.whatsapp.net
                name:
                  type: string
                  description: Nome completo do contato (serÃ¡ usado como primeiro nome e nome
                    completo)
                  example: JoÃ£o Silva
      responses:
        "200":
          description: Contato adicionado com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Contato adicionado com sucesso
                  contact:
                    type: object
                    properties:
                      jid:
                        type: string
                        description: "ID Ãºnico do contato no WhatsApp (formato: nÃºmero@s.whatsapp.net)"
                        example: 5511999999999@s.whatsapp.net
                      name:
                        type: string
                        description: Nome completo do contato
                        example: JoÃ£o Silva
                      phone:
                        type: string
                        description: NÃºmero de telefone
                        example: "5511999999999"
        "400":
          description: Dados invÃ¡lidos na requisiÃ§Ã£o
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: NÃºmero de telefone invÃ¡lido
        "401":
          description: Sem sessÃ£o ativa
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: No session
        "500":
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Erro ao adicionar contato
  /contact/remove:
    post:
      tags:
        - Contatos
      summary: Remove um contato da agenda
      description: |-
        Remove um contato da agenda do celular.

        O endpoint realiza:
        - Remove o contato da agenda usando o WhatsApp AppState
        - Atualiza a lista de contatos sincronizada
        - Retorna confirmaÃ§Ã£o da remoÃ§Ã£o
      security:
        - token: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - phone
              properties:
                phone:
                  type: string
                  description: >-
                    NÃºmero de telefone no formato internacional com cÃ³digo do
                    paÃ­s obrigatÃ³rio. 

                    Para Brasil, deve comeÃ§ar com 55. Aceita variaÃ§Ãµes com/sem
                    sÃ­mbolo +, 

                    com/sem parÃªnteses, com/sem hÃ­fen e com/sem espaÃ§os. TambÃ©m
                    aceita formato 

                    JID do WhatsApp (@s.whatsapp.net). NÃ£o aceita contatos
                    comerciais (@lid) 

                    nem grupos (@g.us).
                  examples:
                    - +55 (21) 99999-9999
                    - +55 21 99999-9999
                    - +55 21 999999999
                    - "+5521999999999"
                    - "5521999999999"
                    - 5521999999999@s.whatsapp.net
      responses:
        "200":
          description: Contato removido com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Contato removido com sucesso
                  removed_contact:
                    type: object
                    properties:
                      jid:
                        type: string
                        description: "ID Ãºnico do contato no WhatsApp (formato: nÃºmero@s.whatsapp.net)"
                        example: 5511999999999@s.whatsapp.net
                      phone:
                        type: string
                        description: NÃºmero de telefone removido
                        example: "5511999999999"
        "400":
          description: Dados invÃ¡lidos na requisiÃ§Ã£o
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: NÃºmero de telefone invÃ¡lido
        "401":
          description: Sem sessÃ£o ativa
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: No session
        "404":
          description: Contato nÃ£o encontrado
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Contato nÃ£o encontrado na agenda
        "500":
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Erro ao remover contato
  /chat/details:
    post:
      tags:
        - Contatos
      summary: Obter Detalhes Completos
      description: >-
        Retorna informaÃ§Ãµes **completas** sobre um contato ou chat, incluindo
        **todos os campos disponÃ­veis** do modelo Chat.


        ### Funcionalidades:

        - **Retorna chat completo**: Todos os campos do modelo Chat (mais de 60
        campos)

        - **Busca informaÃ§Ãµes para contatos individuais e grupos**

        - **URLs de imagem em dois tamanhos**: preview (menor) ou full
        (original)

        - **Combina informaÃ§Ãµes de diferentes fontes**: WhatsApp, contatos
        salvos, leads

        - **Atualiza automaticamente dados desatualizados** no banco


        ### Campos Retornados:

        - **InformaÃ§Ãµes bÃ¡sicas**: id, wa_fastid, wa_chatid, owner, name, phone

        - **Dados do WhatsApp**: wa_name, wa_contactName, wa_archived,
        wa_isBlocked, etc.

        - **Dados de lead/CRM**: lead_name, lead_email, lead_status,
        lead_field01-20, etc.

        - **InformaÃ§Ãµes de grupo**: wa_isGroup, wa_isGroup_admin,
        wa_isGroup_announce, etc.

        - **Chatbot**: chatbot_summary, chatbot_lastTrigger_id,
        chatbot_disableUntil, etc.

        - **ConfiguraÃ§Ãµes**: wa_muteEndTime, wa_isPinned, wa_unreadCount, etc.


        **Comportamento**:

        - Para contatos individuais:
          - Busca nome verificado do WhatsApp
          - Verifica nome salvo nos contatos
          - Formata nÃºmero internacional
          - Calcula grupos em comum
        - Para grupos:
          - Busca nome do grupo
          - Verifica status de comunidade
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                number:
                  type: string
                  description: NÃºmero do telefone ou ID do grupo
                  example: "5511999999999"
                preview:
                  type: boolean
                  description: >-
                    Controla o tamanho da imagem de perfil retornada:

                    - `true`: Retorna imagem em tamanho preview (menor,
                    otimizada para listagens)

                    - `false` (padrÃ£o): Retorna imagem em tamanho full
                    (resoluÃ§Ã£o original, maior qualidade)
                  default: false
              required:
                - number
      responses:
        "200":
          description: InformaÃ§Ãµes completas do chat retornadas com sucesso
          content:
            application/json:
              schema:
                allOf:
                  - $ref: ../schemas/chat.yaml#/Chat
                  - type: object
                    properties:
                      wa_common_groups:
                        type: string
                        description: "Grupos em comum separados por vÃ­rgula, formato:
                          nome_grupo(id_grupo)"
                        example: Grupo
                          FamÃ­lia(120363123456789012@g.us),Trabalho(987654321098765432@g.us)
                      imagePreview:
                        type: string
                        description: URL da imagem de perfil em tamanho preview (menor) - apenas se
                          preview=true
                      image:
                        type: string
                        description: URL da imagem de perfil em tamanho full (resoluÃ§Ã£o original) -
                          apenas se preview=false
              examples:
                contact_example:
                  summary: Contato individual
                  description: Exemplo de resposta para um contato individual
                  value:
                    id: r1a2b3c4d5e6f7
                    wa_fastid: admin:5511999999999
                    wa_chatid: 5511999999999@s.whatsapp.net
                    wa_name: JoÃ£o Silva
                    name: JoÃ£o Silva
                    phone: +55 11 99999-9999
                    owner: admin
                    wa_archived: false
                    wa_isBlocked: false
                    wa_isGroup: false
                    lead_name: JoÃ£o
                    lead_fullName: JoÃ£o Silva
                    lead_email: joao@exemplo.com
                    lead_status: ativo
                    wa_contactName: JoÃ£o Silva
                    wa_common_groups: Grupo
                      FamÃ­lia(120363123456789012@g.us),Trabalho(987654321098765432@g.us)
                    image: https://pps.whatsapp.net/v/t61.24694-24/12345_image.jpg
                group_example:
                  summary: Grupo
                  description: Exemplo de resposta para um grupo
                  value:
                    id: r9z8y7x6w5v4u3
                    wa_fastid: admin:120363123456789012@g.us
                    wa_chatid: 120363123456789012@g.us
                    wa_name: Grupo FamÃ­lia
                    name: Grupo FamÃ­lia
                    phone: ""
                    owner: admin
                    wa_archived: false
                    wa_isBlocked: false
                    wa_isGroup: true
                    wa_isGroup_admin: true
                    wa_isGroup_announce: false
                    wa_isGroup_community: false
                    wa_isGroup_member: true
                    image: https://pps.whatsapp.net/v/t61.24694-24/67890_group.jpg
        "400":
          description: Payload invÃ¡lido ou nÃºmero invÃ¡lido
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Invalid request payload
        "401":
          description: Token nÃ£o fornecido
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Unauthorized
        "500":
          description: Erro interno do servidor ou sessÃ£o nÃ£o iniciada
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: No session
  /chat/check:
    post:
      tags:
        - Contatos
      summary: Verificar NÃºmeros no WhatsApp
      description: >-
        Verifica se nÃºmeros fornecidos estÃ£o registrados no WhatsApp e retorna
        informaÃ§Ãµes detalhadas.


        ### Funcionalidades:

        - Verifica mÃºltiplos nÃºmeros simultaneamente

        - Suporta nÃºmeros individuais e IDs de grupo

        - Retorna nome verificado quando disponÃ­vel

        - Identifica grupos e comunidades

        - Verifica subgrupos de comunidades


        **Comportamento especÃ­fico**:

        - Para nÃºmeros individuais:
          - Verifica registro no WhatsApp
          - Retorna nome verificado se disponÃ­vel
          - Normaliza formato do nÃºmero
        - Para grupos:
          - Verifica existÃªncia
          - Retorna nome do grupo
          - Retorna id do grupo de anÃºncios se buscado por id de comunidade
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                numbers:
                  type: array
                  items:
                    type: string
                  description: Lista de nÃºmeros ou IDs de grupo para verificar
                  example:
                    - "5511999999999"
                    - 123456789@g.us
      responses:
        "200":
          description: Resultado da verificaÃ§Ã£o
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    query:
                      type: string
                      description: NÃºmero/ID original consultado
                    jid:
                      type: string
                      description: JID do WhatsApp
                    lid:
                      type: string
                      description: LID do WhatsApp
                    isInWhatsapp:
                      type: boolean
                      description: Indica se estÃ¡ no WhatsApp
                    verifiedName:
                      type: string
                      description: Nome verificado se disponÃ­vel
                    groupName:
                      type: string
                      description: Nome do grupo se aplicÃ¡vel
                    error:
                      type: string
                      description: Mensagem de erro se houver
        "400":
          description: Payload invÃ¡lido ou sem nÃºmeros
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Missing numbers in payload
        "401":
          description: Sem sessÃ£o ativa
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: No active session
        "500":
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: WhatsApp client is not connected
  /label/edit:
    post:
      tags:
        - Etiquetas
      summary: Editar etiqueta
      description: |-
        Edita uma etiqueta existente na instÃ¢ncia.
        Permite alterar nome, cor ou deletar a etiqueta.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                labelid:
                  type: string
                  description: ID da etiqueta a ser editada
                  example: "25"
                name:
                  type: string
                  description: Novo nome da etiqueta
                  example: responder editado
                color:
                  type: integer
                  description: CÃ³digo numÃ©rico da nova cor (0-19)
                  minimum: 0
                  maximum: 19
                  example: 2
                delete:
                  type: boolean
                  description: Indica se a etiqueta deve ser deletada
                  example: false
              required:
                - labelid
      responses:
        "200":
          description: Etiqueta editada com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  response:
                    type: string
                    example: Label edited
        "400":
          description: Payload invÃ¡lido
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: invalid payload
        "500":
          description: Erro interno do servidor ou sessÃ£o invÃ¡lida
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: error editing label
  /labels:
    get:
      tags:
        - Etiquetas
      summary: Buscar todas as etiquetas
      description: Retorna a lista completa de etiquetas da instÃ¢ncia.
      responses:
        "200":
          description: Lista de etiquetas retornada com sucesso
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: ../schemas/label.yaml#/Label
        "500":
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Failed to fetch labels from database
  /quickreply/edit:
    post:
      tags:
        - Respostas RÃ¡pidas
      summary: Criar, atualizar ou excluir resposta rÃ¡pida
      description: >-
        Gerencia templates de respostas rÃ¡pidas para agilizar o atendimento.
        Suporta mensagens de texto e mÃ­dia.


        - Para criar: nÃ£o inclua o campo `id`

        - Para atualizar: inclua o `id` existente

        - Para excluir: defina `delete: true` e inclua o `id`


        ObservaÃ§Ã£o: Templates originados do WhatsApp (onWhatsApp=true) nÃ£o podem
        ser modificados ou excluÃ­dos.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - shortCut
                - type
              properties:
                id:
                  type: string
                  description: NecessÃ¡rio para atualizaÃ§Ãµes/exclusÃµes, omitir para criaÃ§Ã£o
                  example: rb9da9c03637452
                delete:
                  type: boolean
                  description: Definir como true para excluir o template
                  default: false
                shortCut:
                  type: string
                  description: Atalho para acesso rÃ¡pido ao template
                  example: saudacao1
                type:
                  type: string
                  enum:
                    - text
                    - audio
                    - myaudio
                    - ptt
                    - document
                    - video
                    - image
                  description: Tipo da mensagem
                text:
                  type: string
                  description: ObrigatÃ³rio para mensagens do tipo texto
                  example: OlÃ¡! Como posso ajudar hoje?
                file:
                  type: string
                  description: URL ou Base64 para tipos de mÃ­dia
                  example: https://exemplo.com/arquivo.pdf
                docName:
                  type: string
                  description: Nome do arquivo opcional para tipo documento
                  example: apresentacao.pdf
      responses:
        "200":
          description: OperaÃ§Ã£o concluÃ­da com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: OperaÃ§Ã£o concluÃ­da com sucesso
                  quickReplies:
                    type: array
                    items:
                      $ref: ../schemas/quick_reply.yaml#/QuickReply
        "400":
          description: RequisiÃ§Ã£o invÃ¡lida (erro de validaÃ§Ã£o)
        "403":
          description: NÃ£o Ã© possÃ­vel modificar template originado do WhatsApp
        "404":
          description: Template nÃ£o encontrado
        "500":
          description: Erro no servidor
  /quickreply/showall:
    get:
      tags:
        - Respostas RÃ¡pidas
      summary: Listar todas as respostas rÃ¡pidas
      description: Retorna todas as respostas rÃ¡pidas cadastradas para a instÃ¢ncia
        autenticada
      responses:
        "200":
          description: Lista de respostas rÃ¡pidas
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: ../schemas/quick_reply.yaml#/QuickReply
        "500":
          description: Erro no servidor
  /call/make:
    post:
      tags:
        - Chamadas
      summary: Iniciar chamada de voz
      description: >-
        Inicia uma chamada de voz para um contato especÃ­fico. Este endpoint
        permite:

        1. Iniciar chamadas de voz para contatos

        2. Funciona apenas com nÃºmeros vÃ¡lidos do WhatsApp

        3. O contato receberÃ¡ uma chamada de voz


        **Nota**: O telefone do contato tocarÃ¡ normalmente, mas ao contato
        atender, ele nÃ£o ouvirÃ¡ nada, e vocÃª tambÃ©m nÃ£o ouvirÃ¡ nada. 

        Este endpoint apenas inicia a chamada, nÃ£o estabelece uma comunicaÃ§Ã£o de
        voz real.


        Exemplo de requisiÃ§Ã£o:

        ```json

        {
          "number": "5511999999999"
        }

        ```


        Exemplo de resposta:

        ```json

        {
          "response": "Call successful"
        }

        ```


        Erros comuns:

        - 401: Token invÃ¡lido ou expirado

        - 400: NÃºmero invÃ¡lido ou ausente

        - 500: Erro ao iniciar chamada
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                number:
                  type: string
                  description: "NÃºmero do contato no formato internacional (ex: 5511999999999)"
                  example: "5511999999999"
              required:
                - number
      responses:
        "200":
          description: Chamada iniciada com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  response:
                    type: string
                    description: Mensagem de confirmaÃ§Ã£o
                    example: Call successful
        "400":
          description: RequisiÃ§Ã£o invÃ¡lida
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: DescriÃ§Ã£o do erro
                    examples:
                      missing_number: missing number in payload
                      invalid_number: invalid number JID
        "401":
          description: Token invÃ¡lido ou expirado
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: DescriÃ§Ã£o do erro de autenticaÃ§Ã£o
                    example: client not found
        "500":
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: DescriÃ§Ã£o do erro interno
                    example: "error making call: network timeout"
  /call/reject:
    post:
      tags:
        - Chamadas
      summary: Rejeitar chamada recebida
      description: |-
        Rejeita uma chamada recebida do WhatsApp. Este endpoint permite:
        1. Rejeitar chamadas de voz ou vÃ­deo recebidas
        2. Necessita do nÃºmero do contato que estÃ¡ ligando
        3. Necessita do ID da chamada para identificaÃ§Ã£o

        Exemplo de requisiÃ§Ã£o:
        ```json
        {
          "number": "5511999999999",
          "id": "ABEiGmo8oqkAcAKrBYQAAAAA_1"
        }
        ```

        Exemplo de resposta:
        ```json
        {
          "response": "Call rejected"
        }
        ```

        Erros comuns:
        - 401: Token invÃ¡lido ou expirado
        - 400: NÃºmero invÃ¡lido ou ID da chamada ausente
        - 500: Erro ao rejeitar chamada
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                number:
                  type: string
                  description: "NÃºmero do contato no formato internacional (ex: 5511999999999)"
                  example: "5511999999999"
                id:
                  type: string
                  description: ID Ãºnico da chamada a ser rejeitada
                  example: ABEiGmo8oqkAcAKrBYQAAAAA_1
              required:
                - number
                - id
      responses:
        "200":
          description: Chamada rejeitada com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  response:
                    type: string
                    description: Mensagem de confirmaÃ§Ã£o
                    example: Call rejected
        "400":
          description: RequisiÃ§Ã£o invÃ¡lida
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: DescriÃ§Ã£o do erro
                    examples:
                      missing_number: missing number in payload
                      missing_id: missing id in payload
                      invalid_number: invalid number
        "401":
          description: Token invÃ¡lido ou expirado
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: DescriÃ§Ã£o do erro de autenticaÃ§Ã£o
                    example: client not found
        "500":
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: DescriÃ§Ã£o do erro interno
                    example: "error rejecting call: timeout"
  /chatwoot/config:
    get:
      tags:
        - IntegraÃ§Ã£o Chatwoot
      summary: Obter configuraÃ§Ã£o do Chatwoot
      description: >-
        Retorna a configuraÃ§Ã£o atual da integraÃ§Ã£o com Chatwoot para a
        instÃ¢ncia.


        ### Funcionalidades:

        - Retorna todas as configuraÃ§Ãµes do Chatwoot incluindo credenciais

        - Mostra status de habilitaÃ§Ã£o da integraÃ§Ã£o

        - Ãštil para verificar configuraÃ§Ãµes atuais antes de fazer alteraÃ§Ãµes
      responses:
        "200":
          description: ConfiguraÃ§Ã£o obtida com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  chatwoot_enabled:
                    type: boolean
                    description: Se a integraÃ§Ã£o com Chatwoot estÃ¡ habilitada
                    example: true
                  chatwoot_url:
                    type: string
                    description: URL base da instÃ¢ncia Chatwoot
                    example: https://app.chatwoot.com
                  chatwoot_account_id:
                    type: integer
                    format: int64
                    description: ID da conta no Chatwoot
                    example: 1
                  chatwoot_inbox_id:
                    type: integer
                    format: int64
                    description: ID da inbox no Chatwoot
                    example: 5
                  chatwoot_access_token:
                    type: string
                    description: Token de acesso da API Chatwoot
                    example: pXXGHHHyJPYHYgWHJHYHgJjj
                  chatwoot_ignore_groups:
                    type: boolean
                    description: Se deve ignorar mensagens de grupos na sincronizaÃ§Ã£o
                    example: false
                  chatwoot_sign_messages:
                    type: boolean
                    description: Se deve assinar mensagens enviadas para o WhatsApp
                    example: true
                  chatwoot_create_new_conversation:
                    type: boolean
                    description: Sempre criar nova conversa ao invÃ©s de reutilizar conversas
                      existentes
                    example: false
        "401":
          description: Token invÃ¡lido/expirado
        "500":
          description: Erro interno do servidor
    put:
      tags:
        - IntegraÃ§Ã£o Chatwoot
      summary: Atualizar configuraÃ§Ã£o do Chatwoot
      description: >-
        Atualiza a configuraÃ§Ã£o da integraÃ§Ã£o com Chatwoot para a instÃ¢ncia.


        ### Funcionalidades:

        - Configura todos os parÃ¢metros da integraÃ§Ã£o Chatwoot

        - Reinicializa automaticamente o cliente Chatwoot quando habilitado

        - Retorna URL do webhook para configurar no Chatwoot

        - SincronizaÃ§Ã£o bidirecional de mensagens novas entre WhatsApp e
        Chatwoot

        - SincronizaÃ§Ã£o automÃ¡tica de contatos (nome e telefone)

        - AtualizaÃ§Ã£o automÃ¡tica LID â†’ PN (Local ID para Phone Number)

        - Sistema de nomes inteligentes com til (~)


        ### ConfiguraÃ§Ã£o no Chatwoot:

        1. ApÃ³s configurar via API, use a URL retornada no webhook settings da
        inbox no Chatwoot

        2. Configure como webhook URL na sua inbox do Chatwoot

        3. A integraÃ§Ã£o ficarÃ¡ ativa e sincronizarÃ¡ mensagens e contatos
        automaticamente


        ### ðŸ·ï¸ Sistema de Nomes Inteligentes:

        - **Nomes com til (~)**: SÃ£o atualizados automaticamente quando o
        contato modifica seu nome no WhatsApp

        - **Nomes especÃ­ficos**: Para definir um nome fixo, remova o til (~) do
        nome no Chatwoot

        - **Exemplo**: "~JoÃ£o Silva" serÃ¡ atualizado automaticamente, "JoÃ£o
        Silva" (sem til) permanecerÃ¡ fixo

        - **AtualizaÃ§Ã£o LIDâ†’PN**: Contatos migram automaticamente de Local ID
        para Phone Number quando disponÃ­vel

        - **Sem duplicaÃ§Ã£o**: Durante a migraÃ§Ã£o LIDâ†’PN, nÃ£o haverÃ¡ duplicaÃ§Ã£o
        de conversas

        - **Respostas nativas**: Todas as respostas dos agentes aparecem
        nativamente no Chatwoot


        ### ðŸš§ AVISO IMPORTANTE - INTEGRAÃ‡ÃƒO BETA:

        - **Fase Beta**: Esta integraÃ§Ã£o estÃ¡ em fase de desenvolvimento e
        testes

        - **Uso por conta e risco**: O usuÃ¡rio assume total responsabilidade
        pelo uso

        - **RecomendaÃ§Ã£o**: Teste em ambiente nÃ£o-produtivo antes de usar em
        produÃ§Ã£o

        - **Suporte limitado**: Funcionalidades podem mudar sem aviso prÃ©vio


        ### âš ï¸ LimitaÃ§Ãµes Conhecidas:

        - **SincronizaÃ§Ã£o de histÃ³rico**: NÃ£o implementada - apenas mensagens
        novas sÃ£o sincronizadas
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                enabled:
                  type: boolean
                  description: Habilitar/desabilitar integraÃ§Ã£o com Chatwoot
                  example: true
                url:
                  type: string
                  description: URL base da instÃ¢ncia Chatwoot (sem barra final)
                  example: https://app.chatwoot.com
                access_token:
                  type: string
                  description: Token de acesso da API Chatwoot (obtido em Profile Settings >
                    Access Token)
                  example: pXXGHHHyJPYHYgWHJHYHgJjj
                account_id:
                  type: integer
                  format: int64
                  description: ID da conta no Chatwoot (visÃ­vel na URL da conta)
                  example: 1
                inbox_id:
                  type: integer
                  format: int64
                  description: ID da inbox no Chatwoot (obtido nas configuraÃ§Ãµes da inbox)
                  example: 5
                ignore_groups:
                  type: boolean
                  description: Ignorar mensagens de grupos do WhatsApp na sincronizaÃ§Ã£o
                  example: false
                sign_messages:
                  type: boolean
                  description: Assinar mensagens enviadas para WhatsApp com identificaÃ§Ã£o do
                    agente
                  example: true
                create_new_conversation:
                  type: boolean
                  description: Sempre criar nova conversa ao invÃ©s de reutilizar conversas
                    existentes
                  example: false
              required:
                - enabled
                - url
                - access_token
                - account_id
                - inbox_id
      responses:
        "200":
          description: ConfiguraÃ§Ã£o atualizada com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    description: Mensagem de confirmaÃ§Ã£o
                    example: "Chatwoot config updated successfully, put this URL in Chatwoot inbox
                      webhook settings:"
                  chatwoot_inbox_webhook_url:
                    type: string
                    description: URL do webhook para configurar na inbox do Chatwoot
                    example: https://sua-api.com/chatwoot/webhook/inst_abc123
        "400":
          description: Dados invÃ¡lidos no body da requisiÃ§Ã£o
        "401":
          description: Token invÃ¡lido/expirado
        "500":
          description: Erro interno ao salvar configuraÃ§Ã£o
